[0m15:25:31.111419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d19970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106802070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106802940>]}


============================== 15:25:31.114211 | 695399e4-2186-4c6d-aa0f-26ec7ff7f5b5 ==============================
[0m15:25:31.114211 [info ] [MainThread]: Running with dbt=1.6.0
[0m15:25:31.114550 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ofek/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/ofek/workspace/test_dbt/edr_target', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt deps --project-dir /Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/elementary/monitor/dbt_project', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:25:31.302074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '695399e4-2186-4c6d-aa0f-26ec7ff7f5b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10681bf10>]}
[0m15:25:31.303003 [debug] [MainThread]: Set downloads directory='/var/folders/tz/608_pk7n6lz5cyqskh5lr41w0000gn/T/dbt-downloads-oav708vd'
[0m15:25:31.303301 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m15:25:32.019314 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m15:25:32.024885 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m15:25:32.585901 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m15:25:32.599251 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/elementary-data/elementary.json
[0m15:25:33.496093 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/elementary-data/elementary.json 200
[0m15:25:33.524010 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m15:25:34.070569 [info ] [MainThread]: Installed from version 0.8.6
[0m15:25:34.070953 [info ] [MainThread]: Updated version available: 1.1.1
[0m15:25:34.071362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '695399e4-2186-4c6d-aa0f-26ec7ff7f5b5', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106897100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075b1670>]}
[0m15:25:34.071639 [info ] [MainThread]: Installing elementary-data/elementary
[0m15:25:34.638543 [info ] [MainThread]: Installed from version 0.9.0
[0m15:25:34.638883 [info ] [MainThread]: Updated version available: 0.9.2
[0m15:25:34.639134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '695399e4-2186-4c6d-aa0f-26ec7ff7f5b5', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107567550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075674c0>]}
[0m15:25:34.639400 [info ] [MainThread]: 
[0m15:25:34.639647 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils', 'elementary-data/elementary']                 
Update your versions in packages.yml, then run dbt deps
[0m15:25:34.640397 [debug] [MainThread]: Command `dbt deps` succeeded at 15:25:34.640329 after 3.54 seconds
[0m15:25:34.640643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d19970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10681bf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10685eee0>]}
[0m15:25:34.640885 [debug] [MainThread]: Flushing usage events
{"data": {"kwargs": "{'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101835c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104305250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104305bb0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "e062f9b5-6857-447e-bc99-671252e30964", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101835c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104305250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104305bb0>]}", "name": "SendingEvent", "pid": 10474, "thread": "MainThread", "ts": "2023-08-08T12:25:36.446839Z"}}
{"data": {"log_version": 3, "version": "=1.6.0"}, "info": {"category": "", "code": "A001", "extra": {}, "invocation_id": "e062f9b5-6857-447e-bc99-671252e30964", "level": "info", "msg": "Running with dbt=1.6.0", "name": "MainReportVersion", "pid": 10474, "thread": "MainThread", "ts": "2023-08-08T12:25:36.448667Z"}}
{"data": {"args": {"cache_selected_only": "False", "debug": "False", "fail_fast": "False", "indirect_selection": "eager", "introspect": "True", "invocation_command": "dbt --log-format json run-operation elementary.log_macro_results --args {\"macro_name\": \"get_latest_invocation\", \"macro_args\": {}} --project-dir /Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/elementary/monitor/dbt_project", "log_cache_events": "False", "log_format": "json", "log_path": "/Users/ofek/workspace/test_dbt/edr_target", "no_print": "None", "partial_parse": "True", "printer_width": "80", "profiles_dir": "/Users/ofek/.dbt", "quiet": "False", "send_anonymous_usage_stats": "True", "static_parser": "True", "target_path": "None", "use_colors": "True", "use_experimental_parser": "False", "version_check": "True", "warn_error": "None", "warn_error_options": "WarnErrorOptions(include=[], exclude=[])", "write_json": "True"}}, "info": {"category": "", "code": "A002", "extra": {}, "invocation_id": "e062f9b5-6857-447e-bc99-671252e30964", "level": "debug", "msg": "running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ofek/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/ofek/workspace/test_dbt/edr_target', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'json', 'introspect': 'True', 'invocation_command': 'dbt --log-format json run-operation elementary.log_macro_results --args {\"macro_name\": \"get_latest_invocation\", \"macro_args\": {}} --project-dir /Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/elementary/monitor/dbt_project', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}", "name": "MainReportArgs", "pid": 10474, "thread": "MainThread", "ts": "2023-08-08T12:25:36.449028Z"}}
{"data": {"profile_name": "elementary", "target_name": "default"}, "info": {"category": "", "code": "A005", "extra": {}, "invocation_id": "e062f9b5-6857-447e-bc99-671252e30964", "level": "info", "msg": "target not specified in profile 'elementary', using 'default'", "name": "MissingProfileTarget", "pid": 10474, "thread": "MainThread", "ts": "2023-08-08T12:25:36.464347Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'project_id', 'label': 'e062f9b5-6857-447e-bc99-671252e30964', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10397c940>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "e062f9b5-6857-447e-bc99-671252e30964", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e062f9b5-6857-447e-bc99-671252e30964', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10397c940>]}", "name": "SendingEvent", "pid": 10474, "thread": "MainThread", "ts": "2023-08-08T12:25:36.762484Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'adapter_info', 'label': 'e062f9b5-6857-447e-bc99-671252e30964', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105627e50>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "e062f9b5-6857-447e-bc99-671252e30964", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e062f9b5-6857-447e-bc99-671252e30964', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105627e50>]}", "name": "SendingEvent", "pid": 10474, "thread": "MainThread", "ts": "2023-08-08T12:25:36.767997Z"}}
{"data": {"adapter_name": "postgres", "adapter_version": "=1.6.0"}, "info": {"category": "", "code": "E034", "extra": {}, "invocation_id": "e062f9b5-6857-447e-bc99-671252e30964", "level": "info", "msg": "Registered adapter: postgres=1.6.0", "name": "AdapterRegistered", "pid": 10474, "thread": "MainThread", "ts": "2023-08-08T12:25:36.768753Z"}}
{"data": {"checksum": "08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9", "profile": "", "target": "", "vars": "{}", "version": "1.6.0"}, "info": {"category": "", "code": "I025", "extra": {}, "invocation_id": "e062f9b5-6857-447e-bc99-671252e30964", "level": "debug", "msg": "checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0", "name": "StateCheckVarsHash", "pid": 10474, "thread": "MainThread", "ts": "2023-08-08T12:25:36.809213Z"}}
{"data": {"reason": "saved manifest not found. Starting full parse."}, "info": {"category": "", "code": "I024", "extra": {}, "invocation_id": "e062f9b5-6857-447e-bc99-671252e30964", "level": "info", "msg": "Unable to do partial parsing because saved manifest not found. Starting full parse.", "name": "UnableToPartialParse", "pid": 10474, "thread": "MainThread", "ts": "2023-08-08T12:25:36.809770Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'partial_parser', 'label': 'e062f9b5-6857-447e-bc99-671252e30964', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10567ad90>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "e062f9b5-6857-447e-bc99-671252e30964", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e062f9b5-6857-447e-bc99-671252e30964', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10567ad90>]}", "name": "SendingEvent", "pid": 10474, "thread": "MainThread", "ts": "2023-08-08T12:25:36.810068Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'load_project', 'label': 'e062f9b5-6857-447e-bc99-671252e30964', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b15af0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "e062f9b5-6857-447e-bc99-671252e30964", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e062f9b5-6857-447e-bc99-671252e30964', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b15af0>]}", "name": "SendingEvent", "pid": 10474, "thread": "MainThread", "ts": "2023-08-08T12:25:38.728723Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'resource_counts', 'label': 'e062f9b5-6857-447e-bc99-671252e30964', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105684460>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "e062f9b5-6857-447e-bc99-671252e30964", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e062f9b5-6857-447e-bc99-671252e30964', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105684460>]}", "name": "SendingEvent", "pid": 10474, "thread": "MainThread", "ts": "2023-08-08T12:25:38.747750Z"}}
{"data": {"stat_line": "34 models, 2 operations, 6 tests, 6 sources, 0 exposures, 0 metrics, 1101 macros, 0 groups, 0 semantic models"}, "info": {"category": "", "code": "W006", "extra": {}, "invocation_id": "e062f9b5-6857-447e-bc99-671252e30964", "level": "info", "msg": "Found 34 models, 2 operations, 6 tests, 6 sources, 0 exposures, 0 metrics, 1101 macros, 0 groups, 0 semantic models", "name": "FoundStats", "pid": 10474, "thread": "MainThread", "ts": "2023-08-08T12:25:38.748103Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'runnable_timing', 'label': 'e062f9b5-6857-447e-bc99-671252e30964', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056846d0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "e062f9b5-6857-447e-bc99-671252e30964", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e062f9b5-6857-447e-bc99-671252e30964', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056846d0>]}", "name": "SendingEvent", "pid": 10474, "thread": "MainThread", "ts": "2023-08-08T12:25:38.748356Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "e062f9b5-6857-447e-bc99-671252e30964", "level": "debug", "msg": "Acquiring new postgres connection 'macro_log_macro_results'", "name": "NewConnection", "pid": 10474, "thread": "MainThread", "ts": "2023-08-08T12:25:38.748822Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "e062f9b5-6857-447e-bc99-671252e30964", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 10474, "thread": "MainThread", "ts": "2023-08-08T12:25:38.749070Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "BEGIN"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "e062f9b5-6857-447e-bc99-671252e30964", "level": "debug", "msg": "On macro_log_macro_results: BEGIN", "name": "SQLQuery", "pid": 10474, "thread": "MainThread", "ts": "2023-08-08T12:25:38.749303Z"}}
{"data": {"connection_state": "init"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "e062f9b5-6857-447e-bc99-671252e30964", "level": "debug", "msg": "Opening a new connection, currently in state init", "name": "NewConnectionOpening", "pid": 10474, "thread": "MainThread", "ts": "2023-08-08T12:25:38.749545Z"}}
{"data": {"args": [], "base_msg": "Got a retryable error when attempting to open a postgres connection.\n1 attempts remaining. Retrying in 0 seconds.\nError:\ncould not translate host name \"db\" to address: nodename nor servname provided, or not known\n", "name": "Postgres"}, "info": {"category": "", "code": "E001", "extra": {}, "invocation_id": "e062f9b5-6857-447e-bc99-671252e30964", "level": "debug", "msg": "Postgres adapter: Got a retryable error when attempting to open a postgres connection.\n1 attempts remaining. Retrying in 0 seconds.\nError:\ncould not translate host name \"db\" to address: nodename nor servname provided, or not known\n", "name": "AdapterEventDebug", "pid": 10474, "thread": "MainThread", "ts": "2023-08-08T12:25:38.937945Z"}}
{"data": {"args": ["BEGIN"], "base_msg": "Error running SQL: {}", "name": "Postgres"}, "info": {"category": "", "code": "E001", "extra": {}, "invocation_id": "e062f9b5-6857-447e-bc99-671252e30964", "level": "debug", "msg": "Postgres adapter: Error running SQL: BEGIN", "name": "AdapterEventDebug", "pid": 10474, "thread": "MainThread", "ts": "2023-08-08T12:25:38.941219Z"}}
{"data": {"args": [], "base_msg": "Rolling back transaction.", "name": "Postgres"}, "info": {"category": "", "code": "E001", "extra": {}, "invocation_id": "e062f9b5-6857-447e-bc99-671252e30964", "level": "debug", "msg": "Postgres adapter: Rolling back transaction.", "name": "AdapterEventDebug", "pid": 10474, "thread": "MainThread", "ts": "2023-08-08T12:25:38.941988Z"}}
{"data": {"conn_name": "macro_log_macro_results"}, "info": {"category": "", "code": "E011", "extra": {}, "invocation_id": "e062f9b5-6857-447e-bc99-671252e30964", "level": "debug", "msg": "On macro_log_macro_results: No close available on handle", "name": "ConnectionLeftOpen", "pid": 10474, "thread": "MainThread", "ts": "2023-08-08T12:25:38.942689Z"}}
{"data": {"exc": "Database Error\n  could not translate host name \"db\" to address: nodename nor servname provided, or not known\n  "}, "info": {"category": "", "code": "Q001", "extra": {}, "invocation_id": "e062f9b5-6857-447e-bc99-671252e30964", "level": "error", "msg": "Encountered an error while running operation: Database Error\n  could not translate host name \"db\" to address: nodename nor servname provided, or not known\n  ", "name": "RunningOperationCaughtError", "pid": 10474, "thread": "MainThread", "ts": "2023-08-08T12:25:38.944008Z"}}
{"data": {"exc_info": "Traceback (most recent call last):\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/base/connections.py\", line 241, in retry_connection\n    connection.handle = connect()\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/postgres/connections.py\", line 134, in connect\n    handle = psycopg2.connect(\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/psycopg2/__init__.py\", line 122, in connect\n    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)\npsycopg2.OperationalError: could not translate host name \"db\" to address: nodename nor servname provided, or not known\n\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/base/connections.py\", line 241, in retry_connection\n    connection.handle = connect()\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/postgres/connections.py\", line 134, in connect\n    handle = psycopg2.connect(\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/psycopg2/__init__.py\", line 122, in connect\n    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)\npsycopg2.OperationalError: could not translate host name \"db\" to address: nodename nor servname provided, or not known\n\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/task/run_operation.py\", line 58, in run\n    self._run_unsafe(package_name, macro_name)\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/task/run_operation.py\", line 42, in _run_unsafe\n    adapter.clear_transaction()\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/base/impl.py\", line 244, in clear_transaction\n    self.connections.clear_transaction()\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/base/connections.py\", line 122, in clear_transaction\n    self.begin()\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/sql/connections.py\", line 172, in begin\n    self.add_begin_query()\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/sql/connections.py\", line 155, in add_begin_query\n    return self.add_query(\"BEGIN\", auto_begin=False)\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/sql/connections.py\", line 79, in add_query\n    cursor = connection.handle.cursor()\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/contracts/connection.py\", line 94, in handle\n    self._handle.resolve(self)\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/contracts/connection.py\", line 118, in resolve\n    return self.opener(connection)\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/postgres/connections.py\", line 159, in open\n    return cls.retry_connection(\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/base/connections.py\", line 258, in retry_connection\n    return cls.retry_connection(\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/base/connections.py\", line 249, in retry_connection\n    raise dbt.exceptions.FailedToConnectError(str(e))\ndbt.exceptions.FailedToConnectError: Database Error\n  could not translate host name \"db\" to address: nodename nor servname provided, or not known\n  \n"}, "info": {"category": "", "code": "Z011", "extra": {}, "invocation_id": "e062f9b5-6857-447e-bc99-671252e30964", "level": "debug", "msg": "Traceback (most recent call last):\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/base/connections.py\", line 241, in retry_connection\n    connection.handle = connect()\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/postgres/connections.py\", line 134, in connect\n    handle = psycopg2.connect(\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/psycopg2/__init__.py\", line 122, in connect\n    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)\npsycopg2.OperationalError: could not translate host name \"db\" to address: nodename nor servname provided, or not known\n\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/base/connections.py\", line 241, in retry_connection\n    connection.handle = connect()\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/postgres/connections.py\", line 134, in connect\n    handle = psycopg2.connect(\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/psycopg2/__init__.py\", line 122, in connect\n    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)\npsycopg2.OperationalError: could not translate host name \"db\" to address: nodename nor servname provided, or not known\n\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/task/run_operation.py\", line 58, in run\n    self._run_unsafe(package_name, macro_name)\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/task/run_operation.py\", line 42, in _run_unsafe\n    adapter.clear_transaction()\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/base/impl.py\", line 244, in clear_transaction\n    self.connections.clear_transaction()\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/base/connections.py\", line 122, in clear_transaction\n    self.begin()\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/sql/connections.py\", line 172, in begin\n    self.add_begin_query()\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/sql/connections.py\", line 155, in add_begin_query\n    return self.add_query(\"BEGIN\", auto_begin=False)\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/sql/connections.py\", line 79, in add_query\n    cursor = connection.handle.cursor()\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/contracts/connection.py\", line 94, in handle\n    self._handle.resolve(self)\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/contracts/connection.py\", line 118, in resolve\n    return self.opener(connection)\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/postgres/connections.py\", line 159, in open\n    return cls.retry_connection(\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/base/connections.py\", line 258, in retry_connection\n    return cls.retry_connection(\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/base/connections.py\", line 249, in retry_connection\n    raise dbt.exceptions.FailedToConnectError(str(e))\ndbt.exceptions.FailedToConnectError: Database Error\n  could not translate host name \"db\" to address: nodename nor servname provided, or not known\n  \n", "name": "LogDebugStackTrace", "pid": 10474, "thread": "MainThread", "ts": "2023-08-08T12:25:38.947690Z"}}
{"data": {"command": "dbt run-operation", "completed_at": "2023-08-08T12:25:38.949402Z", "elapsed": 2.5123546, "success": false}, "info": {"category": "", "code": "Q039", "extra": {}, "invocation_id": "e062f9b5-6857-447e-bc99-671252e30964", "level": "debug", "msg": "Command `dbt run-operation` failed at 15:25:38.949402 after 2.51 seconds", "name": "CommandCompleted", "pid": 10474, "thread": "MainThread", "ts": "2023-08-08T12:25:38.949539Z"}}
{"data": {"conn_name": "macro_log_macro_results"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "e062f9b5-6857-447e-bc99-671252e30964", "level": "debug", "msg": "Connection 'macro_log_macro_results' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 10474, "thread": "MainThread", "ts": "2023-08-08T12:25:38.950145Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101835c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107523100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105684370>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "e062f9b5-6857-447e-bc99-671252e30964", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101835c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107523100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105684370>]}", "name": "SendingEvent", "pid": 10474, "thread": "MainThread", "ts": "2023-08-08T12:25:38.950666Z"}}
{"data": {}, "info": {"category": "", "code": "Z042", "extra": {}, "invocation_id": "e062f9b5-6857-447e-bc99-671252e30964", "level": "debug", "msg": "Flushing usage events", "name": "FlushEvents", "pid": 10474, "thread": "MainThread", "ts": "2023-08-08T12:25:38.951227Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10221d5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cec280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cecbe0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "ee0f480d-13f6-43e1-abbf-28b43ace6c25", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10221d5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cec280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cecbe0>]}", "name": "SendingEvent", "pid": 10484, "thread": "MainThread", "ts": "2023-08-08T12:25:40.739941Z"}}
{"data": {"log_version": 3, "version": "=1.6.0"}, "info": {"category": "", "code": "A001", "extra": {}, "invocation_id": "ee0f480d-13f6-43e1-abbf-28b43ace6c25", "level": "info", "msg": "Running with dbt=1.6.0", "name": "MainReportVersion", "pid": 10484, "thread": "MainThread", "ts": "2023-08-08T12:25:40.741805Z"}}
{"data": {"args": {"cache_selected_only": "False", "debug": "False", "fail_fast": "False", "indirect_selection": "eager", "introspect": "True", "invocation_command": "dbt --log-format json run-operation elementary.log_macro_results --args {\"macro_name\": \"get_adapter_type_and_unique_id\", \"macro_args\": {}} --project-dir /Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/elementary/monitor/dbt_project", "log_cache_events": "False", "log_format": "json", "log_path": "/Users/ofek/workspace/test_dbt/edr_target", "no_print": "None", "partial_parse": "True", "printer_width": "80", "profiles_dir": "/Users/ofek/.dbt", "quiet": "False", "send_anonymous_usage_stats": "True", "static_parser": "True", "target_path": "None", "use_colors": "True", "use_experimental_parser": "False", "version_check": "True", "warn_error": "None", "warn_error_options": "WarnErrorOptions(include=[], exclude=[])", "write_json": "True"}}, "info": {"category": "", "code": "A002", "extra": {}, "invocation_id": "ee0f480d-13f6-43e1-abbf-28b43ace6c25", "level": "debug", "msg": "running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ofek/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/ofek/workspace/test_dbt/edr_target', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'json', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt --log-format json run-operation elementary.log_macro_results --args {\"macro_name\": \"get_adapter_type_and_unique_id\", \"macro_args\": {}} --project-dir /Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/elementary/monitor/dbt_project', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}", "name": "MainReportArgs", "pid": 10484, "thread": "MainThread", "ts": "2023-08-08T12:25:40.742182Z"}}
{"data": {"profile_name": "elementary", "target_name": "default"}, "info": {"category": "", "code": "A005", "extra": {}, "invocation_id": "ee0f480d-13f6-43e1-abbf-28b43ace6c25", "level": "info", "msg": "target not specified in profile 'elementary', using 'default'", "name": "MissingProfileTarget", "pid": 10484, "thread": "MainThread", "ts": "2023-08-08T12:25:40.758089Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'project_id', 'label': 'ee0f480d-13f6-43e1-abbf-28b43ace6c25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104372c70>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "ee0f480d-13f6-43e1-abbf-28b43ace6c25", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ee0f480d-13f6-43e1-abbf-28b43ace6c25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104372c70>]}", "name": "SendingEvent", "pid": 10484, "thread": "MainThread", "ts": "2023-08-08T12:25:40.894343Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'adapter_info', 'label': 'ee0f480d-13f6-43e1-abbf-28b43ace6c25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106010e80>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "ee0f480d-13f6-43e1-abbf-28b43ace6c25", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ee0f480d-13f6-43e1-abbf-28b43ace6c25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106010e80>]}", "name": "SendingEvent", "pid": 10484, "thread": "MainThread", "ts": "2023-08-08T12:25:40.899899Z"}}
{"data": {"adapter_name": "postgres", "adapter_version": "=1.6.0"}, "info": {"category": "", "code": "E034", "extra": {}, "invocation_id": "ee0f480d-13f6-43e1-abbf-28b43ace6c25", "level": "info", "msg": "Registered adapter: postgres=1.6.0", "name": "AdapterRegistered", "pid": 10484, "thread": "MainThread", "ts": "2023-08-08T12:25:40.900287Z"}}
{"data": {"checksum": "08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9", "profile": "", "target": "", "vars": "{}", "version": "1.6.0"}, "info": {"category": "", "code": "I025", "extra": {}, "invocation_id": "ee0f480d-13f6-43e1-abbf-28b43ace6c25", "level": "debug", "msg": "checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0", "name": "StateCheckVarsHash", "pid": 10484, "thread": "MainThread", "ts": "2023-08-08T12:25:40.912750Z"}}
{"data": {"added": 0, "changed": 0, "deleted": 0}, "info": {"category": "", "code": "I040", "extra": {}, "invocation_id": "ee0f480d-13f6-43e1-abbf-28b43ace6c25", "level": "debug", "msg": "Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.", "name": "PartialParsingEnabled", "pid": 10484, "thread": "MainThread", "ts": "2023-08-08T12:25:40.991075Z"}}
{"data": {}, "info": {"category": "", "code": "I017", "extra": {}, "invocation_id": "ee0f480d-13f6-43e1-abbf-28b43ace6c25", "level": "debug", "msg": "Partial parsing enabled, no changes found, skipping parsing", "name": "PartialParsingSkipParsing", "pid": 10484, "thread": "MainThread", "ts": "2023-08-08T12:25:40.991365Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'load_project', 'label': 'ee0f480d-13f6-43e1-abbf-28b43ace6c25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065570d0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "ee0f480d-13f6-43e1-abbf-28b43ace6c25", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ee0f480d-13f6-43e1-abbf-28b43ace6c25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065570d0>]}", "name": "SendingEvent", "pid": 10484, "thread": "MainThread", "ts": "2023-08-08T12:25:40.996545Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'resource_counts', 'label': 'ee0f480d-13f6-43e1-abbf-28b43ace6c25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064fe760>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "ee0f480d-13f6-43e1-abbf-28b43ace6c25", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ee0f480d-13f6-43e1-abbf-28b43ace6c25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064fe760>]}", "name": "SendingEvent", "pid": 10484, "thread": "MainThread", "ts": "2023-08-08T12:25:41.011814Z"}}
{"data": {"stat_line": "34 models, 2 operations, 6 tests, 6 sources, 0 exposures, 0 metrics, 1101 macros, 0 groups, 0 semantic models"}, "info": {"category": "", "code": "W006", "extra": {}, "invocation_id": "ee0f480d-13f6-43e1-abbf-28b43ace6c25", "level": "info", "msg": "Found 34 models, 2 operations, 6 tests, 6 sources, 0 exposures, 0 metrics, 1101 macros, 0 groups, 0 semantic models", "name": "FoundStats", "pid": 10484, "thread": "MainThread", "ts": "2023-08-08T12:25:41.012103Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee0f480d-13f6-43e1-abbf-28b43ace6c25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064feb50>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "ee0f480d-13f6-43e1-abbf-28b43ace6c25", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee0f480d-13f6-43e1-abbf-28b43ace6c25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064feb50>]}", "name": "SendingEvent", "pid": 10484, "thread": "MainThread", "ts": "2023-08-08T12:25:41.012343Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "ee0f480d-13f6-43e1-abbf-28b43ace6c25", "level": "debug", "msg": "Acquiring new postgres connection 'macro_log_macro_results'", "name": "NewConnection", "pid": 10484, "thread": "MainThread", "ts": "2023-08-08T12:25:41.012762Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "ee0f480d-13f6-43e1-abbf-28b43ace6c25", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 10484, "thread": "MainThread", "ts": "2023-08-08T12:25:41.013008Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "BEGIN"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "ee0f480d-13f6-43e1-abbf-28b43ace6c25", "level": "debug", "msg": "On macro_log_macro_results: BEGIN", "name": "SQLQuery", "pid": 10484, "thread": "MainThread", "ts": "2023-08-08T12:25:41.013224Z"}}
{"data": {"connection_state": "init"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "ee0f480d-13f6-43e1-abbf-28b43ace6c25", "level": "debug", "msg": "Opening a new connection, currently in state init", "name": "NewConnectionOpening", "pid": 10484, "thread": "MainThread", "ts": "2023-08-08T12:25:41.013432Z"}}
{"data": {"args": [], "base_msg": "Got a retryable error when attempting to open a postgres connection.\n1 attempts remaining. Retrying in 0 seconds.\nError:\ncould not translate host name \"db\" to address: nodename nor servname provided, or not known\n", "name": "Postgres"}, "info": {"category": "", "code": "E001", "extra": {}, "invocation_id": "ee0f480d-13f6-43e1-abbf-28b43ace6c25", "level": "debug", "msg": "Postgres adapter: Got a retryable error when attempting to open a postgres connection.\n1 attempts remaining. Retrying in 0 seconds.\nError:\ncould not translate host name \"db\" to address: nodename nor servname provided, or not known\n", "name": "AdapterEventDebug", "pid": 10484, "thread": "MainThread", "ts": "2023-08-08T12:25:41.016481Z"}}
{"data": {"args": ["BEGIN"], "base_msg": "Error running SQL: {}", "name": "Postgres"}, "info": {"category": "", "code": "E001", "extra": {}, "invocation_id": "ee0f480d-13f6-43e1-abbf-28b43ace6c25", "level": "debug", "msg": "Postgres adapter: Error running SQL: BEGIN", "name": "AdapterEventDebug", "pid": 10484, "thread": "MainThread", "ts": "2023-08-08T12:25:41.018695Z"}}
{"data": {"args": [], "base_msg": "Rolling back transaction.", "name": "Postgres"}, "info": {"category": "", "code": "E001", "extra": {}, "invocation_id": "ee0f480d-13f6-43e1-abbf-28b43ace6c25", "level": "debug", "msg": "Postgres adapter: Rolling back transaction.", "name": "AdapterEventDebug", "pid": 10484, "thread": "MainThread", "ts": "2023-08-08T12:25:41.018947Z"}}
{"data": {"conn_name": "macro_log_macro_results"}, "info": {"category": "", "code": "E011", "extra": {}, "invocation_id": "ee0f480d-13f6-43e1-abbf-28b43ace6c25", "level": "debug", "msg": "On macro_log_macro_results: No close available on handle", "name": "ConnectionLeftOpen", "pid": 10484, "thread": "MainThread", "ts": "2023-08-08T12:25:41.019175Z"}}
{"data": {"exc": "Database Error\n  could not translate host name \"db\" to address: nodename nor servname provided, or not known\n  "}, "info": {"category": "", "code": "Q001", "extra": {}, "invocation_id": "ee0f480d-13f6-43e1-abbf-28b43ace6c25", "level": "error", "msg": "Encountered an error while running operation: Database Error\n  could not translate host name \"db\" to address: nodename nor servname provided, or not known\n  ", "name": "RunningOperationCaughtError", "pid": 10484, "thread": "MainThread", "ts": "2023-08-08T12:25:41.019560Z"}}
{"data": {"exc_info": "Traceback (most recent call last):\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/base/connections.py\", line 241, in retry_connection\n    connection.handle = connect()\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/postgres/connections.py\", line 134, in connect\n    handle = psycopg2.connect(\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/psycopg2/__init__.py\", line 122, in connect\n    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)\npsycopg2.OperationalError: could not translate host name \"db\" to address: nodename nor servname provided, or not known\n\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/base/connections.py\", line 241, in retry_connection\n    connection.handle = connect()\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/postgres/connections.py\", line 134, in connect\n    handle = psycopg2.connect(\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/psycopg2/__init__.py\", line 122, in connect\n    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)\npsycopg2.OperationalError: could not translate host name \"db\" to address: nodename nor servname provided, or not known\n\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/task/run_operation.py\", line 58, in run\n    self._run_unsafe(package_name, macro_name)\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/task/run_operation.py\", line 42, in _run_unsafe\n    adapter.clear_transaction()\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/base/impl.py\", line 244, in clear_transaction\n    self.connections.clear_transaction()\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/base/connections.py\", line 122, in clear_transaction\n    self.begin()\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/sql/connections.py\", line 172, in begin\n    self.add_begin_query()\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/sql/connections.py\", line 155, in add_begin_query\n    return self.add_query(\"BEGIN\", auto_begin=False)\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/sql/connections.py\", line 79, in add_query\n    cursor = connection.handle.cursor()\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/contracts/connection.py\", line 94, in handle\n    self._handle.resolve(self)\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/contracts/connection.py\", line 118, in resolve\n    return self.opener(connection)\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/postgres/connections.py\", line 159, in open\n    return cls.retry_connection(\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/base/connections.py\", line 258, in retry_connection\n    return cls.retry_connection(\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/base/connections.py\", line 249, in retry_connection\n    raise dbt.exceptions.FailedToConnectError(str(e))\ndbt.exceptions.FailedToConnectError: Database Error\n  could not translate host name \"db\" to address: nodename nor servname provided, or not known\n  \n"}, "info": {"category": "", "code": "Z011", "extra": {}, "invocation_id": "ee0f480d-13f6-43e1-abbf-28b43ace6c25", "level": "debug", "msg": "Traceback (most recent call last):\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/base/connections.py\", line 241, in retry_connection\n    connection.handle = connect()\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/postgres/connections.py\", line 134, in connect\n    handle = psycopg2.connect(\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/psycopg2/__init__.py\", line 122, in connect\n    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)\npsycopg2.OperationalError: could not translate host name \"db\" to address: nodename nor servname provided, or not known\n\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/base/connections.py\", line 241, in retry_connection\n    connection.handle = connect()\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/postgres/connections.py\", line 134, in connect\n    handle = psycopg2.connect(\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/psycopg2/__init__.py\", line 122, in connect\n    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)\npsycopg2.OperationalError: could not translate host name \"db\" to address: nodename nor servname provided, or not known\n\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/task/run_operation.py\", line 58, in run\n    self._run_unsafe(package_name, macro_name)\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/task/run_operation.py\", line 42, in _run_unsafe\n    adapter.clear_transaction()\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/base/impl.py\", line 244, in clear_transaction\n    self.connections.clear_transaction()\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/base/connections.py\", line 122, in clear_transaction\n    self.begin()\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/sql/connections.py\", line 172, in begin\n    self.add_begin_query()\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/sql/connections.py\", line 155, in add_begin_query\n    return self.add_query(\"BEGIN\", auto_begin=False)\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/sql/connections.py\", line 79, in add_query\n    cursor = connection.handle.cursor()\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/contracts/connection.py\", line 94, in handle\n    self._handle.resolve(self)\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/contracts/connection.py\", line 118, in resolve\n    return self.opener(connection)\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/postgres/connections.py\", line 159, in open\n    return cls.retry_connection(\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/base/connections.py\", line 258, in retry_connection\n    return cls.retry_connection(\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/base/connections.py\", line 249, in retry_connection\n    raise dbt.exceptions.FailedToConnectError(str(e))\ndbt.exceptions.FailedToConnectError: Database Error\n  could not translate host name \"db\" to address: nodename nor servname provided, or not known\n  \n", "name": "LogDebugStackTrace", "pid": 10484, "thread": "MainThread", "ts": "2023-08-08T12:25:41.020424Z"}}
{"data": {"command": "dbt run-operation", "completed_at": "2023-08-08T12:25:41.021097Z", "elapsed": 0.29166016, "success": false}, "info": {"category": "", "code": "Q039", "extra": {}, "invocation_id": "ee0f480d-13f6-43e1-abbf-28b43ace6c25", "level": "debug", "msg": "Command `dbt run-operation` failed at 15:25:41.021097 after 0.29 seconds", "name": "CommandCompleted", "pid": 10484, "thread": "MainThread", "ts": "2023-08-08T12:25:41.021151Z"}}
{"data": {"conn_name": "macro_log_macro_results"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "ee0f480d-13f6-43e1-abbf-28b43ace6c25", "level": "debug", "msg": "Connection 'macro_log_macro_results' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 10484, "thread": "MainThread", "ts": "2023-08-08T12:25:41.021396Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10221d5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064f3fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064feb50>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "ee0f480d-13f6-43e1-abbf-28b43ace6c25", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10221d5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064f3fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064feb50>]}", "name": "SendingEvent", "pid": 10484, "thread": "MainThread", "ts": "2023-08-08T12:25:41.021610Z"}}
{"data": {}, "info": {"category": "", "code": "Z042", "extra": {}, "invocation_id": "ee0f480d-13f6-43e1-abbf-28b43ace6c25", "level": "debug", "msg": "Flushing usage events", "name": "FlushEvents", "pid": 10484, "thread": "MainThread", "ts": "2023-08-08T12:25:41.021842Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10422d4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10770b0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10770bbe0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "f3a1a6fc-ae08-4d29-ad28-ac23b2770c07", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10422d4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10770b0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10770bbe0>]}", "name": "SendingEvent", "pid": 10492, "thread": "MainThread", "ts": "2023-08-08T12:25:42.781464Z"}}
{"data": {"log_version": 3, "version": "=1.6.0"}, "info": {"category": "", "code": "A001", "extra": {}, "invocation_id": "f3a1a6fc-ae08-4d29-ad28-ac23b2770c07", "level": "info", "msg": "Running with dbt=1.6.0", "name": "MainReportVersion", "pid": 10492, "thread": "MainThread", "ts": "2023-08-08T12:25:42.783486Z"}}
{"data": {"args": {"cache_selected_only": "False", "debug": "False", "fail_fast": "False", "indirect_selection": "eager", "introspect": "True", "invocation_command": "dbt --log-format json run-operation elementary.log_macro_results --args {\"macro_name\": \"get_elementary_database_and_schema\", \"macro_args\": {}} --project-dir /Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/elementary/monitor/dbt_project", "log_cache_events": "False", "log_format": "json", "log_path": "/Users/ofek/workspace/test_dbt/edr_target", "no_print": "None", "partial_parse": "True", "printer_width": "80", "profiles_dir": "/Users/ofek/.dbt", "quiet": "False", "send_anonymous_usage_stats": "True", "static_parser": "True", "target_path": "None", "use_colors": "True", "use_experimental_parser": "False", "version_check": "True", "warn_error": "None", "warn_error_options": "WarnErrorOptions(include=[], exclude=[])", "write_json": "True"}}, "info": {"category": "", "code": "A002", "extra": {}, "invocation_id": "f3a1a6fc-ae08-4d29-ad28-ac23b2770c07", "level": "debug", "msg": "running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/ofek/.dbt', 'log_path': '/Users/ofek/workspace/test_dbt/edr_target', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'json', 'target_path': 'None', 'invocation_command': 'dbt --log-format json run-operation elementary.log_macro_results --args {\"macro_name\": \"get_elementary_database_and_schema\", \"macro_args\": {}} --project-dir /Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/elementary/monitor/dbt_project', 'send_anonymous_usage_stats': 'True'}", "name": "MainReportArgs", "pid": 10492, "thread": "MainThread", "ts": "2023-08-08T12:25:42.783866Z"}}
{"data": {"profile_name": "elementary", "target_name": "default"}, "info": {"category": "", "code": "A005", "extra": {}, "invocation_id": "f3a1a6fc-ae08-4d29-ad28-ac23b2770c07", "level": "info", "msg": "target not specified in profile 'elementary', using 'default'", "name": "MissingProfileTarget", "pid": 10492, "thread": "MainThread", "ts": "2023-08-08T12:25:42.803753Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'project_id', 'label': 'f3a1a6fc-ae08-4d29-ad28-ac23b2770c07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106490940>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "f3a1a6fc-ae08-4d29-ad28-ac23b2770c07", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f3a1a6fc-ae08-4d29-ad28-ac23b2770c07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106490940>]}", "name": "SendingEvent", "pid": 10492, "thread": "MainThread", "ts": "2023-08-08T12:25:42.953417Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'adapter_info', 'label': 'f3a1a6fc-ae08-4d29-ad28-ac23b2770c07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112636e80>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "f3a1a6fc-ae08-4d29-ad28-ac23b2770c07", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f3a1a6fc-ae08-4d29-ad28-ac23b2770c07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112636e80>]}", "name": "SendingEvent", "pid": 10492, "thread": "MainThread", "ts": "2023-08-08T12:25:42.959291Z"}}
{"data": {"adapter_name": "postgres", "adapter_version": "=1.6.0"}, "info": {"category": "", "code": "E034", "extra": {}, "invocation_id": "f3a1a6fc-ae08-4d29-ad28-ac23b2770c07", "level": "info", "msg": "Registered adapter: postgres=1.6.0", "name": "AdapterRegistered", "pid": 10492, "thread": "MainThread", "ts": "2023-08-08T12:25:42.959676Z"}}
{"data": {"checksum": "08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9", "profile": "", "target": "", "vars": "{}", "version": "1.6.0"}, "info": {"category": "", "code": "I025", "extra": {}, "invocation_id": "f3a1a6fc-ae08-4d29-ad28-ac23b2770c07", "level": "debug", "msg": "checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0", "name": "StateCheckVarsHash", "pid": 10492, "thread": "MainThread", "ts": "2023-08-08T12:25:42.973319Z"}}
{"data": {"added": 0, "changed": 0, "deleted": 0}, "info": {"category": "", "code": "I040", "extra": {}, "invocation_id": "f3a1a6fc-ae08-4d29-ad28-ac23b2770c07", "level": "debug", "msg": "Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.", "name": "PartialParsingEnabled", "pid": 10492, "thread": "MainThread", "ts": "2023-08-08T12:25:43.055273Z"}}
{"data": {}, "info": {"category": "", "code": "I017", "extra": {}, "invocation_id": "f3a1a6fc-ae08-4d29-ad28-ac23b2770c07", "level": "debug", "msg": "Partial parsing enabled, no changes found, skipping parsing", "name": "PartialParsingSkipParsing", "pid": 10492, "thread": "MainThread", "ts": "2023-08-08T12:25:43.055581Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'load_project', 'label': 'f3a1a6fc-ae08-4d29-ad28-ac23b2770c07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c7f0d0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "f3a1a6fc-ae08-4d29-ad28-ac23b2770c07", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f3a1a6fc-ae08-4d29-ad28-ac23b2770c07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c7f0d0>]}", "name": "SendingEvent", "pid": 10492, "thread": "MainThread", "ts": "2023-08-08T12:25:43.061017Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'resource_counts', 'label': 'f3a1a6fc-ae08-4d29-ad28-ac23b2770c07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c277c0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "f3a1a6fc-ae08-4d29-ad28-ac23b2770c07", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f3a1a6fc-ae08-4d29-ad28-ac23b2770c07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c277c0>]}", "name": "SendingEvent", "pid": 10492, "thread": "MainThread", "ts": "2023-08-08T12:25:43.076760Z"}}
{"data": {"stat_line": "34 models, 2 operations, 6 tests, 6 sources, 0 exposures, 0 metrics, 1101 macros, 0 groups, 0 semantic models"}, "info": {"category": "", "code": "W006", "extra": {}, "invocation_id": "f3a1a6fc-ae08-4d29-ad28-ac23b2770c07", "level": "info", "msg": "Found 34 models, 2 operations, 6 tests, 6 sources, 0 exposures, 0 metrics, 1101 macros, 0 groups, 0 semantic models", "name": "FoundStats", "pid": 10492, "thread": "MainThread", "ts": "2023-08-08T12:25:43.077058Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'runnable_timing', 'label': 'f3a1a6fc-ae08-4d29-ad28-ac23b2770c07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1125fe400>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "f3a1a6fc-ae08-4d29-ad28-ac23b2770c07", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f3a1a6fc-ae08-4d29-ad28-ac23b2770c07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1125fe400>]}", "name": "SendingEvent", "pid": 10492, "thread": "MainThread", "ts": "2023-08-08T12:25:43.077324Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "f3a1a6fc-ae08-4d29-ad28-ac23b2770c07", "level": "debug", "msg": "Acquiring new postgres connection 'macro_log_macro_results'", "name": "NewConnection", "pid": 10492, "thread": "MainThread", "ts": "2023-08-08T12:25:43.077759Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "f3a1a6fc-ae08-4d29-ad28-ac23b2770c07", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 10492, "thread": "MainThread", "ts": "2023-08-08T12:25:43.078022Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "BEGIN"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "f3a1a6fc-ae08-4d29-ad28-ac23b2770c07", "level": "debug", "msg": "On macro_log_macro_results: BEGIN", "name": "SQLQuery", "pid": 10492, "thread": "MainThread", "ts": "2023-08-08T12:25:43.078252Z"}}
{"data": {"connection_state": "init"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "f3a1a6fc-ae08-4d29-ad28-ac23b2770c07", "level": "debug", "msg": "Opening a new connection, currently in state init", "name": "NewConnectionOpening", "pid": 10492, "thread": "MainThread", "ts": "2023-08-08T12:25:43.078463Z"}}
{"data": {"args": [], "base_msg": "Got a retryable error when attempting to open a postgres connection.\n1 attempts remaining. Retrying in 0 seconds.\nError:\ncould not translate host name \"db\" to address: nodename nor servname provided, or not known\n", "name": "Postgres"}, "info": {"category": "", "code": "E001", "extra": {}, "invocation_id": "f3a1a6fc-ae08-4d29-ad28-ac23b2770c07", "level": "debug", "msg": "Postgres adapter: Got a retryable error when attempting to open a postgres connection.\n1 attempts remaining. Retrying in 0 seconds.\nError:\ncould not translate host name \"db\" to address: nodename nor servname provided, or not known\n", "name": "AdapterEventDebug", "pid": 10492, "thread": "MainThread", "ts": "2023-08-08T12:25:43.081601Z"}}
{"data": {"args": ["BEGIN"], "base_msg": "Error running SQL: {}", "name": "Postgres"}, "info": {"category": "", "code": "E001", "extra": {}, "invocation_id": "f3a1a6fc-ae08-4d29-ad28-ac23b2770c07", "level": "debug", "msg": "Postgres adapter: Error running SQL: BEGIN", "name": "AdapterEventDebug", "pid": 10492, "thread": "MainThread", "ts": "2023-08-08T12:25:43.084247Z"}}
{"data": {"args": [], "base_msg": "Rolling back transaction.", "name": "Postgres"}, "info": {"category": "", "code": "E001", "extra": {}, "invocation_id": "f3a1a6fc-ae08-4d29-ad28-ac23b2770c07", "level": "debug", "msg": "Postgres adapter: Rolling back transaction.", "name": "AdapterEventDebug", "pid": 10492, "thread": "MainThread", "ts": "2023-08-08T12:25:43.084625Z"}}
{"data": {"conn_name": "macro_log_macro_results"}, "info": {"category": "", "code": "E011", "extra": {}, "invocation_id": "f3a1a6fc-ae08-4d29-ad28-ac23b2770c07", "level": "debug", "msg": "On macro_log_macro_results: No close available on handle", "name": "ConnectionLeftOpen", "pid": 10492, "thread": "MainThread", "ts": "2023-08-08T12:25:43.084893Z"}}
{"data": {"exc": "Database Error\n  could not translate host name \"db\" to address: nodename nor servname provided, or not known\n  "}, "info": {"category": "", "code": "Q001", "extra": {}, "invocation_id": "f3a1a6fc-ae08-4d29-ad28-ac23b2770c07", "level": "error", "msg": "Encountered an error while running operation: Database Error\n  could not translate host name \"db\" to address: nodename nor servname provided, or not known\n  ", "name": "RunningOperationCaughtError", "pid": 10492, "thread": "MainThread", "ts": "2023-08-08T12:25:43.085353Z"}}
{"data": {"exc_info": "Traceback (most recent call last):\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/base/connections.py\", line 241, in retry_connection\n    connection.handle = connect()\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/postgres/connections.py\", line 134, in connect\n    handle = psycopg2.connect(\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/psycopg2/__init__.py\", line 122, in connect\n    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)\npsycopg2.OperationalError: could not translate host name \"db\" to address: nodename nor servname provided, or not known\n\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/base/connections.py\", line 241, in retry_connection\n    connection.handle = connect()\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/postgres/connections.py\", line 134, in connect\n    handle = psycopg2.connect(\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/psycopg2/__init__.py\", line 122, in connect\n    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)\npsycopg2.OperationalError: could not translate host name \"db\" to address: nodename nor servname provided, or not known\n\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/task/run_operation.py\", line 58, in run\n    self._run_unsafe(package_name, macro_name)\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/task/run_operation.py\", line 42, in _run_unsafe\n    adapter.clear_transaction()\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/base/impl.py\", line 244, in clear_transaction\n    self.connections.clear_transaction()\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/base/connections.py\", line 122, in clear_transaction\n    self.begin()\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/sql/connections.py\", line 172, in begin\n    self.add_begin_query()\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/sql/connections.py\", line 155, in add_begin_query\n    return self.add_query(\"BEGIN\", auto_begin=False)\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/sql/connections.py\", line 79, in add_query\n    cursor = connection.handle.cursor()\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/contracts/connection.py\", line 94, in handle\n    self._handle.resolve(self)\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/contracts/connection.py\", line 118, in resolve\n    return self.opener(connection)\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/postgres/connections.py\", line 159, in open\n    return cls.retry_connection(\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/base/connections.py\", line 258, in retry_connection\n    return cls.retry_connection(\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/base/connections.py\", line 249, in retry_connection\n    raise dbt.exceptions.FailedToConnectError(str(e))\ndbt.exceptions.FailedToConnectError: Database Error\n  could not translate host name \"db\" to address: nodename nor servname provided, or not known\n  \n"}, "info": {"category": "", "code": "Z011", "extra": {}, "invocation_id": "f3a1a6fc-ae08-4d29-ad28-ac23b2770c07", "level": "debug", "msg": "Traceback (most recent call last):\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/base/connections.py\", line 241, in retry_connection\n    connection.handle = connect()\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/postgres/connections.py\", line 134, in connect\n    handle = psycopg2.connect(\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/psycopg2/__init__.py\", line 122, in connect\n    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)\npsycopg2.OperationalError: could not translate host name \"db\" to address: nodename nor servname provided, or not known\n\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/base/connections.py\", line 241, in retry_connection\n    connection.handle = connect()\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/postgres/connections.py\", line 134, in connect\n    handle = psycopg2.connect(\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/psycopg2/__init__.py\", line 122, in connect\n    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)\npsycopg2.OperationalError: could not translate host name \"db\" to address: nodename nor servname provided, or not known\n\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/task/run_operation.py\", line 58, in run\n    self._run_unsafe(package_name, macro_name)\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/task/run_operation.py\", line 42, in _run_unsafe\n    adapter.clear_transaction()\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/base/impl.py\", line 244, in clear_transaction\n    self.connections.clear_transaction()\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/base/connections.py\", line 122, in clear_transaction\n    self.begin()\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/sql/connections.py\", line 172, in begin\n    self.add_begin_query()\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/sql/connections.py\", line 155, in add_begin_query\n    return self.add_query(\"BEGIN\", auto_begin=False)\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/sql/connections.py\", line 79, in add_query\n    cursor = connection.handle.cursor()\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/contracts/connection.py\", line 94, in handle\n    self._handle.resolve(self)\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/contracts/connection.py\", line 118, in resolve\n    return self.opener(connection)\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/postgres/connections.py\", line 159, in open\n    return cls.retry_connection(\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/base/connections.py\", line 258, in retry_connection\n    return cls.retry_connection(\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/base/connections.py\", line 249, in retry_connection\n    raise dbt.exceptions.FailedToConnectError(str(e))\ndbt.exceptions.FailedToConnectError: Database Error\n  could not translate host name \"db\" to address: nodename nor servname provided, or not known\n  \n", "name": "LogDebugStackTrace", "pid": 10492, "thread": "MainThread", "ts": "2023-08-08T12:25:43.086196Z"}}
{"data": {"command": "dbt run-operation", "completed_at": "2023-08-08T12:25:43.087089Z", "elapsed": 0.3166204, "success": false}, "info": {"category": "", "code": "Q039", "extra": {}, "invocation_id": "f3a1a6fc-ae08-4d29-ad28-ac23b2770c07", "level": "debug", "msg": "Command `dbt run-operation` failed at 15:25:43.087089 after 0.32 seconds", "name": "CommandCompleted", "pid": 10492, "thread": "MainThread", "ts": "2023-08-08T12:25:43.087151Z"}}
{"data": {"conn_name": "macro_log_macro_results"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "f3a1a6fc-ae08-4d29-ad28-ac23b2770c07", "level": "debug", "msg": "Connection 'macro_log_macro_results' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 10492, "thread": "MainThread", "ts": "2023-08-08T12:25:43.087451Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10422d4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112636e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112677eb0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "f3a1a6fc-ae08-4d29-ad28-ac23b2770c07", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10422d4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112636e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112677eb0>]}", "name": "SendingEvent", "pid": 10492, "thread": "MainThread", "ts": "2023-08-08T12:25:43.087694Z"}}
{"data": {}, "info": {"category": "", "code": "Z042", "extra": {}, "invocation_id": "f3a1a6fc-ae08-4d29-ad28-ac23b2770c07", "level": "debug", "msg": "Flushing usage events", "name": "FlushEvents", "pid": 10492, "thread": "MainThread", "ts": "2023-08-08T12:25:43.087944Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10593f100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104536ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083cebb0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "e97baf4f-589b-4976-a1d9-c093e6cef3ae", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10593f100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104536ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083cebb0>]}", "name": "SendingEvent", "pid": 10498, "thread": "MainThread", "ts": "2023-08-08T12:25:44.998388Z"}}
{"data": {"log_version": 3, "version": "=1.6.0"}, "info": {"category": "", "code": "A001", "extra": {}, "invocation_id": "e97baf4f-589b-4976-a1d9-c093e6cef3ae", "level": "info", "msg": "Running with dbt=1.6.0", "name": "MainReportVersion", "pid": 10498, "thread": "MainThread", "ts": "2023-08-08T12:25:45.000530Z"}}
{"data": {"args": {"cache_selected_only": "False", "debug": "False", "fail_fast": "False", "indirect_selection": "eager", "introspect": "True", "invocation_command": "dbt --log-format json run-operation elementary.log_macro_results --args {\"macro_name\": \"get_test_results\", \"macro_args\": {\"days_back\": 7, \"invocations_per_test\": 720, \"disable_passed_test_metrics\": false}} --project-dir /Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/elementary/monitor/dbt_project", "log_cache_events": "False", "log_format": "json", "log_path": "/Users/ofek/workspace/test_dbt/edr_target", "no_print": "None", "partial_parse": "True", "printer_width": "80", "profiles_dir": "/Users/ofek/.dbt", "quiet": "False", "send_anonymous_usage_stats": "True", "static_parser": "True", "target_path": "None", "use_colors": "True", "use_experimental_parser": "False", "version_check": "True", "warn_error": "None", "warn_error_options": "WarnErrorOptions(include=[], exclude=[])", "write_json": "True"}}, "info": {"category": "", "code": "A002", "extra": {}, "invocation_id": "e97baf4f-589b-4976-a1d9-c093e6cef3ae", "level": "debug", "msg": "running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ofek/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/ofek/workspace/test_dbt/edr_target', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'json', 'introspect': 'True', 'invocation_command': 'dbt --log-format json run-operation elementary.log_macro_results --args {\"macro_name\": \"get_test_results\", \"macro_args\": {\"days_back\": 7, \"invocations_per_test\": 720, \"disable_passed_test_metrics\": false}} --project-dir /Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/elementary/monitor/dbt_project', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}", "name": "MainReportArgs", "pid": 10498, "thread": "MainThread", "ts": "2023-08-08T12:25:45.000924Z"}}
{"data": {"profile_name": "elementary", "target_name": "default"}, "info": {"category": "", "code": "A005", "extra": {}, "invocation_id": "e97baf4f-589b-4976-a1d9-c093e6cef3ae", "level": "info", "msg": "target not specified in profile 'elementary', using 'default'", "name": "MissingProfileTarget", "pid": 10498, "thread": "MainThread", "ts": "2023-08-08T12:25:45.018366Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'project_id', 'label': 'e97baf4f-589b-4976-a1d9-c093e6cef3ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104536ac0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "e97baf4f-589b-4976-a1d9-c093e6cef3ae", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e97baf4f-589b-4976-a1d9-c093e6cef3ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104536ac0>]}", "name": "SendingEvent", "pid": 10498, "thread": "MainThread", "ts": "2023-08-08T12:25:45.157823Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'adapter_info', 'label': 'e97baf4f-589b-4976-a1d9-c093e6cef3ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109714f10>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "e97baf4f-589b-4976-a1d9-c093e6cef3ae", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e97baf4f-589b-4976-a1d9-c093e6cef3ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109714f10>]}", "name": "SendingEvent", "pid": 10498, "thread": "MainThread", "ts": "2023-08-08T12:25:45.163568Z"}}
{"data": {"adapter_name": "postgres", "adapter_version": "=1.6.0"}, "info": {"category": "", "code": "E034", "extra": {}, "invocation_id": "e97baf4f-589b-4976-a1d9-c093e6cef3ae", "level": "info", "msg": "Registered adapter: postgres=1.6.0", "name": "AdapterRegistered", "pid": 10498, "thread": "MainThread", "ts": "2023-08-08T12:25:45.163991Z"}}
{"data": {"checksum": "08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9", "profile": "", "target": "", "vars": "{}", "version": "1.6.0"}, "info": {"category": "", "code": "I025", "extra": {}, "invocation_id": "e97baf4f-589b-4976-a1d9-c093e6cef3ae", "level": "debug", "msg": "checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0", "name": "StateCheckVarsHash", "pid": 10498, "thread": "MainThread", "ts": "2023-08-08T12:25:45.176675Z"}}
{"data": {"added": 0, "changed": 0, "deleted": 0}, "info": {"category": "", "code": "I040", "extra": {}, "invocation_id": "e97baf4f-589b-4976-a1d9-c093e6cef3ae", "level": "debug", "msg": "Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.", "name": "PartialParsingEnabled", "pid": 10498, "thread": "MainThread", "ts": "2023-08-08T12:25:45.258148Z"}}
{"data": {}, "info": {"category": "", "code": "I017", "extra": {}, "invocation_id": "e97baf4f-589b-4976-a1d9-c093e6cef3ae", "level": "debug", "msg": "Partial parsing enabled, no changes found, skipping parsing", "name": "PartialParsingSkipParsing", "pid": 10498, "thread": "MainThread", "ts": "2023-08-08T12:25:45.258486Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'load_project', 'label': 'e97baf4f-589b-4976-a1d9-c093e6cef3ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c600d0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "e97baf4f-589b-4976-a1d9-c093e6cef3ae", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e97baf4f-589b-4976-a1d9-c093e6cef3ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c600d0>]}", "name": "SendingEvent", "pid": 10498, "thread": "MainThread", "ts": "2023-08-08T12:25:45.263898Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'resource_counts', 'label': 'e97baf4f-589b-4976-a1d9-c093e6cef3ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c07a60>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "e97baf4f-589b-4976-a1d9-c093e6cef3ae", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e97baf4f-589b-4976-a1d9-c093e6cef3ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c07a60>]}", "name": "SendingEvent", "pid": 10498, "thread": "MainThread", "ts": "2023-08-08T12:25:45.279877Z"}}
{"data": {"stat_line": "34 models, 2 operations, 6 tests, 6 sources, 0 exposures, 0 metrics, 1101 macros, 0 groups, 0 semantic models"}, "info": {"category": "", "code": "W006", "extra": {}, "invocation_id": "e97baf4f-589b-4976-a1d9-c093e6cef3ae", "level": "info", "msg": "Found 34 models, 2 operations, 6 tests, 6 sources, 0 exposures, 0 metrics, 1101 macros, 0 groups, 0 semantic models", "name": "FoundStats", "pid": 10498, "thread": "MainThread", "ts": "2023-08-08T12:25:45.280215Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'runnable_timing', 'label': 'e97baf4f-589b-4976-a1d9-c093e6cef3ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096dd490>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "e97baf4f-589b-4976-a1d9-c093e6cef3ae", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e97baf4f-589b-4976-a1d9-c093e6cef3ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096dd490>]}", "name": "SendingEvent", "pid": 10498, "thread": "MainThread", "ts": "2023-08-08T12:25:45.280475Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "e97baf4f-589b-4976-a1d9-c093e6cef3ae", "level": "debug", "msg": "Acquiring new postgres connection 'macro_log_macro_results'", "name": "NewConnection", "pid": 10498, "thread": "MainThread", "ts": "2023-08-08T12:25:45.280895Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "e97baf4f-589b-4976-a1d9-c093e6cef3ae", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 10498, "thread": "MainThread", "ts": "2023-08-08T12:25:45.281137Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "BEGIN"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "e97baf4f-589b-4976-a1d9-c093e6cef3ae", "level": "debug", "msg": "On macro_log_macro_results: BEGIN", "name": "SQLQuery", "pid": 10498, "thread": "MainThread", "ts": "2023-08-08T12:25:45.281356Z"}}
{"data": {"connection_state": "init"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "e97baf4f-589b-4976-a1d9-c093e6cef3ae", "level": "debug", "msg": "Opening a new connection, currently in state init", "name": "NewConnectionOpening", "pid": 10498, "thread": "MainThread", "ts": "2023-08-08T12:25:45.281593Z"}}
{"data": {"args": [], "base_msg": "Got a retryable error when attempting to open a postgres connection.\n1 attempts remaining. Retrying in 0 seconds.\nError:\ncould not translate host name \"db\" to address: nodename nor servname provided, or not known\n", "name": "Postgres"}, "info": {"category": "", "code": "E001", "extra": {}, "invocation_id": "e97baf4f-589b-4976-a1d9-c093e6cef3ae", "level": "debug", "msg": "Postgres adapter: Got a retryable error when attempting to open a postgres connection.\n1 attempts remaining. Retrying in 0 seconds.\nError:\ncould not translate host name \"db\" to address: nodename nor servname provided, or not known\n", "name": "AdapterEventDebug", "pid": 10498, "thread": "MainThread", "ts": "2023-08-08T12:25:45.284695Z"}}
{"data": {"args": ["BEGIN"], "base_msg": "Error running SQL: {}", "name": "Postgres"}, "info": {"category": "", "code": "E001", "extra": {}, "invocation_id": "e97baf4f-589b-4976-a1d9-c093e6cef3ae", "level": "debug", "msg": "Postgres adapter: Error running SQL: BEGIN", "name": "AdapterEventDebug", "pid": 10498, "thread": "MainThread", "ts": "2023-08-08T12:25:45.287250Z"}}
{"data": {"args": [], "base_msg": "Rolling back transaction.", "name": "Postgres"}, "info": {"category": "", "code": "E001", "extra": {}, "invocation_id": "e97baf4f-589b-4976-a1d9-c093e6cef3ae", "level": "debug", "msg": "Postgres adapter: Rolling back transaction.", "name": "AdapterEventDebug", "pid": 10498, "thread": "MainThread", "ts": "2023-08-08T12:25:45.287638Z"}}
{"data": {"conn_name": "macro_log_macro_results"}, "info": {"category": "", "code": "E011", "extra": {}, "invocation_id": "e97baf4f-589b-4976-a1d9-c093e6cef3ae", "level": "debug", "msg": "On macro_log_macro_results: No close available on handle", "name": "ConnectionLeftOpen", "pid": 10498, "thread": "MainThread", "ts": "2023-08-08T12:25:45.287899Z"}}
{"data": {"exc": "Database Error\n  could not translate host name \"db\" to address: nodename nor servname provided, or not known\n  "}, "info": {"category": "", "code": "Q001", "extra": {}, "invocation_id": "e97baf4f-589b-4976-a1d9-c093e6cef3ae", "level": "error", "msg": "Encountered an error while running operation: Database Error\n  could not translate host name \"db\" to address: nodename nor servname provided, or not known\n  ", "name": "RunningOperationCaughtError", "pid": 10498, "thread": "MainThread", "ts": "2023-08-08T12:25:45.288315Z"}}
{"data": {"exc_info": "Traceback (most recent call last):\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/base/connections.py\", line 241, in retry_connection\n    connection.handle = connect()\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/postgres/connections.py\", line 134, in connect\n    handle = psycopg2.connect(\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/psycopg2/__init__.py\", line 122, in connect\n    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)\npsycopg2.OperationalError: could not translate host name \"db\" to address: nodename nor servname provided, or not known\n\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/base/connections.py\", line 241, in retry_connection\n    connection.handle = connect()\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/postgres/connections.py\", line 134, in connect\n    handle = psycopg2.connect(\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/psycopg2/__init__.py\", line 122, in connect\n    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)\npsycopg2.OperationalError: could not translate host name \"db\" to address: nodename nor servname provided, or not known\n\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/task/run_operation.py\", line 58, in run\n    self._run_unsafe(package_name, macro_name)\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/task/run_operation.py\", line 42, in _run_unsafe\n    adapter.clear_transaction()\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/base/impl.py\", line 244, in clear_transaction\n    self.connections.clear_transaction()\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/base/connections.py\", line 122, in clear_transaction\n    self.begin()\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/sql/connections.py\", line 172, in begin\n    self.add_begin_query()\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/sql/connections.py\", line 155, in add_begin_query\n    return self.add_query(\"BEGIN\", auto_begin=False)\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/sql/connections.py\", line 79, in add_query\n    cursor = connection.handle.cursor()\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/contracts/connection.py\", line 94, in handle\n    self._handle.resolve(self)\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/contracts/connection.py\", line 118, in resolve\n    return self.opener(connection)\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/postgres/connections.py\", line 159, in open\n    return cls.retry_connection(\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/base/connections.py\", line 258, in retry_connection\n    return cls.retry_connection(\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/base/connections.py\", line 249, in retry_connection\n    raise dbt.exceptions.FailedToConnectError(str(e))\ndbt.exceptions.FailedToConnectError: Database Error\n  could not translate host name \"db\" to address: nodename nor servname provided, or not known\n  \n"}, "info": {"category": "", "code": "Z011", "extra": {}, "invocation_id": "e97baf4f-589b-4976-a1d9-c093e6cef3ae", "level": "debug", "msg": "Traceback (most recent call last):\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/base/connections.py\", line 241, in retry_connection\n    connection.handle = connect()\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/postgres/connections.py\", line 134, in connect\n    handle = psycopg2.connect(\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/psycopg2/__init__.py\", line 122, in connect\n    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)\npsycopg2.OperationalError: could not translate host name \"db\" to address: nodename nor servname provided, or not known\n\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/base/connections.py\", line 241, in retry_connection\n    connection.handle = connect()\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/postgres/connections.py\", line 134, in connect\n    handle = psycopg2.connect(\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/psycopg2/__init__.py\", line 122, in connect\n    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)\npsycopg2.OperationalError: could not translate host name \"db\" to address: nodename nor servname provided, or not known\n\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/task/run_operation.py\", line 58, in run\n    self._run_unsafe(package_name, macro_name)\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/task/run_operation.py\", line 42, in _run_unsafe\n    adapter.clear_transaction()\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/base/impl.py\", line 244, in clear_transaction\n    self.connections.clear_transaction()\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/base/connections.py\", line 122, in clear_transaction\n    self.begin()\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/sql/connections.py\", line 172, in begin\n    self.add_begin_query()\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/sql/connections.py\", line 155, in add_begin_query\n    return self.add_query(\"BEGIN\", auto_begin=False)\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/sql/connections.py\", line 79, in add_query\n    cursor = connection.handle.cursor()\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/contracts/connection.py\", line 94, in handle\n    self._handle.resolve(self)\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/contracts/connection.py\", line 118, in resolve\n    return self.opener(connection)\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/postgres/connections.py\", line 159, in open\n    return cls.retry_connection(\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/base/connections.py\", line 258, in retry_connection\n    return cls.retry_connection(\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/base/connections.py\", line 249, in retry_connection\n    raise dbt.exceptions.FailedToConnectError(str(e))\ndbt.exceptions.FailedToConnectError: Database Error\n  could not translate host name \"db\" to address: nodename nor servname provided, or not known\n  \n", "name": "LogDebugStackTrace", "pid": 10498, "thread": "MainThread", "ts": "2023-08-08T12:25:45.289131Z"}}
{"data": {"command": "dbt run-operation", "completed_at": "2023-08-08T12:25:45.289952Z", "elapsed": 0.30332732, "success": false}, "info": {"category": "", "code": "Q039", "extra": {}, "invocation_id": "e97baf4f-589b-4976-a1d9-c093e6cef3ae", "level": "debug", "msg": "Command `dbt run-operation` failed at 15:25:45.289952 after 0.30 seconds", "name": "CommandCompleted", "pid": 10498, "thread": "MainThread", "ts": "2023-08-08T12:25:45.290008Z"}}
{"data": {"conn_name": "macro_log_macro_results"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "e97baf4f-589b-4976-a1d9-c093e6cef3ae", "level": "debug", "msg": "Connection 'macro_log_macro_results' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 10498, "thread": "MainThread", "ts": "2023-08-08T12:25:45.290257Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10593f100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096f8f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109714ee0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "e97baf4f-589b-4976-a1d9-c093e6cef3ae", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10593f100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096f8f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109714ee0>]}", "name": "SendingEvent", "pid": 10498, "thread": "MainThread", "ts": "2023-08-08T12:25:45.290477Z"}}
{"data": {}, "info": {"category": "", "code": "Z042", "extra": {}, "invocation_id": "e97baf4f-589b-4976-a1d9-c093e6cef3ae", "level": "debug", "msg": "Flushing usage events", "name": "FlushEvents", "pid": 10498, "thread": "MainThread", "ts": "2023-08-08T12:25:45.290725Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106221970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cfd2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cfdc40>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "19e0c973-6e4a-4063-aaa6-02d00ef7612a", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106221970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cfd2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cfdc40>]}", "name": "SendingEvent", "pid": 13823, "thread": "MainThread", "ts": "2023-08-08T13:07:13.006723Z"}}
{"data": {"log_version": 3, "version": "=1.6.0"}, "info": {"category": "", "code": "A001", "extra": {}, "invocation_id": "19e0c973-6e4a-4063-aaa6-02d00ef7612a", "level": "info", "msg": "Running with dbt=1.6.0", "name": "MainReportVersion", "pid": 13823, "thread": "MainThread", "ts": "2023-08-08T13:07:13.009382Z"}}
{"data": {"args": {"cache_selected_only": "False", "debug": "False", "fail_fast": "False", "indirect_selection": "eager", "introspect": "True", "invocation_command": "dbt --log-format json run-operation elementary.log_macro_results --args {\"macro_name\": \"get_latest_invocation\", \"macro_args\": {}} --project-dir /Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/elementary/monitor/dbt_project", "log_cache_events": "False", "log_format": "json", "log_path": "/Users/ofek/workspace/test_dbt/edr_target", "no_print": "None", "partial_parse": "True", "printer_width": "80", "profiles_dir": "/Users/ofek/.dbt", "quiet": "False", "send_anonymous_usage_stats": "True", "static_parser": "True", "target_path": "None", "use_colors": "True", "use_experimental_parser": "False", "version_check": "True", "warn_error": "None", "warn_error_options": "WarnErrorOptions(include=[], exclude=[])", "write_json": "True"}}, "info": {"category": "", "code": "A002", "extra": {}, "invocation_id": "19e0c973-6e4a-4063-aaa6-02d00ef7612a", "level": "debug", "msg": "running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/ofek/.dbt', 'log_path': '/Users/ofek/workspace/test_dbt/edr_target', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'json', 'invocation_command': 'dbt --log-format json run-operation elementary.log_macro_results --args {\"macro_name\": \"get_latest_invocation\", \"macro_args\": {}} --project-dir /Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/elementary/monitor/dbt_project', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}", "name": "MainReportArgs", "pid": 13823, "thread": "MainThread", "ts": "2023-08-08T13:07:13.009790Z"}}
{"data": {"profile_name": "elementary", "target_name": "default"}, "info": {"category": "", "code": "A005", "extra": {}, "invocation_id": "19e0c973-6e4a-4063-aaa6-02d00ef7612a", "level": "info", "msg": "target not specified in profile 'elementary', using 'default'", "name": "MissingProfileTarget", "pid": 13823, "thread": "MainThread", "ts": "2023-08-08T13:07:13.027098Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'project_id', 'label': '19e0c973-6e4a-4063-aaa6-02d00ef7612a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d66220>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "19e0c973-6e4a-4063-aaa6-02d00ef7612a", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '19e0c973-6e4a-4063-aaa6-02d00ef7612a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d66220>]}", "name": "SendingEvent", "pid": 13823, "thread": "MainThread", "ts": "2023-08-08T13:07:13.229815Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'adapter_info', 'label': '19e0c973-6e4a-4063-aaa6-02d00ef7612a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a01fee0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "19e0c973-6e4a-4063-aaa6-02d00ef7612a", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '19e0c973-6e4a-4063-aaa6-02d00ef7612a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a01fee0>]}", "name": "SendingEvent", "pid": 13823, "thread": "MainThread", "ts": "2023-08-08T13:07:13.235949Z"}}
{"data": {"adapter_name": "postgres", "adapter_version": "=1.6.0"}, "info": {"category": "", "code": "E034", "extra": {}, "invocation_id": "19e0c973-6e4a-4063-aaa6-02d00ef7612a", "level": "info", "msg": "Registered adapter: postgres=1.6.0", "name": "AdapterRegistered", "pid": 13823, "thread": "MainThread", "ts": "2023-08-08T13:07:13.236617Z"}}
{"data": {"checksum": "08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9", "profile": "", "target": "", "vars": "{}", "version": "1.6.0"}, "info": {"category": "", "code": "I025", "extra": {}, "invocation_id": "19e0c973-6e4a-4063-aaa6-02d00ef7612a", "level": "debug", "msg": "checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0", "name": "StateCheckVarsHash", "pid": 13823, "thread": "MainThread", "ts": "2023-08-08T13:07:13.254360Z"}}
{"data": {"added": 0, "changed": 0, "deleted": 0}, "info": {"category": "", "code": "I040", "extra": {}, "invocation_id": "19e0c973-6e4a-4063-aaa6-02d00ef7612a", "level": "debug", "msg": "Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.", "name": "PartialParsingEnabled", "pid": 13823, "thread": "MainThread", "ts": "2023-08-08T13:07:13.361399Z"}}
{"data": {}, "info": {"category": "", "code": "I017", "extra": {}, "invocation_id": "19e0c973-6e4a-4063-aaa6-02d00ef7612a", "level": "debug", "msg": "Partial parsing enabled, no changes found, skipping parsing", "name": "PartialParsingSkipParsing", "pid": 13823, "thread": "MainThread", "ts": "2023-08-08T13:07:13.361749Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'load_project', 'label': '19e0c973-6e4a-4063-aaa6-02d00ef7612a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5680d0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "19e0c973-6e4a-4063-aaa6-02d00ef7612a", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '19e0c973-6e4a-4063-aaa6-02d00ef7612a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5680d0>]}", "name": "SendingEvent", "pid": 13823, "thread": "MainThread", "ts": "2023-08-08T13:07:13.367368Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'resource_counts', 'label': '19e0c973-6e4a-4063-aaa6-02d00ef7612a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a50d820>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "19e0c973-6e4a-4063-aaa6-02d00ef7612a", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '19e0c973-6e4a-4063-aaa6-02d00ef7612a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a50d820>]}", "name": "SendingEvent", "pid": 13823, "thread": "MainThread", "ts": "2023-08-08T13:07:13.386302Z"}}
{"data": {"stat_line": "34 models, 2 operations, 6 tests, 6 sources, 0 exposures, 0 metrics, 1101 macros, 0 groups, 0 semantic models"}, "info": {"category": "", "code": "W006", "extra": {}, "invocation_id": "19e0c973-6e4a-4063-aaa6-02d00ef7612a", "level": "info", "msg": "Found 34 models, 2 operations, 6 tests, 6 sources, 0 exposures, 0 metrics, 1101 macros, 0 groups, 0 semantic models", "name": "FoundStats", "pid": 13823, "thread": "MainThread", "ts": "2023-08-08T13:07:13.386657Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'runnable_timing', 'label': '19e0c973-6e4a-4063-aaa6-02d00ef7612a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fe6460>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "19e0c973-6e4a-4063-aaa6-02d00ef7612a", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '19e0c973-6e4a-4063-aaa6-02d00ef7612a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fe6460>]}", "name": "SendingEvent", "pid": 13823, "thread": "MainThread", "ts": "2023-08-08T13:07:13.386928Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "19e0c973-6e4a-4063-aaa6-02d00ef7612a", "level": "debug", "msg": "Acquiring new postgres connection 'macro_log_macro_results'", "name": "NewConnection", "pid": 13823, "thread": "MainThread", "ts": "2023-08-08T13:07:13.387471Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "19e0c973-6e4a-4063-aaa6-02d00ef7612a", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 13823, "thread": "MainThread", "ts": "2023-08-08T13:07:13.387747Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "BEGIN"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "19e0c973-6e4a-4063-aaa6-02d00ef7612a", "level": "debug", "msg": "On macro_log_macro_results: BEGIN", "name": "SQLQuery", "pid": 13823, "thread": "MainThread", "ts": "2023-08-08T13:07:13.387976Z"}}
{"data": {"connection_state": "init"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "19e0c973-6e4a-4063-aaa6-02d00ef7612a", "level": "debug", "msg": "Opening a new connection, currently in state init", "name": "NewConnectionOpening", "pid": 13823, "thread": "MainThread", "ts": "2023-08-08T13:07:13.388197Z"}}
{"data": {"args": [], "base_msg": "Got a retryable error when attempting to open a postgres connection.\n1 attempts remaining. Retrying in 0 seconds.\nError:\ncould not translate host name \"db\" to address: nodename nor servname provided, or not known\n", "name": "Postgres"}, "info": {"category": "", "code": "E001", "extra": {}, "invocation_id": "19e0c973-6e4a-4063-aaa6-02d00ef7612a", "level": "debug", "msg": "Postgres adapter: Got a retryable error when attempting to open a postgres connection.\n1 attempts remaining. Retrying in 0 seconds.\nError:\ncould not translate host name \"db\" to address: nodename nor servname provided, or not known\n", "name": "AdapterEventDebug", "pid": 13823, "thread": "MainThread", "ts": "2023-08-08T13:07:13.391733Z"}}
{"data": {"args": ["BEGIN"], "base_msg": "Error running SQL: {}", "name": "Postgres"}, "info": {"category": "", "code": "E001", "extra": {}, "invocation_id": "19e0c973-6e4a-4063-aaa6-02d00ef7612a", "level": "debug", "msg": "Postgres adapter: Error running SQL: BEGIN", "name": "AdapterEventDebug", "pid": 13823, "thread": "MainThread", "ts": "2023-08-08T13:07:13.393610Z"}}
{"data": {"args": [], "base_msg": "Rolling back transaction.", "name": "Postgres"}, "info": {"category": "", "code": "E001", "extra": {}, "invocation_id": "19e0c973-6e4a-4063-aaa6-02d00ef7612a", "level": "debug", "msg": "Postgres adapter: Rolling back transaction.", "name": "AdapterEventDebug", "pid": 13823, "thread": "MainThread", "ts": "2023-08-08T13:07:13.393843Z"}}
{"data": {"conn_name": "macro_log_macro_results"}, "info": {"category": "", "code": "E011", "extra": {}, "invocation_id": "19e0c973-6e4a-4063-aaa6-02d00ef7612a", "level": "debug", "msg": "On macro_log_macro_results: No close available on handle", "name": "ConnectionLeftOpen", "pid": 13823, "thread": "MainThread", "ts": "2023-08-08T13:07:13.394072Z"}}
{"data": {"exc": "Database Error\n  could not translate host name \"db\" to address: nodename nor servname provided, or not known\n  "}, "info": {"category": "", "code": "Q001", "extra": {}, "invocation_id": "19e0c973-6e4a-4063-aaa6-02d00ef7612a", "level": "error", "msg": "Encountered an error while running operation: Database Error\n  could not translate host name \"db\" to address: nodename nor servname provided, or not known\n  ", "name": "RunningOperationCaughtError", "pid": 13823, "thread": "MainThread", "ts": "2023-08-08T13:07:13.394437Z"}}
{"data": {"exc_info": "Traceback (most recent call last):\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/base/connections.py\", line 241, in retry_connection\n    connection.handle = connect()\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/postgres/connections.py\", line 134, in connect\n    handle = psycopg2.connect(\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/psycopg2/__init__.py\", line 122, in connect\n    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)\npsycopg2.OperationalError: could not translate host name \"db\" to address: nodename nor servname provided, or not known\n\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/base/connections.py\", line 241, in retry_connection\n    connection.handle = connect()\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/postgres/connections.py\", line 134, in connect\n    handle = psycopg2.connect(\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/psycopg2/__init__.py\", line 122, in connect\n    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)\npsycopg2.OperationalError: could not translate host name \"db\" to address: nodename nor servname provided, or not known\n\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/task/run_operation.py\", line 58, in run\n    self._run_unsafe(package_name, macro_name)\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/task/run_operation.py\", line 42, in _run_unsafe\n    adapter.clear_transaction()\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/base/impl.py\", line 244, in clear_transaction\n    self.connections.clear_transaction()\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/base/connections.py\", line 122, in clear_transaction\n    self.begin()\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/sql/connections.py\", line 172, in begin\n    self.add_begin_query()\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/sql/connections.py\", line 155, in add_begin_query\n    return self.add_query(\"BEGIN\", auto_begin=False)\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/sql/connections.py\", line 79, in add_query\n    cursor = connection.handle.cursor()\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/contracts/connection.py\", line 94, in handle\n    self._handle.resolve(self)\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/contracts/connection.py\", line 118, in resolve\n    return self.opener(connection)\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/postgres/connections.py\", line 159, in open\n    return cls.retry_connection(\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/base/connections.py\", line 258, in retry_connection\n    return cls.retry_connection(\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/base/connections.py\", line 249, in retry_connection\n    raise dbt.exceptions.FailedToConnectError(str(e))\ndbt.exceptions.FailedToConnectError: Database Error\n  could not translate host name \"db\" to address: nodename nor servname provided, or not known\n  \n"}, "info": {"category": "", "code": "Z011", "extra": {}, "invocation_id": "19e0c973-6e4a-4063-aaa6-02d00ef7612a", "level": "debug", "msg": "Traceback (most recent call last):\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/base/connections.py\", line 241, in retry_connection\n    connection.handle = connect()\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/postgres/connections.py\", line 134, in connect\n    handle = psycopg2.connect(\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/psycopg2/__init__.py\", line 122, in connect\n    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)\npsycopg2.OperationalError: could not translate host name \"db\" to address: nodename nor servname provided, or not known\n\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/base/connections.py\", line 241, in retry_connection\n    connection.handle = connect()\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/postgres/connections.py\", line 134, in connect\n    handle = psycopg2.connect(\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/psycopg2/__init__.py\", line 122, in connect\n    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)\npsycopg2.OperationalError: could not translate host name \"db\" to address: nodename nor servname provided, or not known\n\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/task/run_operation.py\", line 58, in run\n    self._run_unsafe(package_name, macro_name)\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/task/run_operation.py\", line 42, in _run_unsafe\n    adapter.clear_transaction()\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/base/impl.py\", line 244, in clear_transaction\n    self.connections.clear_transaction()\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/base/connections.py\", line 122, in clear_transaction\n    self.begin()\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/sql/connections.py\", line 172, in begin\n    self.add_begin_query()\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/sql/connections.py\", line 155, in add_begin_query\n    return self.add_query(\"BEGIN\", auto_begin=False)\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/sql/connections.py\", line 79, in add_query\n    cursor = connection.handle.cursor()\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/contracts/connection.py\", line 94, in handle\n    self._handle.resolve(self)\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/contracts/connection.py\", line 118, in resolve\n    return self.opener(connection)\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/postgres/connections.py\", line 159, in open\n    return cls.retry_connection(\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/base/connections.py\", line 258, in retry_connection\n    return cls.retry_connection(\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/base/connections.py\", line 249, in retry_connection\n    raise dbt.exceptions.FailedToConnectError(str(e))\ndbt.exceptions.FailedToConnectError: Database Error\n  could not translate host name \"db\" to address: nodename nor servname provided, or not known\n  \n", "name": "LogDebugStackTrace", "pid": 13823, "thread": "MainThread", "ts": "2023-08-08T13:07:13.396223Z"}}
{"data": {"command": "dbt run-operation", "completed_at": "2023-08-08T13:07:13.396958Z", "elapsed": 0.40285072, "success": false}, "info": {"category": "", "code": "Q039", "extra": {}, "invocation_id": "19e0c973-6e4a-4063-aaa6-02d00ef7612a", "level": "debug", "msg": "Command `dbt run-operation` failed at 16:07:13.396958 after 0.40 seconds", "name": "CommandCompleted", "pid": 13823, "thread": "MainThread", "ts": "2023-08-08T13:07:13.397014Z"}}
{"data": {"conn_name": "macro_log_macro_results"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "19e0c973-6e4a-4063-aaa6-02d00ef7612a", "level": "debug", "msg": "Connection 'macro_log_macro_results' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 13823, "thread": "MainThread", "ts": "2023-08-08T13:07:13.397277Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106221970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a50d9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a01fee0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "19e0c973-6e4a-4063-aaa6-02d00ef7612a", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106221970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a50d9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a01fee0>]}", "name": "SendingEvent", "pid": 13823, "thread": "MainThread", "ts": "2023-08-08T13:07:13.397530Z"}}
{"data": {}, "info": {"category": "", "code": "Z042", "extra": {}, "invocation_id": "19e0c973-6e4a-4063-aaa6-02d00ef7612a", "level": "debug", "msg": "Flushing usage events", "name": "FlushEvents", "pid": 13823, "thread": "MainThread", "ts": "2023-08-08T13:07:13.397785Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056b54f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081830d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108183be0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "4ea176a3-2fa4-4a2f-ac89-0e152817d021", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056b54f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081830d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108183be0>]}", "name": "SendingEvent", "pid": 13831, "thread": "MainThread", "ts": "2023-08-08T13:07:15.252565Z"}}
{"data": {"log_version": 3, "version": "=1.6.0"}, "info": {"category": "", "code": "A001", "extra": {}, "invocation_id": "4ea176a3-2fa4-4a2f-ac89-0e152817d021", "level": "info", "msg": "Running with dbt=1.6.0", "name": "MainReportVersion", "pid": 13831, "thread": "MainThread", "ts": "2023-08-08T13:07:15.254519Z"}}
{"data": {"args": {"cache_selected_only": "False", "debug": "False", "fail_fast": "False", "indirect_selection": "eager", "introspect": "True", "invocation_command": "dbt --log-format json run-operation elementary.log_macro_results --args {\"macro_name\": \"get_adapter_type_and_unique_id\", \"macro_args\": {}} --project-dir /Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/elementary/monitor/dbt_project", "log_cache_events": "False", "log_format": "json", "log_path": "/Users/ofek/workspace/test_dbt/edr_target", "no_print": "None", "partial_parse": "True", "printer_width": "80", "profiles_dir": "/Users/ofek/.dbt", "quiet": "False", "send_anonymous_usage_stats": "True", "static_parser": "True", "target_path": "None", "use_colors": "True", "use_experimental_parser": "False", "version_check": "True", "warn_error": "None", "warn_error_options": "WarnErrorOptions(include=[], exclude=[])", "write_json": "True"}}, "info": {"category": "", "code": "A002", "extra": {}, "invocation_id": "4ea176a3-2fa4-4a2f-ac89-0e152817d021", "level": "debug", "msg": "running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ofek/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/ofek/workspace/test_dbt/edr_target', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'json', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt --log-format json run-operation elementary.log_macro_results --args {\"macro_name\": \"get_adapter_type_and_unique_id\", \"macro_args\": {}} --project-dir /Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/elementary/monitor/dbt_project', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}", "name": "MainReportArgs", "pid": 13831, "thread": "MainThread", "ts": "2023-08-08T13:07:15.254894Z"}}
{"data": {"profile_name": "elementary", "target_name": "default"}, "info": {"category": "", "code": "A005", "extra": {}, "invocation_id": "4ea176a3-2fa4-4a2f-ac89-0e152817d021", "level": "info", "msg": "target not specified in profile 'elementary', using 'default'", "name": "MissingProfileTarget", "pid": 13831, "thread": "MainThread", "ts": "2023-08-08T13:07:15.270987Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'project_id', 'label': '4ea176a3-2fa4-4a2f-ac89-0e152817d021', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107808940>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "4ea176a3-2fa4-4a2f-ac89-0e152817d021", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4ea176a3-2fa4-4a2f-ac89-0e152817d021', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107808940>]}", "name": "SendingEvent", "pid": 13831, "thread": "MainThread", "ts": "2023-08-08T13:07:15.407707Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'adapter_info', 'label': '4ea176a3-2fa4-4a2f-ac89-0e152817d021', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094a6e80>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "4ea176a3-2fa4-4a2f-ac89-0e152817d021", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4ea176a3-2fa4-4a2f-ac89-0e152817d021', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094a6e80>]}", "name": "SendingEvent", "pid": 13831, "thread": "MainThread", "ts": "2023-08-08T13:07:15.413338Z"}}
{"data": {"adapter_name": "postgres", "adapter_version": "=1.6.0"}, "info": {"category": "", "code": "E034", "extra": {}, "invocation_id": "4ea176a3-2fa4-4a2f-ac89-0e152817d021", "level": "info", "msg": "Registered adapter: postgres=1.6.0", "name": "AdapterRegistered", "pid": 13831, "thread": "MainThread", "ts": "2023-08-08T13:07:15.413727Z"}}
{"data": {"checksum": "08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9", "profile": "", "target": "", "vars": "{}", "version": "1.6.0"}, "info": {"category": "", "code": "I025", "extra": {}, "invocation_id": "4ea176a3-2fa4-4a2f-ac89-0e152817d021", "level": "debug", "msg": "checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0", "name": "StateCheckVarsHash", "pid": 13831, "thread": "MainThread", "ts": "2023-08-08T13:07:15.426013Z"}}
{"data": {"added": 0, "changed": 0, "deleted": 0}, "info": {"category": "", "code": "I040", "extra": {}, "invocation_id": "4ea176a3-2fa4-4a2f-ac89-0e152817d021", "level": "debug", "msg": "Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.", "name": "PartialParsingEnabled", "pid": 13831, "thread": "MainThread", "ts": "2023-08-08T13:07:15.504542Z"}}
{"data": {}, "info": {"category": "", "code": "I017", "extra": {}, "invocation_id": "4ea176a3-2fa4-4a2f-ac89-0e152817d021", "level": "debug", "msg": "Partial parsing enabled, no changes found, skipping parsing", "name": "PartialParsingSkipParsing", "pid": 13831, "thread": "MainThread", "ts": "2023-08-08T13:07:15.504867Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'load_project', 'label': '4ea176a3-2fa4-4a2f-ac89-0e152817d021', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099ef0d0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "4ea176a3-2fa4-4a2f-ac89-0e152817d021", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4ea176a3-2fa4-4a2f-ac89-0e152817d021', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099ef0d0>]}", "name": "SendingEvent", "pid": 13831, "thread": "MainThread", "ts": "2023-08-08T13:07:15.510237Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'resource_counts', 'label': '4ea176a3-2fa4-4a2f-ac89-0e152817d021', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099977c0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "4ea176a3-2fa4-4a2f-ac89-0e152817d021", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4ea176a3-2fa4-4a2f-ac89-0e152817d021', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099977c0>]}", "name": "SendingEvent", "pid": 13831, "thread": "MainThread", "ts": "2023-08-08T13:07:15.526054Z"}}
{"data": {"stat_line": "34 models, 2 operations, 6 tests, 6 sources, 0 exposures, 0 metrics, 1101 macros, 0 groups, 0 semantic models"}, "info": {"category": "", "code": "W006", "extra": {}, "invocation_id": "4ea176a3-2fa4-4a2f-ac89-0e152817d021", "level": "info", "msg": "Found 34 models, 2 operations, 6 tests, 6 sources, 0 exposures, 0 metrics, 1101 macros, 0 groups, 0 semantic models", "name": "FoundStats", "pid": 13831, "thread": "MainThread", "ts": "2023-08-08T13:07:15.526389Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'runnable_timing', 'label': '4ea176a3-2fa4-4a2f-ac89-0e152817d021', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10946e400>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "4ea176a3-2fa4-4a2f-ac89-0e152817d021", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4ea176a3-2fa4-4a2f-ac89-0e152817d021', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10946e400>]}", "name": "SendingEvent", "pid": 13831, "thread": "MainThread", "ts": "2023-08-08T13:07:15.526642Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "4ea176a3-2fa4-4a2f-ac89-0e152817d021", "level": "debug", "msg": "Acquiring new postgres connection 'macro_log_macro_results'", "name": "NewConnection", "pid": 13831, "thread": "MainThread", "ts": "2023-08-08T13:07:15.527075Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "4ea176a3-2fa4-4a2f-ac89-0e152817d021", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 13831, "thread": "MainThread", "ts": "2023-08-08T13:07:15.527318Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "BEGIN"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "4ea176a3-2fa4-4a2f-ac89-0e152817d021", "level": "debug", "msg": "On macro_log_macro_results: BEGIN", "name": "SQLQuery", "pid": 13831, "thread": "MainThread", "ts": "2023-08-08T13:07:15.527565Z"}}
{"data": {"connection_state": "init"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "4ea176a3-2fa4-4a2f-ac89-0e152817d021", "level": "debug", "msg": "Opening a new connection, currently in state init", "name": "NewConnectionOpening", "pid": 13831, "thread": "MainThread", "ts": "2023-08-08T13:07:15.527788Z"}}
{"data": {"args": [], "base_msg": "Got a retryable error when attempting to open a postgres connection.\n1 attempts remaining. Retrying in 0 seconds.\nError:\ncould not translate host name \"db\" to address: nodename nor servname provided, or not known\n", "name": "Postgres"}, "info": {"category": "", "code": "E001", "extra": {}, "invocation_id": "4ea176a3-2fa4-4a2f-ac89-0e152817d021", "level": "debug", "msg": "Postgres adapter: Got a retryable error when attempting to open a postgres connection.\n1 attempts remaining. Retrying in 0 seconds.\nError:\ncould not translate host name \"db\" to address: nodename nor servname provided, or not known\n", "name": "AdapterEventDebug", "pid": 13831, "thread": "MainThread", "ts": "2023-08-08T13:07:15.530832Z"}}
{"data": {"args": ["BEGIN"], "base_msg": "Error running SQL: {}", "name": "Postgres"}, "info": {"category": "", "code": "E001", "extra": {}, "invocation_id": "4ea176a3-2fa4-4a2f-ac89-0e152817d021", "level": "debug", "msg": "Postgres adapter: Error running SQL: BEGIN", "name": "AdapterEventDebug", "pid": 13831, "thread": "MainThread", "ts": "2023-08-08T13:07:15.533186Z"}}
{"data": {"args": [], "base_msg": "Rolling back transaction.", "name": "Postgres"}, "info": {"category": "", "code": "E001", "extra": {}, "invocation_id": "4ea176a3-2fa4-4a2f-ac89-0e152817d021", "level": "debug", "msg": "Postgres adapter: Rolling back transaction.", "name": "AdapterEventDebug", "pid": 13831, "thread": "MainThread", "ts": "2023-08-08T13:07:15.533581Z"}}
{"data": {"conn_name": "macro_log_macro_results"}, "info": {"category": "", "code": "E011", "extra": {}, "invocation_id": "4ea176a3-2fa4-4a2f-ac89-0e152817d021", "level": "debug", "msg": "On macro_log_macro_results: No close available on handle", "name": "ConnectionLeftOpen", "pid": 13831, "thread": "MainThread", "ts": "2023-08-08T13:07:15.533844Z"}}
{"data": {"exc": "Database Error\n  could not translate host name \"db\" to address: nodename nor servname provided, or not known\n  "}, "info": {"category": "", "code": "Q001", "extra": {}, "invocation_id": "4ea176a3-2fa4-4a2f-ac89-0e152817d021", "level": "error", "msg": "Encountered an error while running operation: Database Error\n  could not translate host name \"db\" to address: nodename nor servname provided, or not known\n  ", "name": "RunningOperationCaughtError", "pid": 13831, "thread": "MainThread", "ts": "2023-08-08T13:07:15.534295Z"}}
{"data": {"exc_info": "Traceback (most recent call last):\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/base/connections.py\", line 241, in retry_connection\n    connection.handle = connect()\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/postgres/connections.py\", line 134, in connect\n    handle = psycopg2.connect(\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/psycopg2/__init__.py\", line 122, in connect\n    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)\npsycopg2.OperationalError: could not translate host name \"db\" to address: nodename nor servname provided, or not known\n\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/base/connections.py\", line 241, in retry_connection\n    connection.handle = connect()\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/postgres/connections.py\", line 134, in connect\n    handle = psycopg2.connect(\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/psycopg2/__init__.py\", line 122, in connect\n    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)\npsycopg2.OperationalError: could not translate host name \"db\" to address: nodename nor servname provided, or not known\n\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/task/run_operation.py\", line 58, in run\n    self._run_unsafe(package_name, macro_name)\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/task/run_operation.py\", line 42, in _run_unsafe\n    adapter.clear_transaction()\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/base/impl.py\", line 244, in clear_transaction\n    self.connections.clear_transaction()\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/base/connections.py\", line 122, in clear_transaction\n    self.begin()\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/sql/connections.py\", line 172, in begin\n    self.add_begin_query()\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/sql/connections.py\", line 155, in add_begin_query\n    return self.add_query(\"BEGIN\", auto_begin=False)\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/sql/connections.py\", line 79, in add_query\n    cursor = connection.handle.cursor()\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/contracts/connection.py\", line 94, in handle\n    self._handle.resolve(self)\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/contracts/connection.py\", line 118, in resolve\n    return self.opener(connection)\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/postgres/connections.py\", line 159, in open\n    return cls.retry_connection(\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/base/connections.py\", line 258, in retry_connection\n    return cls.retry_connection(\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/base/connections.py\", line 249, in retry_connection\n    raise dbt.exceptions.FailedToConnectError(str(e))\ndbt.exceptions.FailedToConnectError: Database Error\n  could not translate host name \"db\" to address: nodename nor servname provided, or not known\n  \n"}, "info": {"category": "", "code": "Z011", "extra": {}, "invocation_id": "4ea176a3-2fa4-4a2f-ac89-0e152817d021", "level": "debug", "msg": "Traceback (most recent call last):\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/base/connections.py\", line 241, in retry_connection\n    connection.handle = connect()\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/postgres/connections.py\", line 134, in connect\n    handle = psycopg2.connect(\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/psycopg2/__init__.py\", line 122, in connect\n    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)\npsycopg2.OperationalError: could not translate host name \"db\" to address: nodename nor servname provided, or not known\n\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/base/connections.py\", line 241, in retry_connection\n    connection.handle = connect()\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/postgres/connections.py\", line 134, in connect\n    handle = psycopg2.connect(\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/psycopg2/__init__.py\", line 122, in connect\n    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)\npsycopg2.OperationalError: could not translate host name \"db\" to address: nodename nor servname provided, or not known\n\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/task/run_operation.py\", line 58, in run\n    self._run_unsafe(package_name, macro_name)\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/task/run_operation.py\", line 42, in _run_unsafe\n    adapter.clear_transaction()\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/base/impl.py\", line 244, in clear_transaction\n    self.connections.clear_transaction()\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/base/connections.py\", line 122, in clear_transaction\n    self.begin()\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/sql/connections.py\", line 172, in begin\n    self.add_begin_query()\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/sql/connections.py\", line 155, in add_begin_query\n    return self.add_query(\"BEGIN\", auto_begin=False)\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/sql/connections.py\", line 79, in add_query\n    cursor = connection.handle.cursor()\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/contracts/connection.py\", line 94, in handle\n    self._handle.resolve(self)\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/contracts/connection.py\", line 118, in resolve\n    return self.opener(connection)\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/postgres/connections.py\", line 159, in open\n    return cls.retry_connection(\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/base/connections.py\", line 258, in retry_connection\n    return cls.retry_connection(\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/base/connections.py\", line 249, in retry_connection\n    raise dbt.exceptions.FailedToConnectError(str(e))\ndbt.exceptions.FailedToConnectError: Database Error\n  could not translate host name \"db\" to address: nodename nor servname provided, or not known\n  \n", "name": "LogDebugStackTrace", "pid": 13831, "thread": "MainThread", "ts": "2023-08-08T13:07:15.535180Z"}}
{"data": {"command": "dbt run-operation", "completed_at": "2023-08-08T13:07:15.536007Z", "elapsed": 0.29381162, "success": false}, "info": {"category": "", "code": "Q039", "extra": {}, "invocation_id": "4ea176a3-2fa4-4a2f-ac89-0e152817d021", "level": "debug", "msg": "Command `dbt run-operation` failed at 16:07:15.536007 after 0.29 seconds", "name": "CommandCompleted", "pid": 13831, "thread": "MainThread", "ts": "2023-08-08T13:07:15.536060Z"}}
{"data": {"conn_name": "macro_log_macro_results"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "4ea176a3-2fa4-4a2f-ac89-0e152817d021", "level": "debug", "msg": "Connection 'macro_log_macro_results' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 13831, "thread": "MainThread", "ts": "2023-08-08T13:07:15.536344Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056b54f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094a6e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094e7fd0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "4ea176a3-2fa4-4a2f-ac89-0e152817d021", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056b54f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094a6e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094e7fd0>]}", "name": "SendingEvent", "pid": 13831, "thread": "MainThread", "ts": "2023-08-08T13:07:15.536576Z"}}
{"data": {}, "info": {"category": "", "code": "Z042", "extra": {}, "invocation_id": "4ea176a3-2fa4-4a2f-ac89-0e152817d021", "level": "debug", "msg": "Flushing usage events", "name": "FlushEvents", "pid": 13831, "thread": "MainThread", "ts": "2023-08-08T13:07:15.536858Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d2d4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067c47c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067fd2b0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "43b468b8-dfaa-4f41-9b8f-7fdeba4c36f9", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d2d4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067c47c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067fd2b0>]}", "name": "SendingEvent", "pid": 13840, "thread": "MainThread", "ts": "2023-08-08T13:07:17.328883Z"}}
{"data": {"log_version": 3, "version": "=1.6.0"}, "info": {"category": "", "code": "A001", "extra": {}, "invocation_id": "43b468b8-dfaa-4f41-9b8f-7fdeba4c36f9", "level": "info", "msg": "Running with dbt=1.6.0", "name": "MainReportVersion", "pid": 13840, "thread": "MainThread", "ts": "2023-08-08T13:07:17.330871Z"}}
{"data": {"args": {"cache_selected_only": "False", "debug": "False", "fail_fast": "False", "indirect_selection": "eager", "introspect": "True", "invocation_command": "dbt --log-format json run-operation elementary.log_macro_results --args {\"macro_name\": \"get_elementary_database_and_schema\", \"macro_args\": {}} --project-dir /Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/elementary/monitor/dbt_project", "log_cache_events": "False", "log_format": "json", "log_path": "/Users/ofek/workspace/test_dbt/edr_target", "no_print": "None", "partial_parse": "True", "printer_width": "80", "profiles_dir": "/Users/ofek/.dbt", "quiet": "False", "send_anonymous_usage_stats": "True", "static_parser": "True", "target_path": "None", "use_colors": "True", "use_experimental_parser": "False", "version_check": "True", "warn_error": "None", "warn_error_options": "WarnErrorOptions(include=[], exclude=[])", "write_json": "True"}}, "info": {"category": "", "code": "A002", "extra": {}, "invocation_id": "43b468b8-dfaa-4f41-9b8f-7fdeba4c36f9", "level": "debug", "msg": "running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ofek/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/ofek/workspace/test_dbt/edr_target', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'json', 'invocation_command': 'dbt --log-format json run-operation elementary.log_macro_results --args {\"macro_name\": \"get_elementary_database_and_schema\", \"macro_args\": {}} --project-dir /Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/elementary/monitor/dbt_project', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}", "name": "MainReportArgs", "pid": 13840, "thread": "MainThread", "ts": "2023-08-08T13:07:17.331241Z"}}
{"data": {"profile_name": "elementary", "target_name": "default"}, "info": {"category": "", "code": "A005", "extra": {}, "invocation_id": "43b468b8-dfaa-4f41-9b8f-7fdeba4c36f9", "level": "info", "msg": "target not specified in profile 'elementary', using 'default'", "name": "MissingProfileTarget", "pid": 13840, "thread": "MainThread", "ts": "2023-08-08T13:07:17.348412Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'project_id', 'label': '43b468b8-dfaa-4f41-9b8f-7fdeba4c36f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068671f0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "43b468b8-dfaa-4f41-9b8f-7fdeba4c36f9", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '43b468b8-dfaa-4f41-9b8f-7fdeba4c36f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068671f0>]}", "name": "SendingEvent", "pid": 13840, "thread": "MainThread", "ts": "2023-08-08T13:07:17.484880Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'adapter_info', 'label': '43b468b8-dfaa-4f41-9b8f-7fdeba4c36f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b20eb0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "43b468b8-dfaa-4f41-9b8f-7fdeba4c36f9", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '43b468b8-dfaa-4f41-9b8f-7fdeba4c36f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b20eb0>]}", "name": "SendingEvent", "pid": 13840, "thread": "MainThread", "ts": "2023-08-08T13:07:17.490360Z"}}
{"data": {"adapter_name": "postgres", "adapter_version": "=1.6.0"}, "info": {"category": "", "code": "E034", "extra": {}, "invocation_id": "43b468b8-dfaa-4f41-9b8f-7fdeba4c36f9", "level": "info", "msg": "Registered adapter: postgres=1.6.0", "name": "AdapterRegistered", "pid": 13840, "thread": "MainThread", "ts": "2023-08-08T13:07:17.490726Z"}}
{"data": {"checksum": "08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9", "profile": "", "target": "", "vars": "{}", "version": "1.6.0"}, "info": {"category": "", "code": "I025", "extra": {}, "invocation_id": "43b468b8-dfaa-4f41-9b8f-7fdeba4c36f9", "level": "debug", "msg": "checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0", "name": "StateCheckVarsHash", "pid": 13840, "thread": "MainThread", "ts": "2023-08-08T13:07:17.502947Z"}}
{"data": {"added": 0, "changed": 0, "deleted": 0}, "info": {"category": "", "code": "I040", "extra": {}, "invocation_id": "43b468b8-dfaa-4f41-9b8f-7fdeba4c36f9", "level": "debug", "msg": "Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.", "name": "PartialParsingEnabled", "pid": 13840, "thread": "MainThread", "ts": "2023-08-08T13:07:17.581260Z"}}
{"data": {}, "info": {"category": "", "code": "I017", "extra": {}, "invocation_id": "43b468b8-dfaa-4f41-9b8f-7fdeba4c36f9", "level": "debug", "msg": "Partial parsing enabled, no changes found, skipping parsing", "name": "PartialParsingSkipParsing", "pid": 13840, "thread": "MainThread", "ts": "2023-08-08T13:07:17.581554Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'load_project', 'label': '43b468b8-dfaa-4f41-9b8f-7fdeba4c36f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080670d0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "43b468b8-dfaa-4f41-9b8f-7fdeba4c36f9", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '43b468b8-dfaa-4f41-9b8f-7fdeba4c36f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080670d0>]}", "name": "SendingEvent", "pid": 13840, "thread": "MainThread", "ts": "2023-08-08T13:07:17.586837Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'resource_counts', 'label': '43b468b8-dfaa-4f41-9b8f-7fdeba4c36f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107daa790>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "43b468b8-dfaa-4f41-9b8f-7fdeba4c36f9", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '43b468b8-dfaa-4f41-9b8f-7fdeba4c36f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107daa790>]}", "name": "SendingEvent", "pid": 13840, "thread": "MainThread", "ts": "2023-08-08T13:07:17.602498Z"}}
{"data": {"stat_line": "34 models, 2 operations, 6 tests, 6 sources, 0 exposures, 0 metrics, 1101 macros, 0 groups, 0 semantic models"}, "info": {"category": "", "code": "W006", "extra": {}, "invocation_id": "43b468b8-dfaa-4f41-9b8f-7fdeba4c36f9", "level": "info", "msg": "Found 34 models, 2 operations, 6 tests, 6 sources, 0 exposures, 0 metrics, 1101 macros, 0 groups, 0 semantic models", "name": "FoundStats", "pid": 13840, "thread": "MainThread", "ts": "2023-08-08T13:07:17.602788Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'runnable_timing', 'label': '43b468b8-dfaa-4f41-9b8f-7fdeba4c36f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107daab80>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "43b468b8-dfaa-4f41-9b8f-7fdeba4c36f9", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '43b468b8-dfaa-4f41-9b8f-7fdeba4c36f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107daab80>]}", "name": "SendingEvent", "pid": 13840, "thread": "MainThread", "ts": "2023-08-08T13:07:17.603028Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "43b468b8-dfaa-4f41-9b8f-7fdeba4c36f9", "level": "debug", "msg": "Acquiring new postgres connection 'macro_log_macro_results'", "name": "NewConnection", "pid": 13840, "thread": "MainThread", "ts": "2023-08-08T13:07:17.603445Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "43b468b8-dfaa-4f41-9b8f-7fdeba4c36f9", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 13840, "thread": "MainThread", "ts": "2023-08-08T13:07:17.603689Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "BEGIN"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "43b468b8-dfaa-4f41-9b8f-7fdeba4c36f9", "level": "debug", "msg": "On macro_log_macro_results: BEGIN", "name": "SQLQuery", "pid": 13840, "thread": "MainThread", "ts": "2023-08-08T13:07:17.603911Z"}}
{"data": {"connection_state": "init"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "43b468b8-dfaa-4f41-9b8f-7fdeba4c36f9", "level": "debug", "msg": "Opening a new connection, currently in state init", "name": "NewConnectionOpening", "pid": 13840, "thread": "MainThread", "ts": "2023-08-08T13:07:17.604124Z"}}
{"data": {"args": [], "base_msg": "Got a retryable error when attempting to open a postgres connection.\n1 attempts remaining. Retrying in 0 seconds.\nError:\ncould not translate host name \"db\" to address: nodename nor servname provided, or not known\n", "name": "Postgres"}, "info": {"category": "", "code": "E001", "extra": {}, "invocation_id": "43b468b8-dfaa-4f41-9b8f-7fdeba4c36f9", "level": "debug", "msg": "Postgres adapter: Got a retryable error when attempting to open a postgres connection.\n1 attempts remaining. Retrying in 0 seconds.\nError:\ncould not translate host name \"db\" to address: nodename nor servname provided, or not known\n", "name": "AdapterEventDebug", "pid": 13840, "thread": "MainThread", "ts": "2023-08-08T13:07:17.607097Z"}}
{"data": {"args": ["BEGIN"], "base_msg": "Error running SQL: {}", "name": "Postgres"}, "info": {"category": "", "code": "E001", "extra": {}, "invocation_id": "43b468b8-dfaa-4f41-9b8f-7fdeba4c36f9", "level": "debug", "msg": "Postgres adapter: Error running SQL: BEGIN", "name": "AdapterEventDebug", "pid": 13840, "thread": "MainThread", "ts": "2023-08-08T13:07:17.609322Z"}}
{"data": {"args": [], "base_msg": "Rolling back transaction.", "name": "Postgres"}, "info": {"category": "", "code": "E001", "extra": {}, "invocation_id": "43b468b8-dfaa-4f41-9b8f-7fdeba4c36f9", "level": "debug", "msg": "Postgres adapter: Rolling back transaction.", "name": "AdapterEventDebug", "pid": 13840, "thread": "MainThread", "ts": "2023-08-08T13:07:17.609585Z"}}
{"data": {"conn_name": "macro_log_macro_results"}, "info": {"category": "", "code": "E011", "extra": {}, "invocation_id": "43b468b8-dfaa-4f41-9b8f-7fdeba4c36f9", "level": "debug", "msg": "On macro_log_macro_results: No close available on handle", "name": "ConnectionLeftOpen", "pid": 13840, "thread": "MainThread", "ts": "2023-08-08T13:07:17.609813Z"}}
{"data": {"exc": "Database Error\n  could not translate host name \"db\" to address: nodename nor servname provided, or not known\n  "}, "info": {"category": "", "code": "Q001", "extra": {}, "invocation_id": "43b468b8-dfaa-4f41-9b8f-7fdeba4c36f9", "level": "error", "msg": "Encountered an error while running operation: Database Error\n  could not translate host name \"db\" to address: nodename nor servname provided, or not known\n  ", "name": "RunningOperationCaughtError", "pid": 13840, "thread": "MainThread", "ts": "2023-08-08T13:07:17.610196Z"}}
{"data": {"exc_info": "Traceback (most recent call last):\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/base/connections.py\", line 241, in retry_connection\n    connection.handle = connect()\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/postgres/connections.py\", line 134, in connect\n    handle = psycopg2.connect(\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/psycopg2/__init__.py\", line 122, in connect\n    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)\npsycopg2.OperationalError: could not translate host name \"db\" to address: nodename nor servname provided, or not known\n\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/base/connections.py\", line 241, in retry_connection\n    connection.handle = connect()\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/postgres/connections.py\", line 134, in connect\n    handle = psycopg2.connect(\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/psycopg2/__init__.py\", line 122, in connect\n    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)\npsycopg2.OperationalError: could not translate host name \"db\" to address: nodename nor servname provided, or not known\n\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/task/run_operation.py\", line 58, in run\n    self._run_unsafe(package_name, macro_name)\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/task/run_operation.py\", line 42, in _run_unsafe\n    adapter.clear_transaction()\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/base/impl.py\", line 244, in clear_transaction\n    self.connections.clear_transaction()\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/base/connections.py\", line 122, in clear_transaction\n    self.begin()\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/sql/connections.py\", line 172, in begin\n    self.add_begin_query()\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/sql/connections.py\", line 155, in add_begin_query\n    return self.add_query(\"BEGIN\", auto_begin=False)\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/sql/connections.py\", line 79, in add_query\n    cursor = connection.handle.cursor()\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/contracts/connection.py\", line 94, in handle\n    self._handle.resolve(self)\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/contracts/connection.py\", line 118, in resolve\n    return self.opener(connection)\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/postgres/connections.py\", line 159, in open\n    return cls.retry_connection(\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/base/connections.py\", line 258, in retry_connection\n    return cls.retry_connection(\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/base/connections.py\", line 249, in retry_connection\n    raise dbt.exceptions.FailedToConnectError(str(e))\ndbt.exceptions.FailedToConnectError: Database Error\n  could not translate host name \"db\" to address: nodename nor servname provided, or not known\n  \n"}, "info": {"category": "", "code": "Z011", "extra": {}, "invocation_id": "43b468b8-dfaa-4f41-9b8f-7fdeba4c36f9", "level": "debug", "msg": "Traceback (most recent call last):\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/base/connections.py\", line 241, in retry_connection\n    connection.handle = connect()\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/postgres/connections.py\", line 134, in connect\n    handle = psycopg2.connect(\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/psycopg2/__init__.py\", line 122, in connect\n    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)\npsycopg2.OperationalError: could not translate host name \"db\" to address: nodename nor servname provided, or not known\n\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/base/connections.py\", line 241, in retry_connection\n    connection.handle = connect()\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/postgres/connections.py\", line 134, in connect\n    handle = psycopg2.connect(\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/psycopg2/__init__.py\", line 122, in connect\n    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)\npsycopg2.OperationalError: could not translate host name \"db\" to address: nodename nor servname provided, or not known\n\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/task/run_operation.py\", line 58, in run\n    self._run_unsafe(package_name, macro_name)\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/task/run_operation.py\", line 42, in _run_unsafe\n    adapter.clear_transaction()\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/base/impl.py\", line 244, in clear_transaction\n    self.connections.clear_transaction()\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/base/connections.py\", line 122, in clear_transaction\n    self.begin()\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/sql/connections.py\", line 172, in begin\n    self.add_begin_query()\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/sql/connections.py\", line 155, in add_begin_query\n    return self.add_query(\"BEGIN\", auto_begin=False)\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/sql/connections.py\", line 79, in add_query\n    cursor = connection.handle.cursor()\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/contracts/connection.py\", line 94, in handle\n    self._handle.resolve(self)\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/contracts/connection.py\", line 118, in resolve\n    return self.opener(connection)\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/postgres/connections.py\", line 159, in open\n    return cls.retry_connection(\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/base/connections.py\", line 258, in retry_connection\n    return cls.retry_connection(\n  File \"/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/base/connections.py\", line 249, in retry_connection\n    raise dbt.exceptions.FailedToConnectError(str(e))\ndbt.exceptions.FailedToConnectError: Database Error\n  could not translate host name \"db\" to address: nodename nor servname provided, or not known\n  \n", "name": "LogDebugStackTrace", "pid": 13840, "thread": "MainThread", "ts": "2023-08-08T13:07:17.611057Z"}}
{"data": {"command": "dbt run-operation", "completed_at": "2023-08-08T13:07:17.611749Z", "elapsed": 0.29382214, "success": false}, "info": {"category": "", "code": "Q039", "extra": {}, "invocation_id": "43b468b8-dfaa-4f41-9b8f-7fdeba4c36f9", "level": "debug", "msg": "Command `dbt run-operation` failed at 16:07:17.611749 after 0.29 seconds", "name": "CommandCompleted", "pid": 13840, "thread": "MainThread", "ts": "2023-08-08T13:07:17.611808Z"}}
{"data": {"conn_name": "macro_log_macro_results"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "43b468b8-dfaa-4f41-9b8f-7fdeba4c36f9", "level": "debug", "msg": "Connection 'macro_log_macro_results' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 13840, "thread": "MainThread", "ts": "2023-08-08T13:07:17.612078Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d2d4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108003fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b20eb0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "43b468b8-dfaa-4f41-9b8f-7fdeba4c36f9", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d2d4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108003fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b20eb0>]}", "name": "SendingEvent", "pid": 13840, "thread": "MainThread", "ts": "2023-08-08T13:07:17.612311Z"}}
{"data": {}, "info": {"category": "", "code": "Z042", "extra": {}, "invocation_id": "43b468b8-dfaa-4f41-9b8f-7fdeba4c36f9", "level": "debug", "msg": "Flushing usage events", "name": "FlushEvents", "pid": 13840, "thread": "MainThread", "ts": "2023-08-08T13:07:17.612554Z"}}
[0m16:07:19.384216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1022709a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d3e580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d3ec10>]}


============================== 16:07:19.386039 | e55dd89d-23c7-4a74-a376-9562bc6e5055 ==============================
[0m16:07:19.386039 [info ] [MainThread]: Running with dbt=1.6.0
[0m16:07:19.386363 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/ofek/workspace/test_dbt/edr_target', 'profiles_dir': '/Users/ofek/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run -m alerts --project-dir /Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/elementary/monitor/dbt_project', 'send_anonymous_usage_stats': 'True'}
[0m16:07:19.403868 [info ] [MainThread]: target not specified in profile 'elementary', using 'default'
[0m16:07:19.546897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e55dd89d-23c7-4a74-a376-9562bc6e5055', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104dd03a0>]}
[0m16:07:19.552614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e55dd89d-23c7-4a74-a376-9562bc6e5055', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062b4f10>]}
[0m16:07:19.552947 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m16:07:19.566194 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m16:07:19.647712 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:07:19.647980 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:07:19.653433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e55dd89d-23c7-4a74-a376-9562bc6e5055', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069000d0>]}
[0m16:07:19.669454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e55dd89d-23c7-4a74-a376-9562bc6e5055', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068a9a30>]}
[0m16:07:19.669701 [info ] [MainThread]: Found 34 models, 2 operations, 6 tests, 6 sources, 0 exposures, 0 metrics, 1101 macros, 0 groups, 0 semantic models
[0m16:07:19.669917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e55dd89d-23c7-4a74-a376-9562bc6e5055', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062b4e50>]}
[0m16:07:19.670796 [info ] [MainThread]: 
[0m16:07:19.671294 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:07:19.671950 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m16:07:19.678265 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m16:07:19.678470 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "elementary", "target_name": "default", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m16:07:19.678631 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:07:19.681596 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
could not translate host name "db" to address: nodename nor servname provided, or not known

[0m16:07:19.683829 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "elementary", "target_name": "default", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m16:07:19.684044 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m16:07:19.684235 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m16:07:19.684405 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m16:07:19.684566 [debug] [ThreadPool]: On list_dbt: No close available on handle
[0m16:07:19.685166 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:07:19.685334 [debug] [MainThread]: Connection 'list_dbt' was properly closed.
[0m16:07:19.685502 [info ] [MainThread]: 
[0m16:07:19.685718 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.01 seconds (0.01s).
[0m16:07:19.686109 [error] [MainThread]: Encountered an error:
Database Error
  could not translate host name "db" to address: nodename nor servname provided, or not known
  
[0m16:07:19.686531 [debug] [MainThread]: Command `dbt run` failed at 16:07:19.686477 after 0.31 seconds
[0m16:07:19.686738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1022709a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068a9be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106315df0>]}
[0m16:07:19.686941 [debug] [MainThread]: Flushing usage events
{"data": {"kwargs": "{'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040fdd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074e1730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107519220>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "e4dc1db1-2880-443f-b3f7-28017be6ede8", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040fdd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074e1730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107519220>]}", "name": "SendingEvent", "pid": 14076, "thread": "MainThread", "ts": "2023-08-08T13:08:41.116389Z"}}
{"data": {"log_version": 3, "version": "=1.6.0"}, "info": {"category": "", "code": "A001", "extra": {}, "invocation_id": "e4dc1db1-2880-443f-b3f7-28017be6ede8", "level": "info", "msg": "Running with dbt=1.6.0", "name": "MainReportVersion", "pid": 14076, "thread": "MainThread", "ts": "2023-08-08T13:08:41.118978Z"}}
{"data": {"args": {"cache_selected_only": "False", "debug": "False", "fail_fast": "False", "indirect_selection": "eager", "introspect": "True", "invocation_command": "dbt --log-format json run-operation elementary.log_macro_results --args {\"macro_name\": \"get_latest_invocation\", \"macro_args\": {}} --project-dir /Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/elementary/monitor/dbt_project", "log_cache_events": "False", "log_format": "json", "log_path": "/Users/ofek/workspace/test_dbt/edr_target", "no_print": "None", "partial_parse": "True", "printer_width": "80", "profiles_dir": "/Users/ofek/.dbt", "quiet": "False", "send_anonymous_usage_stats": "True", "static_parser": "True", "target_path": "None", "use_colors": "True", "use_experimental_parser": "False", "version_check": "True", "warn_error": "None", "warn_error_options": "WarnErrorOptions(include=[], exclude=[])", "write_json": "True"}}, "info": {"category": "", "code": "A002", "extra": {}, "invocation_id": "e4dc1db1-2880-443f-b3f7-28017be6ede8", "level": "debug", "msg": "running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/ofek/workspace/test_dbt/edr_target', 'profiles_dir': '/Users/ofek/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'json', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt --log-format json run-operation elementary.log_macro_results --args {\"macro_name\": \"get_latest_invocation\", \"macro_args\": {}} --project-dir /Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/elementary/monitor/dbt_project', 'send_anonymous_usage_stats': 'True'}", "name": "MainReportArgs", "pid": 14076, "thread": "MainThread", "ts": "2023-08-08T13:08:41.119350Z"}}
{"data": {"profile_name": "elementary", "target_name": "default"}, "info": {"category": "", "code": "A005", "extra": {}, "invocation_id": "e4dc1db1-2880-443f-b3f7-28017be6ede8", "level": "info", "msg": "target not specified in profile 'elementary', using 'default'", "name": "MissingProfileTarget", "pid": 14076, "thread": "MainThread", "ts": "2023-08-08T13:08:41.136127Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'project_id', 'label': 'e4dc1db1-2880-443f-b3f7-28017be6ede8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107519220>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "e4dc1db1-2880-443f-b3f7-28017be6ede8", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e4dc1db1-2880-443f-b3f7-28017be6ede8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107519220>]}", "name": "SendingEvent", "pid": 14076, "thread": "MainThread", "ts": "2023-08-08T13:08:41.310163Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'adapter_info', 'label': 'e4dc1db1-2880-443f-b3f7-28017be6ede8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b75e20>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "e4dc1db1-2880-443f-b3f7-28017be6ede8", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e4dc1db1-2880-443f-b3f7-28017be6ede8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b75e20>]}", "name": "SendingEvent", "pid": 14076, "thread": "MainThread", "ts": "2023-08-08T13:08:41.315794Z"}}
{"data": {"adapter_name": "postgres", "adapter_version": "=1.6.0"}, "info": {"category": "", "code": "E034", "extra": {}, "invocation_id": "e4dc1db1-2880-443f-b3f7-28017be6ede8", "level": "info", "msg": "Registered adapter: postgres=1.6.0", "name": "AdapterRegistered", "pid": 14076, "thread": "MainThread", "ts": "2023-08-08T13:08:41.316356Z"}}
{"data": {"checksum": "08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9", "profile": "", "target": "", "vars": "{}", "version": "1.6.0"}, "info": {"category": "", "code": "I025", "extra": {}, "invocation_id": "e4dc1db1-2880-443f-b3f7-28017be6ede8", "level": "debug", "msg": "checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0", "name": "StateCheckVarsHash", "pid": 14076, "thread": "MainThread", "ts": "2023-08-08T13:08:41.330359Z"}}
{"data": {"reason": "profile has changed"}, "info": {"category": "", "code": "I024", "extra": {}, "invocation_id": "e4dc1db1-2880-443f-b3f7-28017be6ede8", "level": "info", "msg": "Unable to do partial parsing because profile has changed", "name": "UnableToPartialParse", "pid": 14076, "thread": "MainThread", "ts": "2023-08-08T13:08:41.366373Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'partial_parser', 'label': 'e4dc1db1-2880-443f-b3f7-28017be6ede8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b59ee0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "e4dc1db1-2880-443f-b3f7-28017be6ede8", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e4dc1db1-2880-443f-b3f7-28017be6ede8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b59ee0>]}", "name": "SendingEvent", "pid": 14076, "thread": "MainThread", "ts": "2023-08-08T13:08:41.366747Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'load_project', 'label': 'e4dc1db1-2880-443f-b3f7-28017be6ede8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c919520>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "e4dc1db1-2880-443f-b3f7-28017be6ede8", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e4dc1db1-2880-443f-b3f7-28017be6ede8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c919520>]}", "name": "SendingEvent", "pid": 14076, "thread": "MainThread", "ts": "2023-08-08T13:08:43.310766Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'resource_counts', 'label': 'e4dc1db1-2880-443f-b3f7-28017be6ede8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bca3a0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "e4dc1db1-2880-443f-b3f7-28017be6ede8", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e4dc1db1-2880-443f-b3f7-28017be6ede8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bca3a0>]}", "name": "SendingEvent", "pid": 14076, "thread": "MainThread", "ts": "2023-08-08T13:08:43.327306Z"}}
{"data": {"stat_line": "34 models, 2 operations, 6 tests, 6 sources, 0 exposures, 0 metrics, 1101 macros, 0 groups, 0 semantic models"}, "info": {"category": "", "code": "W006", "extra": {}, "invocation_id": "e4dc1db1-2880-443f-b3f7-28017be6ede8", "level": "info", "msg": "Found 34 models, 2 operations, 6 tests, 6 sources, 0 exposures, 0 metrics, 1101 macros, 0 groups, 0 semantic models", "name": "FoundStats", "pid": 14076, "thread": "MainThread", "ts": "2023-08-08T13:08:43.327630Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'runnable_timing', 'label': 'e4dc1db1-2880-443f-b3f7-28017be6ede8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c46c10>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "e4dc1db1-2880-443f-b3f7-28017be6ede8", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e4dc1db1-2880-443f-b3f7-28017be6ede8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c46c10>]}", "name": "SendingEvent", "pid": 14076, "thread": "MainThread", "ts": "2023-08-08T13:08:43.327888Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "e4dc1db1-2880-443f-b3f7-28017be6ede8", "level": "debug", "msg": "Acquiring new postgres connection 'macro_log_macro_results'", "name": "NewConnection", "pid": 14076, "thread": "MainThread", "ts": "2023-08-08T13:08:43.328336Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "e4dc1db1-2880-443f-b3f7-28017be6ede8", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 14076, "thread": "MainThread", "ts": "2023-08-08T13:08:43.328590Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "BEGIN"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "e4dc1db1-2880-443f-b3f7-28017be6ede8", "level": "debug", "msg": "On macro_log_macro_results: BEGIN", "name": "SQLQuery", "pid": 14076, "thread": "MainThread", "ts": "2023-08-08T13:08:43.328814Z"}}
{"data": {"connection_state": "init"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "e4dc1db1-2880-443f-b3f7-28017be6ede8", "level": "debug", "msg": "Opening a new connection, currently in state init", "name": "NewConnectionOpening", "pid": 14076, "thread": "MainThread", "ts": "2023-08-08T13:08:43.329036Z"}}
{"data": {"elapsed": 0.0, "status": "BEGIN"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "e4dc1db1-2880-443f-b3f7-28017be6ede8", "level": "debug", "msg": "SQL status: BEGIN in 0.0 seconds", "name": "SQLQueryStatus", "pid": 14076, "thread": "MainThread", "ts": "2023-08-08T13:08:43.368186Z"}}
{"data": {"conn_name": "macro_log_macro_results"}, "info": {"category": "", "code": "E018", "extra": {}, "invocation_id": "e4dc1db1-2880-443f-b3f7-28017be6ede8", "level": "debug", "msg": "On macro_log_macro_results: COMMIT", "name": "SQLCommit", "pid": 14076, "thread": "MainThread", "ts": "2023-08-08T13:08:43.368523Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "e4dc1db1-2880-443f-b3f7-28017be6ede8", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 14076, "thread": "MainThread", "ts": "2023-08-08T13:08:43.368785Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "COMMIT"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "e4dc1db1-2880-443f-b3f7-28017be6ede8", "level": "debug", "msg": "On macro_log_macro_results: COMMIT", "name": "SQLQuery", "pid": 14076, "thread": "MainThread", "ts": "2023-08-08T13:08:43.369041Z"}}
{"data": {"elapsed": 0.0, "status": "COMMIT"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "e4dc1db1-2880-443f-b3f7-28017be6ede8", "level": "debug", "msg": "SQL status: COMMIT in 0.0 seconds", "name": "SQLQueryStatus", "pid": 14076, "thread": "MainThread", "ts": "2023-08-08T13:08:43.369842Z"}}
{"data": {"conn_name": "macro_log_macro_results", "database": "dbt", "schema": "local_analytics_elementary"}, "info": {"category": "", "code": "E013", "extra": {}, "invocation_id": "e4dc1db1-2880-443f-b3f7-28017be6ede8", "level": "debug", "msg": "On \"macro_log_macro_results\": cache miss for schema \"dbt.local_analytics_elementary\", this is inefficient", "name": "CacheMiss", "pid": 14076, "thread": "MainThread", "ts": "2023-08-08T13:08:43.378721Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "e4dc1db1-2880-443f-b3f7-28017be6ede8", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 14076, "thread": "MainThread", "ts": "2023-08-08T13:08:43.385531Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "BEGIN"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "e4dc1db1-2880-443f-b3f7-28017be6ede8", "level": "debug", "msg": "On macro_log_macro_results: BEGIN", "name": "SQLQuery", "pid": 14076, "thread": "MainThread", "ts": "2023-08-08T13:08:43.385808Z"}}
{"data": {"elapsed": 0.0, "status": "BEGIN"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "e4dc1db1-2880-443f-b3f7-28017be6ede8", "level": "debug", "msg": "SQL status: BEGIN in 0.0 seconds", "name": "SQLQueryStatus", "pid": 14076, "thread": "MainThread", "ts": "2023-08-08T13:08:43.387852Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "e4dc1db1-2880-443f-b3f7-28017be6ede8", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 14076, "thread": "MainThread", "ts": "2023-08-08T13:08:43.388111Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.6.0\", \"profile_name\": \"elementary\", \"target_name\": \"default\", \"connection_name\": \"macro_log_macro_results\"} */\nselect\n      'dbt' as database,\n      tablename as name,\n      schemaname as schema,\n      'table' as type\n    from pg_tables\n    where schemaname ilike 'local_analytics_elementary'\n    union all\n    select\n      'dbt' as database,\n      viewname as name,\n      schemaname as schema,\n      'view' as type\n    from pg_views\n    where schemaname ilike 'local_analytics_elementary'\n    union all\n    select\n      'dbt' as database,\n      matviewname as name,\n      schemaname as schema,\n      'materialized_view' as type\n    from pg_matviews\n    where schemaname ilike 'local_analytics_elementary'\n  "}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "e4dc1db1-2880-443f-b3f7-28017be6ede8", "level": "debug", "msg": "On macro_log_macro_results: /* {\"app\": \"dbt\", \"dbt_version\": \"1.6.0\", \"profile_name\": \"elementary\", \"target_name\": \"default\", \"connection_name\": \"macro_log_macro_results\"} */\nselect\n      'dbt' as database,\n      tablename as name,\n      schemaname as schema,\n      'table' as type\n    from pg_tables\n    where schemaname ilike 'local_analytics_elementary'\n    union all\n    select\n      'dbt' as database,\n      viewname as name,\n      schemaname as schema,\n      'view' as type\n    from pg_views\n    where schemaname ilike 'local_analytics_elementary'\n    union all\n    select\n      'dbt' as database,\n      matviewname as name,\n      schemaname as schema,\n      'materialized_view' as type\n    from pg_matviews\n    where schemaname ilike 'local_analytics_elementary'\n  ", "name": "SQLQuery", "pid": 14076, "thread": "MainThread", "ts": "2023-08-08T13:08:43.388384Z"}}
{"data": {"elapsed": 0.0, "status": "SELECT 29"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "e4dc1db1-2880-443f-b3f7-28017be6ede8", "level": "debug", "msg": "SQL status: SELECT 29 in 0.0 seconds", "name": "SQLQueryStatus", "pid": 14076, "thread": "MainThread", "ts": "2023-08-08T13:08:43.401655Z"}}
{"data": {"database": "dbt", "relations": [{"database": "dbt", "identifier": "data_monitoring_metrics", "schema": "local_analytics_elementary"}, {"database": "dbt", "identifier": "dbt_models", "schema": "local_analytics_elementary"}, {"database": "dbt", "identifier": "dbt_source_freshness_results", "schema": "local_analytics_elementary"}, {"database": "dbt", "identifier": "elementary_test_results", "schema": "local_analytics_elementary"}, {"database": "dbt", "identifier": "dbt_exposures", "schema": "local_analytics_elementary"}, {"database": "dbt", "identifier": "dbt_run_results", "schema": "local_analytics_elementary"}, {"database": "dbt", "identifier": "dbt_sources", "schema": "local_analytics_elementary"}, {"database": "dbt", "identifier": "dbt_seeds", "schema": "local_analytics_elementary"}, {"database": "dbt", "identifier": "dbt_invocations", "schema": "local_analytics_elementary"}, {"database": "dbt", "identifier": "schema_columns_snapshot", "schema": "local_analytics_elementary"}, {"database": "dbt", "identifier": "dbt_metrics", "schema": "local_analytics_elementary"}, {"database": "dbt", "identifier": "dbt_snapshots", "schema": "local_analytics_elementary"}, {"database": "dbt", "identifier": "dbt_tests", "schema": "local_analytics_elementary"}, {"database": "dbt", "identifier": "test_result_rows", "schema": "local_analytics_elementary"}, {"database": "dbt", "identifier": "metadata", "schema": "local_analytics_elementary"}, {"database": "dbt", "identifier": "job_run_results", "schema": "local_analytics_elementary"}, {"database": "dbt", "identifier": "alerts_schema_changes", "schema": "local_analytics_elementary"}, {"database": "dbt", "identifier": "model_run_results", "schema": "local_analytics_elementary"}, {"database": "dbt", "identifier": "snapshot_run_results", "schema": "local_analytics_elementary"}, {"database": "dbt", "identifier": "anomaly_threshold_sensitivity", "schema": "local_analytics_elementary"}, {"database": "dbt", "identifier": "filtered_information_schema_columns", "schema": "local_analytics_elementary"}, {"database": "dbt", "identifier": "alerts_dbt_source_freshness", "schema": "local_analytics_elementary"}, {"database": "dbt", "identifier": "alerts_dbt_models", "schema": "local_analytics_elementary"}, {"database": "dbt", "identifier": "dbt_columns", "schema": "local_analytics_elementary"}, {"database": "dbt", "identifier": "dbt_artifacts_hashes", "schema": "local_analytics_elementary"}, {"database": "dbt", "identifier": "metrics_anomaly_score", "schema": "local_analytics_elementary"}, {"database": "dbt", "identifier": "alerts_anomaly_detection", "schema": "local_analytics_elementary"}, {"database": "dbt", "identifier": "monitors_runs", "schema": "local_analytics_elementary"}, {"database": "dbt", "identifier": "alerts_dbt_tests", "schema": "local_analytics_elementary"}], "schema": "local_analytics_elementary"}, "info": {"category": "", "code": "E014", "extra": {}, "invocation_id": "e4dc1db1-2880-443f-b3f7-28017be6ede8", "level": "debug", "msg": "While listing relations in database=dbt, schema=local_analytics_elementary, found: data_monitoring_metrics, dbt_models, dbt_source_freshness_results, elementary_test_results, dbt_exposures, dbt_run_results, dbt_sources, dbt_seeds, dbt_invocations, schema_columns_snapshot, dbt_metrics, dbt_snapshots, dbt_tests, test_result_rows, metadata, job_run_results, alerts_schema_changes, model_run_results, snapshot_run_results, anomaly_threshold_sensitivity, filtered_information_schema_columns, alerts_dbt_source_freshness, alerts_dbt_models, dbt_columns, dbt_artifacts_hashes, metrics_anomaly_score, alerts_anomaly_detection, monitors_runs, alerts_dbt_tests", "name": "ListRelations", "pid": 14076, "thread": "MainThread", "ts": "2023-08-08T13:08:43.405101Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "e4dc1db1-2880-443f-b3f7-28017be6ede8", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 14076, "thread": "MainThread", "ts": "2023-08-08T13:08:43.409108Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.6.0\", \"profile_name\": \"elementary\", \"target_name\": \"default\", \"connection_name\": \"macro_log_macro_results\"} */\n\n    \n    select * from \"dbt\".\"local_analytics_elementary\".\"dbt_invocations\" order by generated_at desc limit 1\n  \n  "}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "e4dc1db1-2880-443f-b3f7-28017be6ede8", "level": "debug", "msg": "On macro_log_macro_results: /* {\"app\": \"dbt\", \"dbt_version\": \"1.6.0\", \"profile_name\": \"elementary\", \"target_name\": \"default\", \"connection_name\": \"macro_log_macro_results\"} */\n\n    \n    select * from \"dbt\".\"local_analytics_elementary\".\"dbt_invocations\" order by generated_at desc limit 1\n  \n  ", "name": "SQLQuery", "pid": 14076, "thread": "MainThread", "ts": "2023-08-08T13:08:43.409415Z"}}
{"data": {"elapsed": 0.0, "status": "SELECT 1"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "e4dc1db1-2880-443f-b3f7-28017be6ede8", "level": "debug", "msg": "SQL status: SELECT 1 in 0.0 seconds", "name": "SQLQueryStatus", "pid": 14076, "thread": "MainThread", "ts": "2023-08-08T13:08:43.412507Z"}}
{"data": {"msg": "Elementary: [{\"invocation_id\": \"ccdeb6aa-962c-4b1d-84f4-5b2a15d4522c\", \"job_id\": null, \"job_name\": null, \"job_run_id\": null, \"run_started_at\": \"2023-08-08 12:56:44\", \"run_completed_at\": \"2023-08-08 12:56:46\", \"generated_at\": \"2023-08-08 12:56:46\", \"created_at\": \"2023-08-08T12:56:46.979139\", \"command\": \"test\", \"dbt_version\": \"1.6.0\", \"elementary_version\": \"0.9.0\", \"full_refresh\": false, \"invocation_vars\": \"{}\", \"vars\": \"{}\", \"target_name\": \"postgres\", \"target_database\": \"dbt\", \"target_schema\": \"local_analytics\", \"target_profile_name\": \"local\", \"threads\": 1.0, \"selected\": \"[]\", \"yaml_selector\": null, \"project_id\": null, \"project_name\": \"test_dbt\", \"env\": null, \"env_id\": null, \"cause_category\": null, \"cause\": null, \"pull_request_id\": null, \"git_sha\": null, \"orchestrator\": null, \"dbt_user\": null, \"job_url\": null, \"job_run_url\": null, \"account_id\": null}]"}, "info": {"category": "", "code": "I062", "extra": {}, "invocation_id": "e4dc1db1-2880-443f-b3f7-28017be6ede8", "level": "info", "msg": "Elementary: [{\"invocation_id\": \"ccdeb6aa-962c-4b1d-84f4-5b2a15d4522c\", \"job_id\": null, \"job_name\": null, \"job_run_id\": null, \"run_started_at\": \"2023-08-08 12:56:44\", \"run_completed_at\": \"2023-08-08 12:56:46\", \"generated_at\": \"2023-08-08 12:56:46\", \"created_at\": \"2023-08-08T12:56:46.979139\", \"command\": \"test\", \"dbt_version\": \"1.6.0\", \"elementary_version\": \"0.9.0\", \"full_refresh\": false, \"invocation_vars\": \"{}\", \"vars\": \"{}\", \"target_name\": \"postgres\", \"target_database\": \"dbt\", \"target_schema\": \"local_analytics\", \"target_profile_name\": \"local\", \"threads\": 1.0, \"selected\": \"[]\", \"yaml_selector\": null, \"project_id\": null, \"project_name\": \"test_dbt\", \"env\": null, \"env_id\": null, \"cause_category\": null, \"cause\": null, \"pull_request_id\": null, \"git_sha\": null, \"orchestrator\": null, \"dbt_user\": null, \"job_url\": null, \"job_run_url\": null, \"account_id\": null}]", "name": "JinjaLogInfo", "pid": 14076, "thread": "MainThread", "ts": "2023-08-08T13:08:43.417470Z"}}
{"data": {"conn_name": "macro_log_macro_results"}, "info": {"category": "", "code": "E012", "extra": {}, "invocation_id": "e4dc1db1-2880-443f-b3f7-28017be6ede8", "level": "debug", "msg": "On macro_log_macro_results: ROLLBACK", "name": "Rollback", "pid": 14076, "thread": "MainThread", "ts": "2023-08-08T13:08:43.417840Z"}}
{"data": {"conn_name": "macro_log_macro_results"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "e4dc1db1-2880-443f-b3f7-28017be6ede8", "level": "debug", "msg": "On macro_log_macro_results: Close", "name": "ConnectionClosed", "pid": 14076, "thread": "MainThread", "ts": "2023-08-08T13:08:43.419129Z"}}
{"data": {"command": "dbt run-operation", "completed_at": "2023-08-08T13:08:43.419957Z", "elapsed": 2.3152175, "success": true}, "info": {"category": "", "code": "Q039", "extra": {}, "invocation_id": "e4dc1db1-2880-443f-b3f7-28017be6ede8", "level": "debug", "msg": "Command `dbt run-operation` succeeded at 16:08:43.419957 after 2.32 seconds", "name": "CommandCompleted", "pid": 14076, "thread": "MainThread", "ts": "2023-08-08T13:08:43.420014Z"}}
{"data": {"conn_name": "macro_log_macro_results"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "e4dc1db1-2880-443f-b3f7-28017be6ede8", "level": "debug", "msg": "Connection 'macro_log_macro_results' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 14076, "thread": "MainThread", "ts": "2023-08-08T13:08:43.420288Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040fdd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b75e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca9d970>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "e4dc1db1-2880-443f-b3f7-28017be6ede8", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040fdd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b75e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca9d970>]}", "name": "SendingEvent", "pid": 14076, "thread": "MainThread", "ts": "2023-08-08T13:08:43.420539Z"}}
{"data": {}, "info": {"category": "", "code": "Z042", "extra": {}, "invocation_id": "e4dc1db1-2880-443f-b3f7-28017be6ede8", "level": "debug", "msg": "Flushing usage events", "name": "FlushEvents", "pid": 14076, "thread": "MainThread", "ts": "2023-08-08T13:08:43.420811Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e71970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069147c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069522b0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "21328765-e348-4523-beb2-813d2f2cb5c4", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e71970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069147c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069522b0>]}", "name": "SendingEvent", "pid": 14089, "thread": "MainThread", "ts": "2023-08-08T13:08:45.303252Z"}}
{"data": {"log_version": 3, "version": "=1.6.0"}, "info": {"category": "", "code": "A001", "extra": {}, "invocation_id": "21328765-e348-4523-beb2-813d2f2cb5c4", "level": "info", "msg": "Running with dbt=1.6.0", "name": "MainReportVersion", "pid": 14089, "thread": "MainThread", "ts": "2023-08-08T13:08:45.305133Z"}}
{"data": {"args": {"cache_selected_only": "False", "debug": "False", "fail_fast": "False", "indirect_selection": "eager", "introspect": "True", "invocation_command": "dbt --log-format json run-operation elementary.log_macro_results --args {\"macro_name\": \"get_adapter_type_and_unique_id\", \"macro_args\": {}} --project-dir /Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/elementary/monitor/dbt_project", "log_cache_events": "False", "log_format": "json", "log_path": "/Users/ofek/workspace/test_dbt/edr_target", "no_print": "None", "partial_parse": "True", "printer_width": "80", "profiles_dir": "/Users/ofek/.dbt", "quiet": "False", "send_anonymous_usage_stats": "True", "static_parser": "True", "target_path": "None", "use_colors": "True", "use_experimental_parser": "False", "version_check": "True", "warn_error": "None", "warn_error_options": "WarnErrorOptions(include=[], exclude=[])", "write_json": "True"}}, "info": {"category": "", "code": "A002", "extra": {}, "invocation_id": "21328765-e348-4523-beb2-813d2f2cb5c4", "level": "debug", "msg": "running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/ofek/workspace/test_dbt/edr_target', 'fail_fast': 'False', 'profiles_dir': '/Users/ofek/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'json', 'invocation_command': 'dbt --log-format json run-operation elementary.log_macro_results --args {\"macro_name\": \"get_adapter_type_and_unique_id\", \"macro_args\": {}} --project-dir /Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/elementary/monitor/dbt_project', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}", "name": "MainReportArgs", "pid": 14089, "thread": "MainThread", "ts": "2023-08-08T13:08:45.305497Z"}}
{"data": {"profile_name": "elementary", "target_name": "default"}, "info": {"category": "", "code": "A005", "extra": {}, "invocation_id": "21328765-e348-4523-beb2-813d2f2cb5c4", "level": "info", "msg": "target not specified in profile 'elementary', using 'default'", "name": "MissingProfileTarget", "pid": 14089, "thread": "MainThread", "ts": "2023-08-08T13:08:45.321540Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'project_id', 'label': '21328765-e348-4523-beb2-813d2f2cb5c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069522b0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "21328765-e348-4523-beb2-813d2f2cb5c4", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '21328765-e348-4523-beb2-813d2f2cb5c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069522b0>]}", "name": "SendingEvent", "pid": 14089, "thread": "MainThread", "ts": "2023-08-08T13:08:45.459878Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'adapter_info', 'label': '21328765-e348-4523-beb2-813d2f2cb5c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c6deb0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "21328765-e348-4523-beb2-813d2f2cb5c4", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '21328765-e348-4523-beb2-813d2f2cb5c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c6deb0>]}", "name": "SendingEvent", "pid": 14089, "thread": "MainThread", "ts": "2023-08-08T13:08:45.465498Z"}}
{"data": {"adapter_name": "postgres", "adapter_version": "=1.6.0"}, "info": {"category": "", "code": "E034", "extra": {}, "invocation_id": "21328765-e348-4523-beb2-813d2f2cb5c4", "level": "info", "msg": "Registered adapter: postgres=1.6.0", "name": "AdapterRegistered", "pid": 14089, "thread": "MainThread", "ts": "2023-08-08T13:08:45.465874Z"}}
{"data": {"checksum": "08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9", "profile": "", "target": "", "vars": "{}", "version": "1.6.0"}, "info": {"category": "", "code": "I025", "extra": {}, "invocation_id": "21328765-e348-4523-beb2-813d2f2cb5c4", "level": "debug", "msg": "checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0", "name": "StateCheckVarsHash", "pid": 14089, "thread": "MainThread", "ts": "2023-08-08T13:08:45.478016Z"}}
{"data": {"added": 0, "changed": 0, "deleted": 0}, "info": {"category": "", "code": "I040", "extra": {}, "invocation_id": "21328765-e348-4523-beb2-813d2f2cb5c4", "level": "debug", "msg": "Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.", "name": "PartialParsingEnabled", "pid": 14089, "thread": "MainThread", "ts": "2023-08-08T13:08:45.556011Z"}}
{"data": {}, "info": {"category": "", "code": "I017", "extra": {}, "invocation_id": "21328765-e348-4523-beb2-813d2f2cb5c4", "level": "debug", "msg": "Partial parsing enabled, no changes found, skipping parsing", "name": "PartialParsingSkipParsing", "pid": 14089, "thread": "MainThread", "ts": "2023-08-08T13:08:45.556311Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'load_project', 'label': '21328765-e348-4523-beb2-813d2f2cb5c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081b60d0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "21328765-e348-4523-beb2-813d2f2cb5c4", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '21328765-e348-4523-beb2-813d2f2cb5c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081b60d0>]}", "name": "SendingEvent", "pid": 14089, "thread": "MainThread", "ts": "2023-08-08T13:08:45.561513Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'resource_counts', 'label': '21328765-e348-4523-beb2-813d2f2cb5c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10815e7f0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "21328765-e348-4523-beb2-813d2f2cb5c4", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '21328765-e348-4523-beb2-813d2f2cb5c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10815e7f0>]}", "name": "SendingEvent", "pid": 14089, "thread": "MainThread", "ts": "2023-08-08T13:08:45.576998Z"}}
{"data": {"stat_line": "34 models, 2 operations, 6 tests, 6 sources, 0 exposures, 0 metrics, 1101 macros, 0 groups, 0 semantic models"}, "info": {"category": "", "code": "W006", "extra": {}, "invocation_id": "21328765-e348-4523-beb2-813d2f2cb5c4", "level": "info", "msg": "Found 34 models, 2 operations, 6 tests, 6 sources, 0 exposures, 0 metrics, 1101 macros, 0 groups, 0 semantic models", "name": "FoundStats", "pid": 14089, "thread": "MainThread", "ts": "2023-08-08T13:08:45.577284Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'runnable_timing', 'label': '21328765-e348-4523-beb2-813d2f2cb5c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c24040>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "21328765-e348-4523-beb2-813d2f2cb5c4", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '21328765-e348-4523-beb2-813d2f2cb5c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c24040>]}", "name": "SendingEvent", "pid": 14089, "thread": "MainThread", "ts": "2023-08-08T13:08:45.577553Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "21328765-e348-4523-beb2-813d2f2cb5c4", "level": "debug", "msg": "Acquiring new postgres connection 'macro_log_macro_results'", "name": "NewConnection", "pid": 14089, "thread": "MainThread", "ts": "2023-08-08T13:08:45.577980Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "21328765-e348-4523-beb2-813d2f2cb5c4", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 14089, "thread": "MainThread", "ts": "2023-08-08T13:08:45.578224Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "BEGIN"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "21328765-e348-4523-beb2-813d2f2cb5c4", "level": "debug", "msg": "On macro_log_macro_results: BEGIN", "name": "SQLQuery", "pid": 14089, "thread": "MainThread", "ts": "2023-08-08T13:08:45.578441Z"}}
{"data": {"connection_state": "init"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "21328765-e348-4523-beb2-813d2f2cb5c4", "level": "debug", "msg": "Opening a new connection, currently in state init", "name": "NewConnectionOpening", "pid": 14089, "thread": "MainThread", "ts": "2023-08-08T13:08:45.578649Z"}}
{"data": {"elapsed": 0.0, "status": "BEGIN"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "21328765-e348-4523-beb2-813d2f2cb5c4", "level": "debug", "msg": "SQL status: BEGIN in 0.0 seconds", "name": "SQLQueryStatus", "pid": 14089, "thread": "MainThread", "ts": "2023-08-08T13:08:45.596287Z"}}
{"data": {"conn_name": "macro_log_macro_results"}, "info": {"category": "", "code": "E018", "extra": {}, "invocation_id": "21328765-e348-4523-beb2-813d2f2cb5c4", "level": "debug", "msg": "On macro_log_macro_results: COMMIT", "name": "SQLCommit", "pid": 14089, "thread": "MainThread", "ts": "2023-08-08T13:08:45.596598Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "21328765-e348-4523-beb2-813d2f2cb5c4", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 14089, "thread": "MainThread", "ts": "2023-08-08T13:08:45.596868Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "COMMIT"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "21328765-e348-4523-beb2-813d2f2cb5c4", "level": "debug", "msg": "On macro_log_macro_results: COMMIT", "name": "SQLQuery", "pid": 14089, "thread": "MainThread", "ts": "2023-08-08T13:08:45.597131Z"}}
{"data": {"elapsed": 0.0, "status": "COMMIT"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "21328765-e348-4523-beb2-813d2f2cb5c4", "level": "debug", "msg": "SQL status: COMMIT in 0.0 seconds", "name": "SQLQueryStatus", "pid": 14089, "thread": "MainThread", "ts": "2023-08-08T13:08:45.598186Z"}}
{"data": {"msg": "Elementary: [\"postgres\", \"127.0.0.1\"]"}, "info": {"category": "", "code": "I062", "extra": {}, "invocation_id": "21328765-e348-4523-beb2-813d2f2cb5c4", "level": "info", "msg": "Elementary: [\"postgres\", \"127.0.0.1\"]", "name": "JinjaLogInfo", "pid": 14089, "thread": "MainThread", "ts": "2023-08-08T13:08:45.605315Z"}}
{"data": {"conn_name": "macro_log_macro_results"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "21328765-e348-4523-beb2-813d2f2cb5c4", "level": "debug", "msg": "On macro_log_macro_results: Close", "name": "ConnectionClosed", "pid": 14089, "thread": "MainThread", "ts": "2023-08-08T13:08:45.605638Z"}}
{"data": {"command": "dbt run-operation", "completed_at": "2023-08-08T13:08:45.606364Z", "elapsed": 0.31347176, "success": true}, "info": {"category": "", "code": "Q039", "extra": {}, "invocation_id": "21328765-e348-4523-beb2-813d2f2cb5c4", "level": "debug", "msg": "Command `dbt run-operation` succeeded at 16:08:45.606364 after 0.31 seconds", "name": "CommandCompleted", "pid": 14089, "thread": "MainThread", "ts": "2023-08-08T13:08:45.606418Z"}}
{"data": {"conn_name": "macro_log_macro_results"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "21328765-e348-4523-beb2-813d2f2cb5c4", "level": "debug", "msg": "Connection 'macro_log_macro_results' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 14089, "thread": "MainThread", "ts": "2023-08-08T13:08:45.606673Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e71970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069522b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c6deb0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "21328765-e348-4523-beb2-813d2f2cb5c4", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e71970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069522b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c6deb0>]}", "name": "SendingEvent", "pid": 14089, "thread": "MainThread", "ts": "2023-08-08T13:08:45.606903Z"}}
{"data": {}, "info": {"category": "", "code": "Z042", "extra": {}, "invocation_id": "21328765-e348-4523-beb2-813d2f2cb5c4", "level": "debug", "msg": "Flushing usage events", "name": "FlushEvents", "pid": 14089, "thread": "MainThread", "ts": "2023-08-08T13:08:45.607150Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056b54f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10814d790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108184280>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "05cdab2b-dd46-412e-9e97-7f861c43b950", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056b54f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10814d790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108184280>]}", "name": "SendingEvent", "pid": 14095, "thread": "MainThread", "ts": "2023-08-08T13:08:47.503059Z"}}
{"data": {"log_version": 3, "version": "=1.6.0"}, "info": {"category": "", "code": "A001", "extra": {}, "invocation_id": "05cdab2b-dd46-412e-9e97-7f861c43b950", "level": "info", "msg": "Running with dbt=1.6.0", "name": "MainReportVersion", "pid": 14095, "thread": "MainThread", "ts": "2023-08-08T13:08:47.505026Z"}}
{"data": {"args": {"cache_selected_only": "False", "debug": "False", "fail_fast": "False", "indirect_selection": "eager", "introspect": "True", "invocation_command": "dbt --log-format json run-operation elementary.log_macro_results --args {\"macro_name\": \"get_elementary_database_and_schema\", \"macro_args\": {}} --project-dir /Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/elementary/monitor/dbt_project", "log_cache_events": "False", "log_format": "json", "log_path": "/Users/ofek/workspace/test_dbt/edr_target", "no_print": "None", "partial_parse": "True", "printer_width": "80", "profiles_dir": "/Users/ofek/.dbt", "quiet": "False", "send_anonymous_usage_stats": "True", "static_parser": "True", "target_path": "None", "use_colors": "True", "use_experimental_parser": "False", "version_check": "True", "warn_error": "None", "warn_error_options": "WarnErrorOptions(include=[], exclude=[])", "write_json": "True"}}, "info": {"category": "", "code": "A002", "extra": {}, "invocation_id": "05cdab2b-dd46-412e-9e97-7f861c43b950", "level": "debug", "msg": "running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/ofek/workspace/test_dbt/edr_target', 'profiles_dir': '/Users/ofek/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt --log-format json run-operation elementary.log_macro_results --args {\"macro_name\": \"get_elementary_database_and_schema\", \"macro_args\": {}} --project-dir /Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/elementary/monitor/dbt_project', 'target_path': 'None', 'log_format': 'json', 'send_anonymous_usage_stats': 'True'}", "name": "MainReportArgs", "pid": 14095, "thread": "MainThread", "ts": "2023-08-08T13:08:47.505392Z"}}
{"data": {"profile_name": "elementary", "target_name": "default"}, "info": {"category": "", "code": "A005", "extra": {}, "invocation_id": "05cdab2b-dd46-412e-9e97-7f861c43b950", "level": "info", "msg": "target not specified in profile 'elementary', using 'default'", "name": "MissingProfileTarget", "pid": 14095, "thread": "MainThread", "ts": "2023-08-08T13:08:47.522553Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'project_id', 'label': '05cdab2b-dd46-412e-9e97-7f861c43b950', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108184280>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "05cdab2b-dd46-412e-9e97-7f861c43b950", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '05cdab2b-dd46-412e-9e97-7f861c43b950', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108184280>]}", "name": "SendingEvent", "pid": 14095, "thread": "MainThread", "ts": "2023-08-08T13:08:47.662199Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'adapter_info', 'label': '05cdab2b-dd46-412e-9e97-7f861c43b950', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094a5e80>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "05cdab2b-dd46-412e-9e97-7f861c43b950", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '05cdab2b-dd46-412e-9e97-7f861c43b950', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094a5e80>]}", "name": "SendingEvent", "pid": 14095, "thread": "MainThread", "ts": "2023-08-08T13:08:47.668052Z"}}
{"data": {"adapter_name": "postgres", "adapter_version": "=1.6.0"}, "info": {"category": "", "code": "E034", "extra": {}, "invocation_id": "05cdab2b-dd46-412e-9e97-7f861c43b950", "level": "info", "msg": "Registered adapter: postgres=1.6.0", "name": "AdapterRegistered", "pid": 14095, "thread": "MainThread", "ts": "2023-08-08T13:08:47.668428Z"}}
{"data": {"checksum": "08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9", "profile": "", "target": "", "vars": "{}", "version": "1.6.0"}, "info": {"category": "", "code": "I025", "extra": {}, "invocation_id": "05cdab2b-dd46-412e-9e97-7f861c43b950", "level": "debug", "msg": "checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0", "name": "StateCheckVarsHash", "pid": 14095, "thread": "MainThread", "ts": "2023-08-08T13:08:47.681001Z"}}
{"data": {"added": 0, "changed": 0, "deleted": 0}, "info": {"category": "", "code": "I040", "extra": {}, "invocation_id": "05cdab2b-dd46-412e-9e97-7f861c43b950", "level": "debug", "msg": "Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.", "name": "PartialParsingEnabled", "pid": 14095, "thread": "MainThread", "ts": "2023-08-08T13:08:47.764724Z"}}
{"data": {}, "info": {"category": "", "code": "I017", "extra": {}, "invocation_id": "05cdab2b-dd46-412e-9e97-7f861c43b950", "level": "debug", "msg": "Partial parsing enabled, no changes found, skipping parsing", "name": "PartialParsingSkipParsing", "pid": 14095, "thread": "MainThread", "ts": "2023-08-08T13:08:47.765097Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'load_project', 'label': '05cdab2b-dd46-412e-9e97-7f861c43b950', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099ee0d0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "05cdab2b-dd46-412e-9e97-7f861c43b950", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '05cdab2b-dd46-412e-9e97-7f861c43b950', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099ee0d0>]}", "name": "SendingEvent", "pid": 14095, "thread": "MainThread", "ts": "2023-08-08T13:08:47.771069Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'resource_counts', 'label': '05cdab2b-dd46-412e-9e97-7f861c43b950', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099977c0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "05cdab2b-dd46-412e-9e97-7f861c43b950", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '05cdab2b-dd46-412e-9e97-7f861c43b950', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099977c0>]}", "name": "SendingEvent", "pid": 14095, "thread": "MainThread", "ts": "2023-08-08T13:08:47.787380Z"}}
{"data": {"stat_line": "34 models, 2 operations, 6 tests, 6 sources, 0 exposures, 0 metrics, 1101 macros, 0 groups, 0 semantic models"}, "info": {"category": "", "code": "W006", "extra": {}, "invocation_id": "05cdab2b-dd46-412e-9e97-7f861c43b950", "level": "info", "msg": "Found 34 models, 2 operations, 6 tests, 6 sources, 0 exposures, 0 metrics, 1101 macros, 0 groups, 0 semantic models", "name": "FoundStats", "pid": 14095, "thread": "MainThread", "ts": "2023-08-08T13:08:47.787681Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'runnable_timing', 'label': '05cdab2b-dd46-412e-9e97-7f861c43b950', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10946e400>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "05cdab2b-dd46-412e-9e97-7f861c43b950", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '05cdab2b-dd46-412e-9e97-7f861c43b950', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10946e400>]}", "name": "SendingEvent", "pid": 14095, "thread": "MainThread", "ts": "2023-08-08T13:08:47.787937Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "05cdab2b-dd46-412e-9e97-7f861c43b950", "level": "debug", "msg": "Acquiring new postgres connection 'macro_log_macro_results'", "name": "NewConnection", "pid": 14095, "thread": "MainThread", "ts": "2023-08-08T13:08:47.788373Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "05cdab2b-dd46-412e-9e97-7f861c43b950", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 14095, "thread": "MainThread", "ts": "2023-08-08T13:08:47.788616Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "BEGIN"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "05cdab2b-dd46-412e-9e97-7f861c43b950", "level": "debug", "msg": "On macro_log_macro_results: BEGIN", "name": "SQLQuery", "pid": 14095, "thread": "MainThread", "ts": "2023-08-08T13:08:47.788846Z"}}
{"data": {"connection_state": "init"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "05cdab2b-dd46-412e-9e97-7f861c43b950", "level": "debug", "msg": "Opening a new connection, currently in state init", "name": "NewConnectionOpening", "pid": 14095, "thread": "MainThread", "ts": "2023-08-08T13:08:47.789063Z"}}
{"data": {"elapsed": 0.0, "status": "BEGIN"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "05cdab2b-dd46-412e-9e97-7f861c43b950", "level": "debug", "msg": "SQL status: BEGIN in 0.0 seconds", "name": "SQLQueryStatus", "pid": 14095, "thread": "MainThread", "ts": "2023-08-08T13:08:47.800549Z"}}
{"data": {"conn_name": "macro_log_macro_results"}, "info": {"category": "", "code": "E018", "extra": {}, "invocation_id": "05cdab2b-dd46-412e-9e97-7f861c43b950", "level": "debug", "msg": "On macro_log_macro_results: COMMIT", "name": "SQLCommit", "pid": 14095, "thread": "MainThread", "ts": "2023-08-08T13:08:47.800850Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "05cdab2b-dd46-412e-9e97-7f861c43b950", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 14095, "thread": "MainThread", "ts": "2023-08-08T13:08:47.801088Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "COMMIT"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "05cdab2b-dd46-412e-9e97-7f861c43b950", "level": "debug", "msg": "On macro_log_macro_results: COMMIT", "name": "SQLQuery", "pid": 14095, "thread": "MainThread", "ts": "2023-08-08T13:08:47.801317Z"}}
{"data": {"elapsed": 0.0, "status": "COMMIT"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "05cdab2b-dd46-412e-9e97-7f861c43b950", "level": "debug", "msg": "SQL status: COMMIT in 0.0 seconds", "name": "SQLQueryStatus", "pid": 14095, "thread": "MainThread", "ts": "2023-08-08T13:08:47.802298Z"}}
{"data": {"msg": "Elementary: \"dbt.local_analytics_elementary\""}, "info": {"category": "", "code": "I062", "extra": {}, "invocation_id": "05cdab2b-dd46-412e-9e97-7f861c43b950", "level": "info", "msg": "Elementary: \"dbt.local_analytics_elementary\"", "name": "JinjaLogInfo", "pid": 14095, "thread": "MainThread", "ts": "2023-08-08T13:08:47.810169Z"}}
{"data": {"conn_name": "macro_log_macro_results"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "05cdab2b-dd46-412e-9e97-7f861c43b950", "level": "debug", "msg": "On macro_log_macro_results: Close", "name": "ConnectionClosed", "pid": 14095, "thread": "MainThread", "ts": "2023-08-08T13:08:47.810476Z"}}
{"data": {"command": "dbt run-operation", "completed_at": "2023-08-08T13:08:47.811219Z", "elapsed": 0.31981504, "success": true}, "info": {"category": "", "code": "Q039", "extra": {}, "invocation_id": "05cdab2b-dd46-412e-9e97-7f861c43b950", "level": "debug", "msg": "Command `dbt run-operation` succeeded at 16:08:47.811219 after 0.32 seconds", "name": "CommandCompleted", "pid": 14095, "thread": "MainThread", "ts": "2023-08-08T13:08:47.811271Z"}}
{"data": {"conn_name": "macro_log_macro_results"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "05cdab2b-dd46-412e-9e97-7f861c43b950", "level": "debug", "msg": "Connection 'macro_log_macro_results' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 14095, "thread": "MainThread", "ts": "2023-08-08T13:08:47.811527Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056b54f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094a5e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109997940>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "05cdab2b-dd46-412e-9e97-7f861c43b950", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056b54f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094a5e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109997940>]}", "name": "SendingEvent", "pid": 14095, "thread": "MainThread", "ts": "2023-08-08T13:08:47.811757Z"}}
{"data": {}, "info": {"category": "", "code": "Z042", "extra": {}, "invocation_id": "05cdab2b-dd46-412e-9e97-7f861c43b950", "level": "debug", "msg": "Flushing usage events", "name": "FlushEvents", "pid": 14095, "thread": "MainThread", "ts": "2023-08-08T13:08:47.811995Z"}}
[0m16:08:49.601096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1024a5520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f75250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f75d60>]}


============================== 16:08:49.603295 | 30e0fad0-a7e5-46c6-a7db-b003b1973361 ==============================
[0m16:08:49.603295 [info ] [MainThread]: Running with dbt=1.6.0
[0m16:08:49.603666 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/ofek/workspace/test_dbt/edr_target', 'debug': 'False', 'profiles_dir': '/Users/ofek/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m alerts --project-dir /Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/elementary/monitor/dbt_project', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:08:49.621085 [info ] [MainThread]: target not specified in profile 'elementary', using 'default'
[0m16:08:49.761589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '30e0fad0-a7e5-46c6-a7db-b003b1973361', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045f87c0>]}
[0m16:08:49.767066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '30e0fad0-a7e5-46c6-a7db-b003b1973361', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106294ee0>]}
[0m16:08:49.767388 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m16:08:49.780892 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m16:08:49.863749 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:08:49.864029 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:08:49.869546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '30e0fad0-a7e5-46c6-a7db-b003b1973361', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067df0d0>]}
[0m16:08:49.885604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '30e0fad0-a7e5-46c6-a7db-b003b1973361', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106789c40>]}
[0m16:08:49.885850 [info ] [MainThread]: Found 34 models, 2 operations, 6 tests, 6 sources, 0 exposures, 0 metrics, 1101 macros, 0 groups, 0 semantic models
[0m16:08:49.886080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '30e0fad0-a7e5-46c6-a7db-b003b1973361', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10625f5b0>]}
[0m16:08:49.886983 [info ] [MainThread]: 
[0m16:08:49.887498 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:08:49.888138 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m16:08:49.894877 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m16:08:49.895123 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "elementary", "target_name": "default", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m16:08:49.895320 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:08:49.915178 [debug] [ThreadPool]: SQL status: SELECT 60 in 0.0 seconds
[0m16:08:49.916047 [debug] [ThreadPool]: On list_dbt: Close
[0m16:08:49.917703 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt, now list_dbt_local_analytics_elementary)
[0m16:08:49.922188 [debug] [ThreadPool]: Using postgres connection "list_dbt_local_analytics_elementary"
[0m16:08:49.922400 [debug] [ThreadPool]: On list_dbt_local_analytics_elementary: BEGIN
[0m16:08:49.922623 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:08:49.932780 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:08:49.933003 [debug] [ThreadPool]: Using postgres connection "list_dbt_local_analytics_elementary"
[0m16:08:49.933203 [debug] [ThreadPool]: On list_dbt_local_analytics_elementary: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "elementary", "target_name": "default", "connection_name": "list_dbt_local_analytics_elementary"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'local_analytics_elementary'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'local_analytics_elementary'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'local_analytics_elementary'
  
[0m16:08:49.935949 [debug] [ThreadPool]: SQL status: SELECT 29 in 0.0 seconds
[0m16:08:49.936884 [debug] [ThreadPool]: On list_dbt_local_analytics_elementary: ROLLBACK
[0m16:08:49.937463 [debug] [ThreadPool]: On list_dbt_local_analytics_elementary: Close
[0m16:08:49.943973 [debug] [MainThread]: Using postgres connection "master"
[0m16:08:49.944209 [debug] [MainThread]: On master: BEGIN
[0m16:08:49.944392 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:08:49.950945 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:08:49.951164 [debug] [MainThread]: Using postgres connection "master"
[0m16:08:49.951421 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "elementary", "target_name": "default", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:08:49.959447 [debug] [MainThread]: SQL status: SELECT 108 in 0.0 seconds
[0m16:08:49.963964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '30e0fad0-a7e5-46c6-a7db-b003b1973361', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067843d0>]}
[0m16:08:49.964268 [debug] [MainThread]: On master: ROLLBACK
[0m16:08:49.964956 [debug] [MainThread]: Using postgres connection "master"
[0m16:08:49.965157 [debug] [MainThread]: On master: BEGIN
[0m16:08:49.966063 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:08:49.966258 [debug] [MainThread]: On master: COMMIT
[0m16:08:49.966461 [debug] [MainThread]: Using postgres connection "master"
[0m16:08:49.966638 [debug] [MainThread]: On master: COMMIT
[0m16:08:49.967185 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:08:49.967431 [info ] [MainThread]: 
[0m16:08:49.967675 [info ] [MainThread]: Running 1 on-run-start hook
[0m16:08:49.979504 [debug] [MainThread]: Writing injected SQL for node "operation.elementary.elementary-on-run-start-0"
[0m16:08:49.980368 [info ] [MainThread]: 1 of 1 START hook: elementary.on-run-start.0 ................................... [RUN]
[0m16:08:49.980678 [info ] [MainThread]: 1 of 1 OK hook: elementary.on-run-start.0 ...................................... [[32mOK[0m in 0.00s]
[0m16:08:49.980883 [info ] [MainThread]: 
[0m16:08:49.981170 [debug] [MainThread]: On master: Close
[0m16:08:49.981596 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m16:08:49.981812 [info ] [MainThread]: 
[0m16:08:49.984408 [debug] [Thread-1  ]: Began running node model.elementary_internal.alerts
[0m16:08:49.984679 [info ] [Thread-1  ]: 1 of 3 START sql incremental model local_analytics_elementary.alerts ........... [RUN]
[0m16:08:49.985071 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt_local_analytics_elementary, now model.elementary_internal.alerts)
[0m16:08:49.985275 [debug] [Thread-1  ]: Began compiling node model.elementary_internal.alerts
[0m16:08:49.993725 [debug] [Thread-1  ]: Writing injected SQL for node "model.elementary_internal.alerts"
[0m16:08:49.994320 [debug] [Thread-1  ]: Timing info for model.elementary_internal.alerts (compile): 16:08:49.985420 => 16:08:49.994207
[0m16:08:49.994547 [debug] [Thread-1  ]: Began executing node model.elementary_internal.alerts
[0m16:08:50.026596 [debug] [Thread-1  ]: Writing runtime sql for node "model.elementary_internal.alerts"
[0m16:08:50.027159 [debug] [Thread-1  ]: Using postgres connection "model.elementary_internal.alerts"
[0m16:08:50.027369 [debug] [Thread-1  ]: On model.elementary_internal.alerts: BEGIN
[0m16:08:50.027563 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:08:50.038734 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:08:50.038970 [debug] [Thread-1  ]: Using postgres connection "model.elementary_internal.alerts"
[0m16:08:50.039208 [debug] [Thread-1  ]: On model.elementary_internal.alerts: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "elementary", "target_name": "default", "node_id": "model.elementary_internal.alerts"} */

      
  
    

  create  table "dbt"."local_analytics_elementary"."alerts"
  
  
    as
  
  (
    






with failed_tests as (
    select * from "dbt"."local_analytics_elementary"."alerts_dbt_tests"

    
        union all
        select * from "dbt"."local_analytics_elementary"."alerts_schema_changes"
    

    
        union all
        select * from "dbt"."local_analytics_elementary"."alerts_anomaly_detection"
    
)

select 
    *,
    false as alert_sent,  
    'pending' as suppression_status,
    cast(NULL as varchar(4096)) as sent_at
from failed_tests
  );
  
  
[0m16:08:50.052297 [debug] [Thread-1  ]: SQL status: SELECT 27 in 0.0 seconds
[0m16:08:50.063592 [debug] [Thread-1  ]: On model.elementary_internal.alerts: COMMIT
[0m16:08:50.063846 [debug] [Thread-1  ]: Using postgres connection "model.elementary_internal.alerts"
[0m16:08:50.064052 [debug] [Thread-1  ]: On model.elementary_internal.alerts: COMMIT
[0m16:08:50.065922 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m16:08:50.066390 [debug] [Thread-1  ]: Timing info for model.elementary_internal.alerts (execute): 16:08:49.994704 => 16:08:50.066293
[0m16:08:50.066600 [debug] [Thread-1  ]: On model.elementary_internal.alerts: Close
[0m16:08:50.067012 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30e0fad0-a7e5-46c6-a7db-b003b1973361', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067e83d0>]}
[0m16:08:50.067341 [info ] [Thread-1  ]: 1 of 3 OK created sql incremental model local_analytics_elementary.alerts ...... [[32mSELECT 27[0m in 0.08s]
[0m16:08:50.067685 [debug] [Thread-1  ]: Finished running node model.elementary_internal.alerts
[0m16:08:50.067943 [debug] [Thread-1  ]: Began running node model.elementary_internal.alerts_models
[0m16:08:50.068355 [info ] [Thread-1  ]: 2 of 3 START sql incremental model local_analytics_elementary.alerts_models .... [RUN]
[0m16:08:50.068763 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.elementary_internal.alerts, now model.elementary_internal.alerts_models)
[0m16:08:50.068969 [debug] [Thread-1  ]: Began compiling node model.elementary_internal.alerts_models
[0m16:08:50.072787 [debug] [Thread-1  ]: Writing injected SQL for node "model.elementary_internal.alerts_models"
[0m16:08:50.073182 [debug] [Thread-1  ]: Timing info for model.elementary_internal.alerts_models (compile): 16:08:50.069145 => 16:08:50.073083
[0m16:08:50.073389 [debug] [Thread-1  ]: Began executing node model.elementary_internal.alerts_models
[0m16:08:50.076989 [debug] [Thread-1  ]: Writing runtime sql for node "model.elementary_internal.alerts_models"
[0m16:08:50.077319 [debug] [Thread-1  ]: Using postgres connection "model.elementary_internal.alerts_models"
[0m16:08:50.077519 [debug] [Thread-1  ]: On model.elementary_internal.alerts_models: BEGIN
[0m16:08:50.077702 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:08:50.084580 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:08:50.084838 [debug] [Thread-1  ]: Using postgres connection "model.elementary_internal.alerts_models"
[0m16:08:50.085054 [debug] [Thread-1  ]: On model.elementary_internal.alerts_models: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "elementary", "target_name": "default", "node_id": "model.elementary_internal.alerts_models"} */

      
  
    

  create  table "dbt"."local_analytics_elementary"."alerts_models"
  
  
    as
  
  (
    




    select 
      *,
      false as alert_sent,  
      'pending' as suppression_status,
      cast(NULL as varchar(4096)) as sent_at
    from "dbt"."local_analytics_elementary"."alerts_dbt_models"
    

  );
  
  
[0m16:08:50.092191 [debug] [Thread-1  ]: SQL status: SELECT 34 in 0.0 seconds
[0m16:08:50.093284 [debug] [Thread-1  ]: On model.elementary_internal.alerts_models: COMMIT
[0m16:08:50.093512 [debug] [Thread-1  ]: Using postgres connection "model.elementary_internal.alerts_models"
[0m16:08:50.093725 [debug] [Thread-1  ]: On model.elementary_internal.alerts_models: COMMIT
[0m16:08:50.094847 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m16:08:50.095536 [debug] [Thread-1  ]: Timing info for model.elementary_internal.alerts_models (execute): 16:08:50.073534 => 16:08:50.095424
[0m16:08:50.095779 [debug] [Thread-1  ]: On model.elementary_internal.alerts_models: Close
[0m16:08:50.096241 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30e0fad0-a7e5-46c6-a7db-b003b1973361', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106832d30>]}
[0m16:08:50.096588 [info ] [Thread-1  ]: 2 of 3 OK created sql incremental model local_analytics_elementary.alerts_models  [[32mSELECT 34[0m in 0.03s]
[0m16:08:50.096930 [debug] [Thread-1  ]: Finished running node model.elementary_internal.alerts_models
[0m16:08:50.097216 [debug] [Thread-1  ]: Began running node model.elementary_internal.alerts_source_freshness
[0m16:08:50.097808 [info ] [Thread-1  ]: 3 of 3 START sql incremental model local_analytics_elementary.alerts_source_freshness  [RUN]
[0m16:08:50.098376 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.elementary_internal.alerts_models, now model.elementary_internal.alerts_source_freshness)
[0m16:08:50.098710 [debug] [Thread-1  ]: Began compiling node model.elementary_internal.alerts_source_freshness
[0m16:08:50.103454 [debug] [Thread-1  ]: Writing injected SQL for node "model.elementary_internal.alerts_source_freshness"
[0m16:08:50.103916 [debug] [Thread-1  ]: Timing info for model.elementary_internal.alerts_source_freshness (compile): 16:08:50.098915 => 16:08:50.103797
[0m16:08:50.104148 [debug] [Thread-1  ]: Began executing node model.elementary_internal.alerts_source_freshness
[0m16:08:50.108722 [debug] [Thread-1  ]: Writing runtime sql for node "model.elementary_internal.alerts_source_freshness"
[0m16:08:50.109082 [debug] [Thread-1  ]: Using postgres connection "model.elementary_internal.alerts_source_freshness"
[0m16:08:50.109457 [debug] [Thread-1  ]: On model.elementary_internal.alerts_source_freshness: BEGIN
[0m16:08:50.109740 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:08:50.114607 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:08:50.114868 [debug] [Thread-1  ]: Using postgres connection "model.elementary_internal.alerts_source_freshness"
[0m16:08:50.115091 [debug] [Thread-1  ]: On model.elementary_internal.alerts_source_freshness: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "elementary", "target_name": "default", "node_id": "model.elementary_internal.alerts_source_freshness"} */

      
  
    

  create  table "dbt"."local_analytics_elementary"."alerts_source_freshness"
  
  
    as
  
  (
    




    select 
      *,
      false as alert_sent,  
      'pending' as suppression_status,
      cast(NULL as varchar(4096)) as sent_at
    from "dbt"."local_analytics_elementary"."alerts_dbt_source_freshness"
    

  );
  
  
[0m16:08:50.119104 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.0 seconds
[0m16:08:50.120219 [debug] [Thread-1  ]: On model.elementary_internal.alerts_source_freshness: COMMIT
[0m16:08:50.120459 [debug] [Thread-1  ]: Using postgres connection "model.elementary_internal.alerts_source_freshness"
[0m16:08:50.120671 [debug] [Thread-1  ]: On model.elementary_internal.alerts_source_freshness: COMMIT
[0m16:08:50.121709 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m16:08:50.122264 [debug] [Thread-1  ]: Timing info for model.elementary_internal.alerts_source_freshness (execute): 16:08:50.104306 => 16:08:50.122159
[0m16:08:50.122496 [debug] [Thread-1  ]: On model.elementary_internal.alerts_source_freshness: Close
[0m16:08:50.122924 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30e0fad0-a7e5-46c6-a7db-b003b1973361', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067f8220>]}
[0m16:08:50.123281 [info ] [Thread-1  ]: 3 of 3 OK created sql incremental model local_analytics_elementary.alerts_source_freshness  [[32mSELECT 0[0m in 0.02s]
[0m16:08:50.123622 [debug] [Thread-1  ]: Finished running node model.elementary_internal.alerts_source_freshness
[0m16:08:50.124708 [debug] [MainThread]: Using postgres connection "master"
[0m16:08:50.124919 [debug] [MainThread]: On master: BEGIN
[0m16:08:50.125122 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:08:50.129952 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:08:50.130232 [debug] [MainThread]: On master: COMMIT
[0m16:08:50.130445 [debug] [MainThread]: Using postgres connection "master"
[0m16:08:50.130644 [debug] [MainThread]: On master: COMMIT
[0m16:08:50.131104 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:08:50.131278 [info ] [MainThread]: 
[0m16:08:50.131457 [info ] [MainThread]: Running 1 on-run-end hook
[0m16:08:50.137706 [debug] [MainThread]: Writing injected SQL for node "operation.elementary.elementary-on-run-end-0"
[0m16:08:50.138108 [info ] [MainThread]: 1 of 1 START hook: elementary.on-run-end.0 ..................................... [RUN]
[0m16:08:50.138397 [info ] [MainThread]: 1 of 1 OK hook: elementary.on-run-end.0 ........................................ [[32mOK[0m in 0.00s]
[0m16:08:50.138594 [info ] [MainThread]: 
[0m16:08:50.138821 [debug] [MainThread]: On master: Close
[0m16:08:50.139192 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:08:50.139362 [debug] [MainThread]: Connection 'model.elementary_internal.alerts_source_freshness' was properly closed.
[0m16:08:50.139553 [info ] [MainThread]: 
[0m16:08:50.139843 [info ] [MainThread]: Finished running 3 incremental models, 2 hooks in 0 hours 0 minutes and 0.25 seconds (0.25s).
[0m16:08:50.140404 [debug] [MainThread]: Command end result
[0m16:08:50.153424 [info ] [MainThread]: 
[0m16:08:50.153747 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:08:50.153942 [info ] [MainThread]: 
[0m16:08:50.154213 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m16:08:50.154581 [debug] [MainThread]: Command `dbt run` succeeded at 16:08:50.154526 after 0.56 seconds
[0m16:08:50.154811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1024a5520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067e83d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106294ee0>]}
[0m16:08:50.155049 [debug] [MainThread]: Flushing usage events
{"data": {"kwargs": "{'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103eed4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069b82b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069b8c10>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "63ea8265-aefd-451a-90a4-e56fd051fcdd", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103eed4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069b82b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069b8c10>]}", "name": "SendingEvent", "pid": 14109, "thread": "MainThread", "ts": "2023-08-08T13:08:51.882961Z"}}
{"data": {"log_version": 3, "version": "=1.6.0"}, "info": {"category": "", "code": "A001", "extra": {}, "invocation_id": "63ea8265-aefd-451a-90a4-e56fd051fcdd", "level": "info", "msg": "Running with dbt=1.6.0", "name": "MainReportVersion", "pid": 14109, "thread": "MainThread", "ts": "2023-08-08T13:08:51.884856Z"}}
{"data": {"args": {"cache_selected_only": "False", "debug": "False", "fail_fast": "False", "indirect_selection": "eager", "introspect": "True", "invocation_command": "dbt --log-format json run-operation elementary.log_macro_results --args {\"macro_name\": \"get_pending_test_alerts\", \"macro_args\": {\"days_back\": 1, \"disable_samples\": false}} --project-dir /Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/elementary/monitor/dbt_project", "log_cache_events": "False", "log_format": "json", "log_path": "/Users/ofek/workspace/test_dbt/edr_target", "no_print": "None", "partial_parse": "True", "printer_width": "80", "profiles_dir": "/Users/ofek/.dbt", "quiet": "False", "send_anonymous_usage_stats": "True", "static_parser": "True", "target_path": "None", "use_colors": "True", "use_experimental_parser": "False", "version_check": "True", "warn_error": "None", "warn_error_options": "WarnErrorOptions(include=[], exclude=[])", "write_json": "True"}}, "info": {"category": "", "code": "A002", "extra": {}, "invocation_id": "63ea8265-aefd-451a-90a4-e56fd051fcdd", "level": "debug", "msg": "running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/ofek/.dbt', 'log_path': '/Users/ofek/workspace/test_dbt/edr_target', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'json', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt --log-format json run-operation elementary.log_macro_results --args {\"macro_name\": \"get_pending_test_alerts\", \"macro_args\": {\"days_back\": 1, \"disable_samples\": false}} --project-dir /Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/elementary/monitor/dbt_project', 'send_anonymous_usage_stats': 'True'}", "name": "MainReportArgs", "pid": 14109, "thread": "MainThread", "ts": "2023-08-08T13:08:51.885218Z"}}
{"data": {"profile_name": "elementary", "target_name": "default"}, "info": {"category": "", "code": "A005", "extra": {}, "invocation_id": "63ea8265-aefd-451a-90a4-e56fd051fcdd", "level": "info", "msg": "target not specified in profile 'elementary', using 'default'", "name": "MissingProfileTarget", "pid": 14109, "thread": "MainThread", "ts": "2023-08-08T13:08:51.901240Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'project_id', 'label': '63ea8265-aefd-451a-90a4-e56fd051fcdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106040940>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "63ea8265-aefd-451a-90a4-e56fd051fcdd", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '63ea8265-aefd-451a-90a4-e56fd051fcdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106040940>]}", "name": "SendingEvent", "pid": 14109, "thread": "MainThread", "ts": "2023-08-08T13:08:52.037164Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'adapter_info', 'label': '63ea8265-aefd-451a-90a4-e56fd051fcdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cdbeb0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "63ea8265-aefd-451a-90a4-e56fd051fcdd", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '63ea8265-aefd-451a-90a4-e56fd051fcdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cdbeb0>]}", "name": "SendingEvent", "pid": 14109, "thread": "MainThread", "ts": "2023-08-08T13:08:52.042643Z"}}
{"data": {"adapter_name": "postgres", "adapter_version": "=1.6.0"}, "info": {"category": "", "code": "E034", "extra": {}, "invocation_id": "63ea8265-aefd-451a-90a4-e56fd051fcdd", "level": "info", "msg": "Registered adapter: postgres=1.6.0", "name": "AdapterRegistered", "pid": 14109, "thread": "MainThread", "ts": "2023-08-08T13:08:52.043008Z"}}
{"data": {"checksum": "08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9", "profile": "", "target": "", "vars": "{}", "version": "1.6.0"}, "info": {"category": "", "code": "I025", "extra": {}, "invocation_id": "63ea8265-aefd-451a-90a4-e56fd051fcdd", "level": "debug", "msg": "checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0", "name": "StateCheckVarsHash", "pid": 14109, "thread": "MainThread", "ts": "2023-08-08T13:08:52.054938Z"}}
{"data": {"added": 0, "changed": 0, "deleted": 0}, "info": {"category": "", "code": "I040", "extra": {}, "invocation_id": "63ea8265-aefd-451a-90a4-e56fd051fcdd", "level": "debug", "msg": "Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.", "name": "PartialParsingEnabled", "pid": 14109, "thread": "MainThread", "ts": "2023-08-08T13:08:52.134243Z"}}
{"data": {}, "info": {"category": "", "code": "I017", "extra": {}, "invocation_id": "63ea8265-aefd-451a-90a4-e56fd051fcdd", "level": "debug", "msg": "Partial parsing enabled, no changes found, skipping parsing", "name": "PartialParsingSkipParsing", "pid": 14109, "thread": "MainThread", "ts": "2023-08-08T13:08:52.134560Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'load_project', 'label': '63ea8265-aefd-451a-90a4-e56fd051fcdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082270d0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "63ea8265-aefd-451a-90a4-e56fd051fcdd", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '63ea8265-aefd-451a-90a4-e56fd051fcdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082270d0>]}", "name": "SendingEvent", "pid": 14109, "thread": "MainThread", "ts": "2023-08-08T13:08:52.139926Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'resource_counts', 'label': '63ea8265-aefd-451a-90a4-e56fd051fcdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081cf7f0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "63ea8265-aefd-451a-90a4-e56fd051fcdd", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '63ea8265-aefd-451a-90a4-e56fd051fcdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081cf7f0>]}", "name": "SendingEvent", "pid": 14109, "thread": "MainThread", "ts": "2023-08-08T13:08:52.156186Z"}}
{"data": {"stat_line": "34 models, 2 operations, 6 tests, 6 sources, 0 exposures, 0 metrics, 1101 macros, 0 groups, 0 semantic models"}, "info": {"category": "", "code": "W006", "extra": {}, "invocation_id": "63ea8265-aefd-451a-90a4-e56fd051fcdd", "level": "info", "msg": "Found 34 models, 2 operations, 6 tests, 6 sources, 0 exposures, 0 metrics, 1101 macros, 0 groups, 0 semantic models", "name": "FoundStats", "pid": 14109, "thread": "MainThread", "ts": "2023-08-08T13:08:52.156482Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'runnable_timing', 'label': '63ea8265-aefd-451a-90a4-e56fd051fcdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c95040>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "63ea8265-aefd-451a-90a4-e56fd051fcdd", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63ea8265-aefd-451a-90a4-e56fd051fcdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c95040>]}", "name": "SendingEvent", "pid": 14109, "thread": "MainThread", "ts": "2023-08-08T13:08:52.156730Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "63ea8265-aefd-451a-90a4-e56fd051fcdd", "level": "debug", "msg": "Acquiring new postgres connection 'macro_log_macro_results'", "name": "NewConnection", "pid": 14109, "thread": "MainThread", "ts": "2023-08-08T13:08:52.157140Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "63ea8265-aefd-451a-90a4-e56fd051fcdd", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 14109, "thread": "MainThread", "ts": "2023-08-08T13:08:52.157376Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "BEGIN"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "63ea8265-aefd-451a-90a4-e56fd051fcdd", "level": "debug", "msg": "On macro_log_macro_results: BEGIN", "name": "SQLQuery", "pid": 14109, "thread": "MainThread", "ts": "2023-08-08T13:08:52.157590Z"}}
{"data": {"connection_state": "init"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "63ea8265-aefd-451a-90a4-e56fd051fcdd", "level": "debug", "msg": "Opening a new connection, currently in state init", "name": "NewConnectionOpening", "pid": 14109, "thread": "MainThread", "ts": "2023-08-08T13:08:52.157805Z"}}
{"data": {"elapsed": 0.0, "status": "BEGIN"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "63ea8265-aefd-451a-90a4-e56fd051fcdd", "level": "debug", "msg": "SQL status: BEGIN in 0.0 seconds", "name": "SQLQueryStatus", "pid": 14109, "thread": "MainThread", "ts": "2023-08-08T13:08:52.175135Z"}}
{"data": {"conn_name": "macro_log_macro_results"}, "info": {"category": "", "code": "E018", "extra": {}, "invocation_id": "63ea8265-aefd-451a-90a4-e56fd051fcdd", "level": "debug", "msg": "On macro_log_macro_results: COMMIT", "name": "SQLCommit", "pid": 14109, "thread": "MainThread", "ts": "2023-08-08T13:08:52.175435Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "63ea8265-aefd-451a-90a4-e56fd051fcdd", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 14109, "thread": "MainThread", "ts": "2023-08-08T13:08:52.175681Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "COMMIT"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "63ea8265-aefd-451a-90a4-e56fd051fcdd", "level": "debug", "msg": "On macro_log_macro_results: COMMIT", "name": "SQLQuery", "pid": 14109, "thread": "MainThread", "ts": "2023-08-08T13:08:52.175916Z"}}
{"data": {"elapsed": 0.0, "status": "COMMIT"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "63ea8265-aefd-451a-90a4-e56fd051fcdd", "level": "debug", "msg": "SQL status: COMMIT in 0.0 seconds", "name": "SQLQueryStatus", "pid": 14109, "thread": "MainThread", "ts": "2023-08-08T13:08:52.177021Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "63ea8265-aefd-451a-90a4-e56fd051fcdd", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 14109, "thread": "MainThread", "ts": "2023-08-08T13:08:52.207621Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.6.0\", \"profile_name\": \"elementary\", \"target_name\": \"default\", \"connection_name\": \"macro_log_macro_results\"} */\n\n    \n        with alerts_in_time_limit as (\n            select * from \"dbt\".\"local_analytics_elementary\".\"alerts\"\n            where cast(detected_at as TIMESTAMP) >= cast(\n\n    date_trunc('day', \n    current_timestamp::TIMESTAMP\n) + ((interval '1 day') * (-1))\n\n as TIMESTAMP)\n        ),\n\n        models as (\n            select * from \"dbt\".\"local_analytics_elementary\".\"dbt_models\"\n        ),\n\n        sources as (\n            select * from \"dbt\".\"local_analytics_elementary\".\"dbt_sources\"\n        ),\n\n        tests as (\n            select * from \"dbt\".\"local_analytics_elementary\".\"dbt_tests\"\n        ),\n\n        artifacts_meta as (\n            select unique_id, meta from models\n            union all\n            select unique_id, meta from sources\n        ),\n\n        extended_alerts as (\n            select \n                alerts_in_time_limit.alert_id,\n                \n                coalesce(alerts_in_time_limit.test_unique_id, 'None') || '.' || coalesce(alerts_in_time_limit.column_name, 'None') || '.' || coalesce(alerts_in_time_limit.sub_type, 'None') as alert_class_id,\n                alerts_in_time_limit.data_issue_id,\n                alerts_in_time_limit.test_execution_id,\n                alerts_in_time_limit.test_unique_id,\n                alerts_in_time_limit.model_unique_id,\n                alerts_in_time_limit.detected_at,\n                alerts_in_time_limit.database_name,\n                alerts_in_time_limit.schema_name,\n                alerts_in_time_limit.table_name,\n                alerts_in_time_limit.column_name,\n                alerts_in_time_limit.alert_type,\n                alerts_in_time_limit.sub_type,\n                alerts_in_time_limit.alert_description,\n                alerts_in_time_limit.owners,\n                alerts_in_time_limit.tags,\n                alerts_in_time_limit.alert_results_query,\n                alerts_in_time_limit.other,\n                alerts_in_time_limit.test_name,\n                alerts_in_time_limit.test_params,\n                alerts_in_time_limit.severity,\n                alerts_in_time_limit.status,\n                alerts_in_time_limit.result_rows,\n                alerts_in_time_limit.test_short_name,\n                \n                case\n                    when alerts_in_time_limit.suppression_status is NULL and alerts_in_time_limit.alert_sent = TRUE then 'sent'\n                    when alerts_in_time_limit.suppression_status is NULL and alerts_in_time_limit.alert_sent = FALSE then 'pending'\n                    else suppression_status\n                end as suppression_status,\n                alerts_in_time_limit.sent_at,\n                tests.meta as test_meta,\n                artifacts_meta.meta as model_meta\n            from alerts_in_time_limit\n            left join tests on alerts_in_time_limit.test_unique_id = tests.unique_id\n            left join artifacts_meta on alerts_in_time_limit.model_unique_id = artifacts_meta.unique_id\n        )\n\n        select *\n        from extended_alerts\n        where suppression_status = 'pending'\n    \n  "}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "63ea8265-aefd-451a-90a4-e56fd051fcdd", "level": "debug", "msg": "On macro_log_macro_results: /* {\"app\": \"dbt\", \"dbt_version\": \"1.6.0\", \"profile_name\": \"elementary\", \"target_name\": \"default\", \"connection_name\": \"macro_log_macro_results\"} */\n\n    \n        with alerts_in_time_limit as (\n            select * from \"dbt\".\"local_analytics_elementary\".\"alerts\"\n            where cast(detected_at as TIMESTAMP) >= cast(\n\n    date_trunc('day', \n    current_timestamp::TIMESTAMP\n) + ((interval '1 day') * (-1))\n\n as TIMESTAMP)\n        ),\n\n        models as (\n            select * from \"dbt\".\"local_analytics_elementary\".\"dbt_models\"\n        ),\n\n        sources as (\n            select * from \"dbt\".\"local_analytics_elementary\".\"dbt_sources\"\n        ),\n\n        tests as (\n            select * from \"dbt\".\"local_analytics_elementary\".\"dbt_tests\"\n        ),\n\n        artifacts_meta as (\n            select unique_id, meta from models\n            union all\n            select unique_id, meta from sources\n        ),\n\n        extended_alerts as (\n            select \n                alerts_in_time_limit.alert_id,\n                \n                coalesce(alerts_in_time_limit.test_unique_id, 'None') || '.' || coalesce(alerts_in_time_limit.column_name, 'None') || '.' || coalesce(alerts_in_time_limit.sub_type, 'None') as alert_class_id,\n                alerts_in_time_limit.data_issue_id,\n                alerts_in_time_limit.test_execution_id,\n                alerts_in_time_limit.test_unique_id,\n                alerts_in_time_limit.model_unique_id,\n                alerts_in_time_limit.detected_at,\n                alerts_in_time_limit.database_name,\n                alerts_in_time_limit.schema_name,\n                alerts_in_time_limit.table_name,\n                alerts_in_time_limit.column_name,\n                alerts_in_time_limit.alert_type,\n                alerts_in_time_limit.sub_type,\n                alerts_in_time_limit.alert_description,\n                alerts_in_time_limit.owners,\n                alerts_in_time_limit.tags,\n                alerts_in_time_limit.alert_results_query,\n                alerts_in_time_limit.other,\n                alerts_in_time_limit.test_name,\n                alerts_in_time_limit.test_params,\n                alerts_in_time_limit.severity,\n                alerts_in_time_limit.status,\n                alerts_in_time_limit.result_rows,\n                alerts_in_time_limit.test_short_name,\n                \n                case\n                    when alerts_in_time_limit.suppression_status is NULL and alerts_in_time_limit.alert_sent = TRUE then 'sent'\n                    when alerts_in_time_limit.suppression_status is NULL and alerts_in_time_limit.alert_sent = FALSE then 'pending'\n                    else suppression_status\n                end as suppression_status,\n                alerts_in_time_limit.sent_at,\n                tests.meta as test_meta,\n                artifacts_meta.meta as model_meta\n            from alerts_in_time_limit\n            left join tests on alerts_in_time_limit.test_unique_id = tests.unique_id\n            left join artifacts_meta on alerts_in_time_limit.model_unique_id = artifacts_meta.unique_id\n        )\n\n        select *\n        from extended_alerts\n        where suppression_status = 'pending'\n    \n  ", "name": "SQLQuery", "pid": 14109, "thread": "MainThread", "ts": "2023-08-08T13:08:52.207975Z"}}
{"data": {"elapsed": 0.0, "status": "SELECT 27"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "63ea8265-aefd-451a-90a4-e56fd051fcdd", "level": "debug", "msg": "SQL status: SELECT 27 in 0.0 seconds", "name": "SQLQueryStatus", "pid": 14109, "thread": "MainThread", "ts": "2023-08-08T13:08:52.221644Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "63ea8265-aefd-451a-90a4-e56fd051fcdd", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 14109, "thread": "MainThread", "ts": "2023-08-08T13:08:52.233885Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.6.0\", \"profile_name\": \"elementary\", \"target_name\": \"default\", \"connection_name\": \"macro_log_macro_results\"} */\n\n    \n  select\n    elementary_test_results_id,\n    result_row\n  from \"dbt\".\"local_analytics_elementary\".\"test_result_rows\"\n  where \n        ((\n    current_timestamp::TIMESTAMP\n)::date - (cast(detected_at as TIMESTAMP))::date)\n     < 1\n  \n  "}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "63ea8265-aefd-451a-90a4-e56fd051fcdd", "level": "debug", "msg": "On macro_log_macro_results: /* {\"app\": \"dbt\", \"dbt_version\": \"1.6.0\", \"profile_name\": \"elementary\", \"target_name\": \"default\", \"connection_name\": \"macro_log_macro_results\"} */\n\n    \n  select\n    elementary_test_results_id,\n    result_row\n  from \"dbt\".\"local_analytics_elementary\".\"test_result_rows\"\n  where \n        ((\n    current_timestamp::TIMESTAMP\n)::date - (cast(detected_at as TIMESTAMP))::date)\n     < 1\n  \n  ", "name": "SQLQuery", "pid": 14109, "thread": "MainThread", "ts": "2023-08-08T13:08:52.234173Z"}}
{"data": {"elapsed": 0.0, "status": "SELECT 5"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "63ea8265-aefd-451a-90a4-e56fd051fcdd", "level": "debug", "msg": "SQL status: SELECT 5 in 0.0 seconds", "name": "SQLQueryStatus", "pid": 14109, "thread": "MainThread", "ts": "2023-08-08T13:08:52.236164Z"}}
{"data": {"msg": "Elementary: [{\"id\": \"ccdeb6aa-962c-4b1d-84f4-5b2a15d4522c.test.test_dbt.failing_test_stg_customers_last_name_last_name.847ec3eec4\", \"alert_class_id\": \"test.test_dbt.failing_test_stg_customers_last_name_last_name.847ec3eec4.last_name || last_name.generic\", \"model_unique_id\": \"model.test_dbt.stg_customers\", \"test_unique_id\": \"test.test_dbt.failing_test_stg_customers_last_name_last_name.847ec3eec4\", \"detected_at\": \"2023-08-08T12:56:45\", \"database_name\": \"dbt\", \"schema_name\": \"local_analytics\", \"table_name\": \"stg_customers\", \"column_name\": \"last_name || last_name\", \"test_type\": \"dbt_test\", \"test_sub_type\": \"generic\", \"test_results_description\": \"Got 100 results, configured to fail if != 0\", \"owners\": \"[]\", \"tags\": \"[\\\"critical-tag\\\"]\", \"test_results_query\": \"\\nselect last_name || last_name from \\\"dbt\\\".\\\"local_analytics\\\".\\\"stg_customers\\\"\\n\", \"test_rows_sample\": [{\"?column?\": \"P.P.\"}, {\"?column?\": \"M.M.\"}, {\"?column?\": \"P.P.\"}, {\"?column?\": \"C.C.\"}, {\"?column?\": \"R.R.\"}], \"other\": null, \"test_name\": \"failing_test_stg_customers_last_name_last_name\", \"test_short_name\": \"failing_test\", \"test_params\": \"{\\\"column_name\\\": \\\"last_name || last_name\\\", \\\"model\\\": \\\"{{ get_where_subquery(ref('stg_customers')) }}\\\"}\", \"severity\": \"ERROR\", \"test_meta\": \"{}\", \"model_meta\": \"{}\", \"suppression_status\": \"pending\", \"sent_at\": null, \"status\": \"fail\"}, {\"id\": \"5e2e388e-e883-4989-8f54-0a5225805882.test.test_dbt.failing_test_stg_customers_last_name_last_name.847ec3eec4\", \"alert_class_id\": \"test.test_dbt.failing_test_stg_customers_last_name_last_name.847ec3eec4.last_name || last_name.generic\", \"model_unique_id\": \"model.test_dbt.stg_customers\", \"test_unique_id\": \"test.test_dbt.failing_test_stg_customers_last_name_last_name.847ec3eec4\", \"detected_at\": \"2023-08-07T12:29:09\", \"database_name\": \"dbt\", \"schema_name\": \"local_analytics\", \"table_name\": \"stg_customers\", \"column_name\": \"last_name || last_name\", \"test_type\": \"dbt_test\", \"test_sub_type\": \"generic\", \"test_results_description\": \"Got 100 results, configured to fail if != 0\", \"owners\": \"[]\", \"tags\": \"[\\\"critical-tag\\\"]\", \"test_results_query\": \"\\nselect last_name || last_name from \\\"dbt\\\".\\\"local_analytics\\\".\\\"stg_customers\\\"\\n\", \"test_rows_sample\": [], \"other\": null, \"test_name\": \"failing_test_stg_customers_last_name_last_name\", \"test_short_name\": \"failing_test\", \"test_params\": \"{\\\"column_name\\\": \\\"last_name || last_name\\\", \\\"model\\\": \\\"{{ get_where_subquery(ref('stg_customers')) }}\\\"}\", \"severity\": \"ERROR\", \"test_meta\": \"{}\", \"model_meta\": \"{}\", \"suppression_status\": \"pending\", \"sent_at\": null, \"status\": \"fail\"}, {\"id\": \"f9f8b46b-9ba6-4db8-b9a8-20a04cd01d5e.test.test_dbt.failing_test_stg_customers_last_name_last_name.847ec3eec4\", \"alert_class_id\": \"test.test_dbt.failing_test_stg_customers_last_name_last_name.847ec3eec4.last_name || last_name.generic\", \"model_unique_id\": \"model.test_dbt.stg_customers\", \"test_unique_id\": \"test.test_dbt.failing_test_stg_customers_last_name_last_name.847ec3eec4\", \"detected_at\": \"2023-08-07T12:26:54\", \"database_name\": \"dbt\", \"schema_name\": \"local_analytics\", \"table_name\": \"stg_customers\", \"column_name\": \"last_name || last_name\", \"test_type\": \"dbt_test\", \"test_sub_type\": \"generic\", \"test_results_description\": \"Got 100 results, configured to fail if != 0\", \"owners\": \"[]\", \"tags\": \"[\\\"critical-tag\\\"]\", \"test_results_query\": \"\\nselect last_name || last_name from \\\"dbt\\\".\\\"local_analytics\\\".\\\"stg_customers\\\"\\n\", \"test_rows_sample\": [], \"other\": null, \"test_name\": \"failing_test_stg_customers_last_name_last_name\", \"test_short_name\": \"failing_test\", \"test_params\": \"{\\\"column_name\\\": \\\"last_name || last_name\\\", \\\"model\\\": \\\"{{ get_where_subquery(ref('stg_customers')) }}\\\"}\", \"severity\": \"ERROR\", \"test_meta\": \"{}\", \"model_meta\": \"{}\", \"suppression_status\": \"pending\", \"sent_at\": null, \"status\": \"fail\"}, {\"id\": \"5ae5c1b9-bb50-4899-8860-56bae80936b6.test.test_dbt.failing_test_stg_customers_last_name_last_name.847ec3eec4\", \"alert_class_id\": \"test.test_dbt.failing_test_stg_customers_last_name_last_name.847ec3eec4.last_name || last_name.generic\", \"model_unique_id\": \"model.test_dbt.stg_customers\", \"test_unique_id\": \"test.test_dbt.failing_test_stg_customers_last_name_last_name.847ec3eec4\", \"detected_at\": \"2023-08-07T12:19:34\", \"database_name\": \"dbt\", \"schema_name\": \"local_analytics\", \"table_name\": \"stg_customers\", \"column_name\": \"last_name || last_name\", \"test_type\": \"dbt_test\", \"test_sub_type\": \"generic\", \"test_results_description\": \"Got 100 results, configured to fail if != 0\", \"owners\": \"[]\", \"tags\": \"[\\\"critical-tag\\\"]\", \"test_results_query\": \"\\nselect last_name || last_name from \\\"dbt\\\".\\\"local_analytics\\\".\\\"stg_customers\\\"\\n\", \"test_rows_sample\": [], \"other\": null, \"test_name\": \"failing_test_stg_customers_last_name_last_name\", \"test_short_name\": \"failing_test\", \"test_params\": \"{\\\"column_name\\\": \\\"last_name || last_name\\\", \\\"model\\\": \\\"{{ get_where_subquery(ref('stg_customers')) }}\\\"}\", \"severity\": \"ERROR\", \"test_meta\": \"{}\", \"model_meta\": \"{}\", \"suppression_status\": \"pending\", \"sent_at\": null, \"status\": \"fail\"}, {\"id\": \"ce2e4bf3-1071-4144-a060-4cbfc0edb4ff.test.test_dbt.failing_test_stg_customers_last_name_last_name.847ec3eec4\", \"alert_class_id\": \"test.test_dbt.failing_test_stg_customers_last_name_last_name.847ec3eec4.last_name || last_name.generic\", \"model_unique_id\": \"model.test_dbt.stg_customers\", \"test_unique_id\": \"test.test_dbt.failing_test_stg_customers_last_name_last_name.847ec3eec4\", \"detected_at\": \"2023-08-07T12:08:15\", \"database_name\": \"dbt\", \"schema_name\": \"local_analytics\", \"table_name\": \"stg_customers\", \"column_name\": \"last_name || last_name\", \"test_type\": \"dbt_test\", \"test_sub_type\": \"generic\", \"test_results_description\": \"Got 100 results, configured to fail if != 0\", \"owners\": \"[]\", \"tags\": \"[\\\"critical-tag\\\"]\", \"test_results_query\": \"\\nselect last_name || last_name from \\\"dbt\\\".\\\"local_analytics\\\".\\\"stg_customers\\\"\\n\", \"test_rows_sample\": [], \"other\": null, \"test_name\": \"failing_test_stg_customers_last_name_last_name\", \"test_short_name\": \"failing_test\", \"test_params\": \"{\\\"column_name\\\": \\\"last_name || last_name\\\", \\\"model\\\": \\\"{{ get_where_subquery(ref('stg_customers')) }}\\\"}\", \"severity\": \"ERROR\", \"test_meta\": \"{}\", \"model_meta\": \"{}\", \"suppression_status\": \"pending\", \"sent_at\": null, \"status\": \"fail\"}, {\"id\": \"82641d52-4826-40cf-994d-7339c5303164.test.test_dbt.failing_test_stg_customers_last_name_last_name.847ec3eec4\", \"alert_class_id\": \"test.test_dbt.failing_test_stg_customers_last_name_last_name.847ec3eec4.last_name || last_name.generic\", \"model_unique_id\": \"model.test_dbt.stg_customers\", \"test_unique_id\": \"test.test_dbt.failing_test_stg_customers_last_name_last_name.847ec3eec4\", \"detected_at\": \"2023-08-07T12:07:58\", \"database_name\": \"dbt\", \"schema_name\": \"local_analytics\", \"table_name\": \"stg_customers\", \"column_name\": \"last_name || last_name\", \"test_type\": \"dbt_test\", \"test_sub_type\": \"generic\", \"test_results_description\": \"Database Error in test failing_test_stg_customers_last_name_last_name (models/staging/models.yml)\\n  column \\\"column_name\\\" does not exist\\n  LINE 14: select column_name from \\\"dbt\\\".\\\"local_analytics\\\".\\\"stg_custome...\\n                  ^\", \"owners\": \"[]\", \"tags\": \"[\\\"critical-tag\\\"]\", \"test_results_query\": \"\\nselect column_name from \\\"dbt\\\".\\\"local_analytics\\\".\\\"stg_customers\\\"\\n\", \"test_rows_sample\": null, \"other\": null, \"test_name\": \"failing_test_stg_customers_last_name_last_name\", \"test_short_name\": \"failing_test\", \"test_params\": \"{\\\"column_name\\\": \\\"last_name || last_name\\\", \\\"model\\\": \\\"{{ get_where_subquery(ref('stg_customers')) }}\\\"}\", \"severity\": \"ERROR\", \"test_meta\": \"{}\", \"model_meta\": \"{}\", \"suppression_status\": \"pending\", \"sent_at\": null, \"status\": \"error\"}, {\"id\": \"40ac6f6e-ca0b-4bc2-bd48-854f63035b55.test.test_dbt.unique_stg_customers_last_name_last_name.0845e13bad\", \"alert_class_id\": \"test.test_dbt.unique_stg_customers_last_name_last_name.0845e13bad.last_name || last_name.generic\", \"model_unique_id\": \"model.test_dbt.stg_customers\", \"test_unique_id\": \"test.test_dbt.unique_stg_customers_last_name_last_name.0845e13bad\", \"detected_at\": \"2023-08-07T12:00:30\", \"database_name\": \"dbt\", \"schema_name\": \"local_analytics\", \"table_name\": \"stg_customers\", \"column_name\": \"last_name || last_name\", \"test_type\": \"dbt_test\", \"test_sub_type\": \"generic\", \"test_results_description\": \"Got 17 results, configured to fail if != 0\", \"owners\": \"[]\", \"tags\": \"[\\\"critical-tag\\\"]\", \"test_results_query\": \"\\n    \\n    \\n\\nselect\\n    last_name || last_name as unique_field,\\n    count(*) as n_records\\n\\nfrom \\\"dbt\\\".\\\"local_analytics\\\".\\\"stg_customers\\\"\\nwhere last_name || last_name is not null\\ngroup by last_name || last_name\\nhaving count(*) > 1\\n\\n\\n\", \"test_rows_sample\": [], \"other\": null, \"test_name\": \"unique_stg_customers_last_name_last_name\", \"test_short_name\": \"unique\", \"test_params\": \"{\\\"column_name\\\": \\\"last_name || last_name\\\", \\\"model\\\": \\\"{{ get_where_subquery(ref('stg_customers')) }}\\\"}\", \"severity\": \"ERROR\", \"test_meta\": null, \"model_meta\": \"{}\", \"suppression_status\": \"pending\", \"sent_at\": null, \"status\": \"fail\"}, {\"id\": \"9a47e226-16da-4111-bd02-ee802a0af48c.test.test_dbt.unique_stg_customers_last_name_last_name.0845e13bad\", \"alert_class_id\": \"test.test_dbt.unique_stg_customers_last_name_last_name.0845e13bad.last_name || last_name.generic\", \"model_unique_id\": \"model.test_dbt.stg_customers\", \"test_unique_id\": \"test.test_dbt.unique_stg_customers_last_name_last_name.0845e13bad\", \"detected_at\": \"2023-08-07T11:59:41\", \"database_name\": \"dbt\", \"schema_name\": \"local_analytics\", \"table_name\": \"stg_customers\", \"column_name\": \"last_name || last_name\", \"test_type\": \"dbt_test\", \"test_sub_type\": \"generic\", \"test_results_description\": \"Got 17 results, configured to fail if != 0\", \"owners\": \"[]\", \"tags\": \"[\\\"critical-tag\\\"]\", \"test_results_query\": \"\\n    \\n    \\n\\nselect\\n    last_name || last_name as unique_field,\\n    count(*) as n_records\\n\\nfrom \\\"dbt\\\".\\\"local_analytics\\\".\\\"stg_customers\\\"\\nwhere last_name || last_name is not null\\ngroup by last_name || last_name\\nhaving count(*) > 1\\n\\n\\n\", \"test_rows_sample\": [], \"other\": null, \"test_name\": \"unique_stg_customers_last_name_last_name\", \"test_short_name\": \"unique\", \"test_params\": \"{\\\"column_name\\\": \\\"last_name || last_name\\\", \\\"model\\\": \\\"{{ get_where_subquery(ref('stg_customers')) }}\\\"}\", \"severity\": \"ERROR\", \"test_meta\": null, \"model_meta\": \"{}\", \"suppression_status\": \"pending\", \"sent_at\": null, \"status\": \"fail\"}, {\"id\": \"a30fc06b-d642-44ed-95a6-dfd13be58b84.test.test_dbt.unique_stg_customers_customer_id.c7614daada\", \"alert_class_id\": \"test.test_dbt.unique_stg_customers_customer_id.c7614daada.customer_id.generic\", \"model_unique_id\": \"model.test_dbt.stg_customers\", \"test_unique_id\": \"test.test_dbt.unique_stg_customers_customer_id.c7614daada\", \"detected_at\": \"2023-08-07T11:47:13\", \"database_name\": \"dbt\", \"schema_name\": \"local_analytics\", \"table_name\": \"stg_customers\", \"column_name\": \"customer_id\", \"test_type\": \"dbt_test\", \"test_sub_type\": \"generic\", \"test_results_description\": \"Database Error in test unique_stg_customers_customer_id (models/staging/models.yml)\\n  relation \\\"local_analytics.stg_customers\\\" does not exist\\n  LINE 21: from \\\"dbt\\\".\\\"local_analytics\\\".\\\"stg_customers\\\"\\n                ^\", \"owners\": \"[]\", \"tags\": \"[\\\"critical-tag\\\"]\", \"test_results_query\": \"\\n    \\n    \\n\\nselect\\n    customer_id as unique_field,\\n    count(*) as n_records\\n\\nfrom \\\"dbt\\\".\\\"local_analytics\\\".\\\"stg_customers\\\"\\nwhere customer_id is not null\\ngroup by customer_id\\nhaving count(*) > 1\\n\\n\\n\", \"test_rows_sample\": null, \"other\": null, \"test_name\": \"unique_stg_customers_customer_id\", \"test_short_name\": \"unique\", \"test_params\": \"{\\\"column_name\\\": \\\"customer_id\\\", \\\"model\\\": \\\"{{ get_where_subquery(ref('stg_customers')) }}\\\"}\", \"severity\": \"ERROR\", \"test_meta\": \"{\\\"description\\\": \\\"This test validates that there are no duplicate values present in a field.\\\"}\", \"model_meta\": \"{}\", \"suppression_status\": \"pending\", \"sent_at\": null, \"status\": \"error\"}, {\"id\": \"a30fc06b-d642-44ed-95a6-dfd13be58b84.test.test_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa\", \"alert_class_id\": \"test.test_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa.customer_id.generic\", \"model_unique_id\": \"model.test_dbt.stg_customers\", \"test_unique_id\": \"test.test_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa\", \"detected_at\": \"2023-08-07T11:47:13\", \"database_name\": \"dbt\", \"schema_name\": \"local_analytics\", \"table_name\": \"stg_customers\", \"column_name\": \"customer_id\", \"test_type\": \"dbt_test\", \"test_sub_type\": \"generic\", \"test_results_description\": \"Database Error in test not_null_stg_customers_customer_id (models/staging/models.yml)\\n  relation \\\"local_analytics.stg_customers\\\" does not exist\\n  LINE 20: from \\\"dbt\\\".\\\"local_analytics\\\".\\\"stg_customers\\\"\\n                ^\", \"owners\": \"[]\", \"tags\": \"[\\\"critical-tag\\\"]\", \"test_results_query\": \"\\n    \\n    \\n\\n\\n\\nselect customer_id\\nfrom \\\"dbt\\\".\\\"local_analytics\\\".\\\"stg_customers\\\"\\nwhere customer_id is null\\n\\n\\n\", \"test_rows_sample\": null, \"other\": null, \"test_name\": \"not_null_stg_customers_customer_id\", \"test_short_name\": \"not_null\", \"test_params\": \"{\\\"column_name\\\": \\\"customer_id\\\", \\\"model\\\": \\\"{{ get_where_subquery(ref('stg_customers')) }}\\\"}\", \"severity\": \"ERROR\", \"test_meta\": \"{\\\"description\\\": \\\"This test validates that there are no `null` values present in a column.\\\"}\", \"model_meta\": \"{}\", \"suppression_status\": \"pending\", \"sent_at\": null, \"status\": \"error\"}, {\"id\": \"a30fc06b-d642-44ed-95a6-dfd13be58b84.test.test_dbt.assert_positive_value_for_total_amount\", \"alert_class_id\": \"test.test_dbt.assert_positive_value_for_total_amount.None.singular\", \"model_unique_id\": \"model.test_dbt.stg_payments\", \"test_unique_id\": \"test.test_dbt.assert_positive_value_for_total_amount\", \"detected_at\": \"2023-08-07T11:47:13\", \"database_name\": \"dbt\", \"schema_name\": \"local_analytics\", \"table_name\": \"stg_payments\", \"column_name\": null, \"test_type\": \"dbt_test\", \"test_sub_type\": \"singular\", \"test_results_description\": \"Database Error in test assert_positive_value_for_total_amount (tests/assert_positive_value_for_total_amount.sql)\\n  relation \\\"local_analytics.stg_payments\\\" does not exist\\n  LINE 18: from \\\"dbt\\\".\\\"local_analytics\\\".\\\"stg_payments\\\"\\n                ^\", \"owners\": \"[]\", \"tags\": \"[]\", \"test_results_query\": \"-- Refunds have a negative amount, so the total amount should always be >= 0.\\n-- Therefore return records where this isn't true to make the test fail.\\nselect\\n    order_id,\\n\\tsum(amount) as total_amount\\nfrom \\\"dbt\\\".\\\"local_analytics\\\".\\\"stg_payments\\\"\\ngroup by 1\\nhaving not(sum(amount) >= 0)\", \"test_rows_sample\": null, \"other\": null, \"test_name\": \"assert_positive_value_for_total_amount\", \"test_short_name\": \"assert_positive_value_for_total_amount\", \"test_params\": \"{}\", \"severity\": \"ERROR\", \"test_meta\": \"{}\", \"model_meta\": \"{}\", \"suppression_status\": \"pending\", \"sent_at\": null, \"status\": \"error\"}, {\"id\": \"80eeba1e-8527-416a-8d86-c42fc32450ac.test.test_dbt.not_null_stg_orders_order_id_customer_id.a094c039ad\", \"alert_class_id\": \"test.test_dbt.not_null_stg_orders_order_id_customer_id.a094c039ad.order_id || customer_id.generic\", \"model_unique_id\": \"model.test_dbt.stg_orders\", \"test_unique_id\": \"test.test_dbt.not_null_stg_orders_order_id_customer_id.a094c039ad\", \"detected_at\": \"2023-08-07T11:56:32\", \"database_name\": \"dbt\", \"schema_name\": \"local_analytics\", \"table_name\": \"stg_orders\", \"column_name\": \"order_id || customer_id\", \"test_type\": \"dbt_test\", \"test_sub_type\": \"generic\", \"test_results_description\": \"Database Error in test not_null_stg_orders_order_id_customer_id (models/staging/models.yml)\\n  operator does not exist: integer || integer\\n  LINE 19: select order_id || customer_id\\n                           ^\\n  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.\", \"owners\": \"[]\", \"tags\": \"[]\", \"test_results_query\": \"\\n    \\n    \\n\\n\\n\\nselect order_id || customer_id\\nfrom \\\"dbt\\\".\\\"local_analytics\\\".\\\"stg_orders\\\"\\nwhere order_id || customer_id is null\\n\\n\\n\", \"test_rows_sample\": null, \"other\": null, \"test_name\": \"not_null_stg_orders_order_id_customer_id\", \"test_short_name\": \"not_null\", \"test_params\": \"{\\\"column_name\\\": \\\"order_id || customer_id\\\", \\\"model\\\": \\\"{{ get_where_subquery(ref('stg_orders')) }}\\\"}\", \"severity\": \"ERROR\", \"test_meta\": null, \"model_meta\": \"{}\", \"suppression_status\": \"pending\", \"sent_at\": null, \"status\": \"error\"}, {\"id\": \"80eeba1e-8527-416a-8d86-c42fc32450ac.test.test_dbt.unique_stg_orders_order_id_customer_id.52431730b9\", \"alert_class_id\": \"test.test_dbt.unique_stg_orders_order_id_customer_id.52431730b9.order_id || customer_id.generic\", \"model_unique_id\": \"model.test_dbt.stg_orders\", \"test_unique_id\": \"test.test_dbt.unique_stg_orders_order_id_customer_id.52431730b9\", \"detected_at\": \"2023-08-07T11:56:32\", \"database_name\": \"dbt\", \"schema_name\": \"local_analytics\", \"table_name\": \"stg_orders\", \"column_name\": \"order_id || customer_id\", \"test_type\": \"dbt_test\", \"test_sub_type\": \"generic\", \"test_results_description\": \"Database Error in test unique_stg_orders_order_id_customer_id (models/staging/models.yml)\\n  operator does not exist: integer || integer\\n  LINE 18:     order_id || customer_id as unique_field,\\n                        ^\\n  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.\", \"owners\": \"[]\", \"tags\": \"[]\", \"test_results_query\": \"\\n    \\n    \\n\\nselect\\n    order_id || customer_id as unique_field,\\n    count(*) as n_records\\n\\nfrom \\\"dbt\\\".\\\"local_analytics\\\".\\\"stg_orders\\\"\\nwhere order_id || customer_id is not null\\ngroup by order_id || customer_id\\nhaving count(*) > 1\\n\\n\\n\", \"test_rows_sample\": null, \"other\": null, \"test_name\": \"unique_stg_orders_order_id_customer_id\", \"test_short_name\": \"unique\", \"test_params\": \"{\\\"column_name\\\": \\\"order_id || customer_id\\\", \\\"model\\\": \\\"{{ get_where_subquery(ref('stg_orders')) }}\\\"}\", \"severity\": \"ERROR\", \"test_meta\": null, \"model_meta\": \"{}\", \"suppression_status\": \"pending\", \"sent_at\": null, \"status\": \"error\"}, {\"id\": \"a30fc06b-d642-44ed-95a6-dfd13be58b84.test.test_dbt.unique_stg_orders_order_id_customer_id.52431730b9\", \"alert_class_id\": \"test.test_dbt.unique_stg_orders_order_id_customer_id.52431730b9.order_id || customer_id.generic\", \"model_unique_id\": \"model.test_dbt.stg_orders\", \"test_unique_id\": \"test.test_dbt.unique_stg_orders_order_id_customer_id.52431730b9\", \"detected_at\": \"2023-08-07T11:47:13\", \"database_name\": \"dbt\", \"schema_name\": \"local_analytics\", \"table_name\": \"stg_orders\", \"column_name\": \"order_id || customer_id\", \"test_type\": \"dbt_test\", \"test_sub_type\": \"generic\", \"test_results_description\": \"Database Error in test unique_stg_orders_order_id_customer_id (models/staging/models.yml)\\n  relation \\\"local_analytics.stg_orders\\\" does not exist\\n  LINE 21: from \\\"dbt\\\".\\\"local_analytics\\\".\\\"stg_orders\\\"\\n                ^\", \"owners\": \"[]\", \"tags\": \"[]\", \"test_results_query\": \"\\n    \\n    \\n\\nselect\\n    order_id || customer_id as unique_field,\\n    count(*) as n_records\\n\\nfrom \\\"dbt\\\".\\\"local_analytics\\\".\\\"stg_orders\\\"\\nwhere order_id || customer_id is not null\\ngroup by order_id || customer_id\\nhaving count(*) > 1\\n\\n\\n\", \"test_rows_sample\": null, \"other\": null, \"test_name\": \"unique_stg_orders_order_id_customer_id\", \"test_short_name\": \"unique\", \"test_params\": \"{\\\"column_name\\\": \\\"order_id || customer_id\\\", \\\"model\\\": \\\"{{ get_where_subquery(ref('stg_orders')) }}\\\"}\", \"severity\": \"ERROR\", \"test_meta\": null, \"model_meta\": \"{}\", \"suppression_status\": \"pending\", \"sent_at\": null, \"status\": \"error\"}, {\"id\": \"a30fc06b-d642-44ed-95a6-dfd13be58b84.test.test_dbt.not_null_stg_orders_order_id_customer_id.a094c039ad\", \"alert_class_id\": \"test.test_dbt.not_null_stg_orders_order_id_customer_id.a094c039ad.order_id || customer_id.generic\", \"model_unique_id\": \"model.test_dbt.stg_orders\", \"test_unique_id\": \"test.test_dbt.not_null_stg_orders_order_id_customer_id.a094c039ad\", \"detected_at\": \"2023-08-07T11:47:13\", \"database_name\": \"dbt\", \"schema_name\": \"local_analytics\", \"table_name\": \"stg_orders\", \"column_name\": \"order_id || customer_id\", \"test_type\": \"dbt_test\", \"test_sub_type\": \"generic\", \"test_results_description\": \"Database Error in test not_null_stg_orders_order_id_customer_id (models/staging/models.yml)\\n  relation \\\"local_analytics.stg_orders\\\" does not exist\\n  LINE 20: from \\\"dbt\\\".\\\"local_analytics\\\".\\\"stg_orders\\\"\\n                ^\", \"owners\": \"[]\", \"tags\": \"[]\", \"test_results_query\": \"\\n    \\n    \\n\\n\\n\\nselect order_id || customer_id\\nfrom \\\"dbt\\\".\\\"local_analytics\\\".\\\"stg_orders\\\"\\nwhere order_id || customer_id is null\\n\\n\\n\", \"test_rows_sample\": null, \"other\": null, \"test_name\": \"not_null_stg_orders_order_id_customer_id\", \"test_short_name\": \"not_null\", \"test_params\": \"{\\\"column_name\\\": \\\"order_id || customer_id\\\", \\\"model\\\": \\\"{{ get_where_subquery(ref('stg_orders')) }}\\\"}\", \"severity\": \"ERROR\", \"test_meta\": null, \"model_meta\": \"{}\", \"suppression_status\": \"pending\", \"sent_at\": null, \"status\": \"error\"}, {\"id\": \"a30fc06b-d642-44ed-95a6-dfd13be58b84.test.test_dbt.not_null_stg_orders_order_id.81cfe2fe64\", \"alert_class_id\": \"test.test_dbt.not_null_stg_orders_order_id.81cfe2fe64.order_id.generic\", \"model_unique_id\": \"model.test_dbt.stg_orders\", \"test_unique_id\": \"test.test_dbt.not_null_stg_orders_order_id.81cfe2fe64\", \"detected_at\": \"2023-08-07T11:47:13\", \"database_name\": \"dbt\", \"schema_name\": \"local_analytics\", \"table_name\": \"stg_orders\", \"column_name\": \"order_id\", \"test_type\": \"dbt_test\", \"test_sub_type\": \"generic\", \"test_results_description\": \"Database Error in test not_null_stg_orders_order_id (models/staging/models.yml)\\n  relation \\\"local_analytics.stg_orders\\\" does not exist\\n  LINE 20: from \\\"dbt\\\".\\\"local_analytics\\\".\\\"stg_orders\\\"\\n                ^\", \"owners\": \"[]\", \"tags\": \"[]\", \"test_results_query\": \"\\n    \\n    \\n\\n\\n\\nselect order_id\\nfrom \\\"dbt\\\".\\\"local_analytics\\\".\\\"stg_orders\\\"\\nwhere order_id is null\\n\\n\\n\", \"test_rows_sample\": null, \"other\": null, \"test_name\": \"not_null_stg_orders_order_id\", \"test_short_name\": \"not_null\", \"test_params\": \"{\\\"column_name\\\": \\\"order_id\\\", \\\"model\\\": \\\"{{ get_where_subquery(ref('stg_orders')) }}\\\"}\", \"severity\": \"ERROR\", \"test_meta\": \"{\\\"description\\\": \\\"This test validates that there are no `null` values present in a column.\\\"}\", \"model_meta\": \"{}\", \"suppression_status\": \"pending\", \"sent_at\": null, \"status\": \"error\"}, {\"id\": \"a30fc06b-d642-44ed-95a6-dfd13be58b84.test.test_dbt.unique_stg_orders_order_id.e3b841c71a\", \"alert_class_id\": \"test.test_dbt.unique_stg_orders_order_id.e3b841c71a.order_id.generic\", \"model_unique_id\": \"model.test_dbt.stg_orders\", \"test_unique_id\": \"test.test_dbt.unique_stg_orders_order_id.e3b841c71a\", \"detected_at\": \"2023-08-07T11:47:13\", \"database_name\": \"dbt\", \"schema_name\": \"local_analytics\", \"table_name\": \"stg_orders\", \"column_name\": \"order_id\", \"test_type\": \"dbt_test\", \"test_sub_type\": \"generic\", \"test_results_description\": \"Database Error in test unique_stg_orders_order_id (models/staging/models.yml)\\n  relation \\\"local_analytics.stg_orders\\\" does not exist\\n  LINE 21: from \\\"dbt\\\".\\\"local_analytics\\\".\\\"stg_orders\\\"\\n                ^\", \"owners\": \"[]\", \"tags\": \"[]\", \"test_results_query\": \"\\n    \\n    \\n\\nselect\\n    order_id as unique_field,\\n    count(*) as n_records\\n\\nfrom \\\"dbt\\\".\\\"local_analytics\\\".\\\"stg_orders\\\"\\nwhere order_id is not null\\ngroup by order_id\\nhaving count(*) > 1\\n\\n\\n\", \"test_rows_sample\": null, \"other\": null, \"test_name\": \"unique_stg_orders_order_id\", \"test_short_name\": \"unique\", \"test_params\": \"{\\\"column_name\\\": \\\"order_id\\\", \\\"model\\\": \\\"{{ get_where_subquery(ref('stg_orders')) }}\\\"}\", \"severity\": \"ERROR\", \"test_meta\": \"{\\\"description\\\": \\\"This test validates that there are no duplicate values present in a field.\\\"}\", \"model_meta\": \"{}\", \"suppression_status\": \"pending\", \"sent_at\": null, \"status\": \"error\"}, {\"id\": \"a30fc06b-d642-44ed-95a6-dfd13be58b84.test.test_dbt.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1\", \"alert_class_id\": \"test.test_dbt.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1.status.generic\", \"model_unique_id\": \"model.test_dbt.stg_orders\", \"test_unique_id\": \"test.test_dbt.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1\", \"detected_at\": \"2023-08-07T11:47:13\", \"database_name\": \"dbt\", \"schema_name\": \"local_analytics\", \"table_name\": \"stg_orders\", \"column_name\": \"status\", \"test_type\": \"dbt_test\", \"test_sub_type\": \"generic\", \"test_results_description\": \"Database Error in test accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed (models/staging/models.yml)\\n  relation \\\"local_analytics.stg_orders\\\" does not exist\\n  LINE 23:     from \\\"dbt\\\".\\\"local_analytics\\\".\\\"stg_orders\\\"\\n                    ^\", \"owners\": \"[]\", \"tags\": \"[]\", \"test_results_query\": \"\\n    \\n    \\n\\nwith all_values as (\\n\\n    select\\n        status as value_field,\\n        count(*) as n_records\\n\\n    from \\\"dbt\\\".\\\"local_analytics\\\".\\\"stg_orders\\\"\\n    group by status\\n\\n)\\n\\nselect *\\nfrom all_values\\nwhere value_field not in (\\n    'completed','shipped','returned','return_pending','placed'\\n)\\n\\n\\n\", \"test_rows_sample\": null, \"other\": null, \"test_name\": \"accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed\", \"test_short_name\": \"accepted_values\", \"test_params\": \"{\\\"values\\\": [\\\"completed\\\", \\\"shipped\\\", \\\"returned\\\", \\\"return_pending\\\", \\\"placed\\\"], \\\"column_name\\\": \\\"status\\\", \\\"model\\\": \\\"{{ get_where_subquery(ref('stg_orders')) }}\\\"}\", \"severity\": \"ERROR\", \"test_meta\": \"{\\\"description\\\": \\\"This test validates that all of the values in a column are present in a supplied list of `values`. If any values other than those provided in the list are present, then the test will fail.\\\"}\", \"model_meta\": \"{}\", \"suppression_status\": \"pending\", \"sent_at\": null, \"status\": \"error\"}, {\"id\": \"a30fc06b-d642-44ed-95a6-dfd13be58b84.test.test_dbt.not_null_dim_customers_customer_id.dd91cd1c8d\", \"alert_class_id\": \"test.test_dbt.not_null_dim_customers_customer_id.dd91cd1c8d.customer_id.generic\", \"model_unique_id\": \"model.test_dbt.dim_customers\", \"test_unique_id\": \"test.test_dbt.not_null_dim_customers_customer_id.dd91cd1c8d\", \"detected_at\": \"2023-08-07T11:47:13\", \"database_name\": \"dbt\", \"schema_name\": \"local_analytics\", \"table_name\": \"dim_customers\", \"column_name\": \"customer_id\", \"test_type\": \"dbt_test\", \"test_sub_type\": \"generic\", \"test_results_description\": \"Database Error in test not_null_dim_customers_customer_id (models/marts/marts.yml)\\n  relation \\\"local_analytics.dim_customers\\\" does not exist\\n  LINE 20: from \\\"dbt\\\".\\\"local_analytics\\\".\\\"dim_customers\\\"\\n                ^\", \"owners\": \"[]\", \"tags\": \"[]\", \"test_results_query\": \"\\n    \\n    \\n\\n\\n\\nselect customer_id\\nfrom \\\"dbt\\\".\\\"local_analytics\\\".\\\"dim_customers\\\"\\nwhere customer_id is null\\n\\n\\n\", \"test_rows_sample\": null, \"other\": null, \"test_name\": \"not_null_dim_customers_customer_id\", \"test_short_name\": \"not_null\", \"test_params\": \"{\\\"column_name\\\": \\\"customer_id\\\", \\\"model\\\": \\\"{{ get_where_subquery(ref('dim_customers')) }}\\\"}\", \"severity\": \"ERROR\", \"test_meta\": \"{\\\"description\\\": \\\"This test validates that there are no `null` values present in a column.\\\"}\", \"model_meta\": \"{}\", \"suppression_status\": \"pending\", \"sent_at\": null, \"status\": \"error\"}, {\"id\": \"a30fc06b-d642-44ed-95a6-dfd13be58b84.test.test_dbt.unique_dim_customers_customer_id.15c9f1e2fd\", \"alert_class_id\": \"test.test_dbt.unique_dim_customers_customer_id.15c9f1e2fd.customer_id.generic\", \"model_unique_id\": \"model.test_dbt.dim_customers\", \"test_unique_id\": \"test.test_dbt.unique_dim_customers_customer_id.15c9f1e2fd\", \"detected_at\": \"2023-08-07T11:47:13\", \"database_name\": \"dbt\", \"schema_name\": \"local_analytics\", \"table_name\": \"dim_customers\", \"column_name\": \"customer_id\", \"test_type\": \"dbt_test\", \"test_sub_type\": \"generic\", \"test_results_description\": \"Database Error in test unique_dim_customers_customer_id (models/marts/marts.yml)\\n  relation \\\"local_analytics.dim_customers\\\" does not exist\\n  LINE 21: from \\\"dbt\\\".\\\"local_analytics\\\".\\\"dim_customers\\\"\\n                ^\", \"owners\": \"[]\", \"tags\": \"[]\", \"test_results_query\": \"\\n    \\n    \\n\\nselect\\n    customer_id as unique_field,\\n    count(*) as n_records\\n\\nfrom \\\"dbt\\\".\\\"local_analytics\\\".\\\"dim_customers\\\"\\nwhere customer_id is not null\\ngroup by customer_id\\nhaving count(*) > 1\\n\\n\\n\", \"test_rows_sample\": null, \"other\": null, \"test_name\": \"unique_dim_customers_customer_id\", \"test_short_name\": \"unique\", \"test_params\": \"{\\\"column_name\\\": \\\"customer_id\\\", \\\"model\\\": \\\"{{ get_where_subquery(ref('dim_customers')) }}\\\"}\", \"severity\": \"ERROR\", \"test_meta\": \"{\\\"description\\\": \\\"This test validates that there are no duplicate values present in a field.\\\"}\", \"model_meta\": \"{}\", \"suppression_status\": \"pending\", \"sent_at\": null, \"status\": \"error\"}, {\"id\": \"a30fc06b-d642-44ed-95a6-dfd13be58b84.test.test_dbt.dbt_utils_cardinality_equality_dim_customers_customer_id__customer_id__ref_stg_customers_.cdf22e9197\", \"alert_class_id\": \"test.test_dbt.dbt_utils_cardinality_equality_dim_customers_customer_id__customer_id__ref_stg_customers_.cdf22e9197.customer_id.generic\", \"model_unique_id\": \"model.test_dbt.dim_customers\", \"test_unique_id\": \"test.test_dbt.dbt_utils_cardinality_equality_dim_customers_customer_id__customer_id__ref_stg_customers_.cdf22e9197\", \"detected_at\": \"2023-08-07T11:47:13\", \"database_name\": \"dbt\", \"schema_name\": \"local_analytics\", \"table_name\": \"dim_customers\", \"column_name\": \"customer_id\", \"test_type\": \"dbt_test\", \"test_sub_type\": \"generic\", \"test_results_description\": \"Database Error in test dbt_utils_cardinality_equality_dim_customers_customer_id__customer_id__ref_stg_customers_ (models/marts/marts.yml)\\n  relation \\\"local_analytics.dim_customers\\\" does not exist\\n  LINE 22: from \\\"dbt\\\".\\\"local_analytics\\\".\\\"dim_customers\\\"\\n                ^\", \"owners\": \"[]\", \"tags\": \"[\\\"critical-tag\\\"]\", \"test_results_query\": \"\\n\\n\\n\\n\\nwith table_a as (\\nselect\\n  customer_id,\\n  count(*) as num_rows\\nfrom \\\"dbt\\\".\\\"local_analytics\\\".\\\"dim_customers\\\"\\ngroup by customer_id\\n),\\n\\ntable_b as (\\nselect\\n  customer_id,\\n  count(*) as num_rows\\nfrom \\\"dbt\\\".\\\"local_analytics\\\".\\\"stg_customers\\\"\\ngroup by customer_id\\n),\\n\\nexcept_a as (\\n  select *\\n  from table_a\\n  \\n\\n    except\\n\\n\\n  select *\\n  from table_b\\n),\\n\\nexcept_b as (\\n  select *\\n  from table_b\\n  \\n\\n    except\\n\\n\\n  select *\\n  from table_a\\n),\\n\\nunioned as (\\n  select *\\n  from except_a\\n  union all\\n  select *\\n  from except_b\\n)\\n\\nselect *\\nfrom unioned\\n\\n\", \"test_rows_sample\": null, \"other\": null, \"test_name\": \"dbt_utils_cardinality_equality_dim_customers_customer_id__customer_id__ref_stg_customers_\", \"test_short_name\": \"cardinality_equality\", \"test_params\": \"{\\\"field\\\": \\\"customer_id\\\", \\\"to\\\": \\\"ref('stg_customers')\\\", \\\"column_name\\\": \\\"customer_id\\\", \\\"model\\\": \\\"{{ get_where_subquery(ref('dim_customers')) }}\\\"}\", \"severity\": \"ERROR\", \"test_meta\": \"{}\", \"model_meta\": \"{}\", \"suppression_status\": \"pending\", \"sent_at\": null, \"status\": \"error\"}, {\"id\": \"a30fc06b-d642-44ed-95a6-dfd13be58b84.test.test_dbt.assert_amount_average_is_greater_than_one\", \"alert_class_id\": \"test.test_dbt.assert_amount_average_is_greater_than_one.None.singular\", \"model_unique_id\": \"model.test_dbt.fct_orders\", \"test_unique_id\": \"test.test_dbt.assert_amount_average_is_greater_than_one\", \"detected_at\": \"2023-08-07T11:47:13\", \"database_name\": \"dbt\", \"schema_name\": \"local_analytics\", \"table_name\": \"fct_orders\", \"column_name\": null, \"test_type\": \"dbt_test\", \"test_sub_type\": \"singular\", \"test_results_description\": \"Database Error in test assert_amount_average_is_greater_than_one (tests/assert_amount_average_is_greater_than_one.sql)\\n  relation \\\"local_analytics.fct_orders\\\" does not exist\\n  LINE 16: from \\\"dbt\\\".\\\"local_analytics\\\".\\\"fct_orders\\\"\\n                ^\", \"owners\": \"[]\", \"tags\": \"[]\", \"test_results_query\": \"select\\n    customer_id, \\n    avg(amount) as average_amount\\nfrom \\\"dbt\\\".\\\"local_analytics\\\".\\\"fct_orders\\\"\\ngroup by 1\\nhaving count(customer_id) > 1 and avg(amount) < 1\", \"test_rows_sample\": null, \"other\": null, \"test_name\": \"assert_amount_average_is_greater_than_one\", \"test_short_name\": \"assert_amount_average_is_greater_than_one\", \"test_params\": \"{}\", \"severity\": \"ERROR\", \"test_meta\": \"{}\", \"model_meta\": \"{}\", \"suppression_status\": \"pending\", \"sent_at\": null, \"status\": \"error\"}, {\"id\": \"a30fc06b-d642-44ed-95a6-dfd13be58b84.test.test_dbt.assert_total_payment_amount_is_positive\", \"alert_class_id\": \"test.test_dbt.assert_total_payment_amount_is_positive.None.singular\", \"model_unique_id\": \"model.test_dbt.fct_orders\", \"test_unique_id\": \"test.test_dbt.assert_total_payment_amount_is_positive\", \"detected_at\": \"2023-08-07T11:47:13\", \"database_name\": \"dbt\", \"schema_name\": \"local_analytics\", \"table_name\": \"fct_orders\", \"column_name\": null, \"test_type\": \"dbt_test\", \"test_sub_type\": \"singular\", \"test_results_description\": \"Database Error in test assert_total_payment_amount_is_positive (tests/assert_total_payment_amount_is_positive.sql)\\n  relation \\\"local_analytics.fct_orders\\\" does not exist\\n  LINE 16: from \\\"dbt\\\".\\\"local_analytics\\\".\\\"fct_orders\\\"\\n                ^\", \"owners\": \"[]\", \"tags\": \"[]\", \"test_results_query\": \"select\\n    order_id, \\n    amount\\nfrom \\\"dbt\\\".\\\"local_analytics\\\".\\\"fct_orders\\\"\\nwhere amount < 0\", \"test_rows_sample\": null, \"other\": null, \"test_name\": \"assert_total_payment_amount_is_positive\", \"test_short_name\": \"assert_total_payment_amount_is_positive\", \"test_params\": \"{}\", \"severity\": \"ERROR\", \"test_meta\": \"{}\", \"model_meta\": \"{}\", \"suppression_status\": \"pending\", \"sent_at\": null, \"status\": \"error\"}, {\"id\": \"a30fc06b-d642-44ed-95a6-dfd13be58b84.test.test_dbt.average_dollars_spent_greater_than_one_fct_orders_amount__customer_id.b5af33deeb\", \"alert_class_id\": \"test.test_dbt.average_dollars_spent_greater_than_one_fct_orders_amount__customer_id.b5af33deeb.amount.generic\", \"model_unique_id\": \"model.test_dbt.fct_orders\", \"test_unique_id\": \"test.test_dbt.average_dollars_spent_greater_than_one_fct_orders_amount__customer_id.b5af33deeb\", \"detected_at\": \"2023-08-07T11:47:13\", \"database_name\": \"dbt\", \"schema_name\": \"local_analytics\", \"table_name\": \"fct_orders\", \"column_name\": \"amount\", \"test_type\": \"dbt_test\", \"test_sub_type\": \"generic\", \"test_results_description\": \"Database Error in test average_dollars_spent_greater_than_one_fct_orders_amount__customer_id (models/marts/marts.yml)\\n  relation \\\"local_analytics.fct_orders\\\" does not exist\\n  LINE 19: from \\\"dbt\\\".\\\"local_analytics\\\".\\\"fct_orders\\\"\\n                ^\", \"owners\": \"[]\", \"tags\": \"[]\", \"test_results_query\": \"\\n\\nselect \\n    customer_id,\\n    avg( amount ) as average_amount\\n\\nfrom \\\"dbt\\\".\\\"local_analytics\\\".\\\"fct_orders\\\"\\ngroup by 1\\nhaving avg( amount ) < 1\\n\\n\\n\", \"test_rows_sample\": null, \"other\": null, \"test_name\": \"average_dollars_spent_greater_than_one_fct_orders_amount__customer_id\", \"test_short_name\": \"average_dollars_spent_greater_than_one\", \"test_params\": \"{\\\"group_by_column\\\": \\\"customer_id\\\", \\\"column_name\\\": \\\"amount\\\", \\\"model\\\": \\\"{{ get_where_subquery(ref('fct_orders')) }}\\\"}\", \"severity\": \"ERROR\", \"test_meta\": \"{}\", \"model_meta\": \"{}\", \"suppression_status\": \"pending\", \"sent_at\": null, \"status\": \"error\"}, {\"id\": \"ae8cffa4-c04f-4ee8-a58d-5a263fe9e884.test.test_dbt.source_unique_stripe_payment_id.3b7989ce64\", \"alert_class_id\": \"test.test_dbt.source_unique_stripe_payment_id.3b7989ce64.id.generic\", \"model_unique_id\": \"source.test_dbt.stripe.payment\", \"test_unique_id\": \"test.test_dbt.source_unique_stripe_payment_id.3b7989ce64\", \"detected_at\": \"2023-08-07T11:57:54\", \"database_name\": \"dbt\", \"schema_name\": \"local_analytics\", \"table_name\": \"payment\", \"column_name\": \"id\", \"test_type\": \"dbt_test\", \"test_sub_type\": \"generic\", \"test_results_description\": \"Database Error in test source_unique_stripe_payment_id (models/staging/sources.yml)\\n  column \\\"id\\\" does not exist\\n  LINE 18:     id as unique_field,\\n               ^\", \"owners\": \"[]\", \"tags\": \"[]\", \"test_results_query\": \"\\n    \\n    \\n\\nselect\\n    id as unique_field,\\n    count(*) as n_records\\n\\nfrom \\\"dbt\\\".\\\"local_analytics\\\".\\\"payment\\\"\\nwhere id is not null\\ngroup by id\\nhaving count(*) > 1\\n\\n\\n\", \"test_rows_sample\": null, \"other\": null, \"test_name\": \"source_unique_stripe_payment_id\", \"test_short_name\": \"unique\", \"test_params\": \"{\\\"column_name\\\": \\\"id\\\", \\\"model\\\": \\\"{{ get_where_subquery(source('stripe', 'payment')) }}\\\"}\", \"severity\": \"ERROR\", \"test_meta\": null, \"model_meta\": \"{}\", \"suppression_status\": \"pending\", \"sent_at\": null, \"status\": \"error\"}, {\"id\": \"80eeba1e-8527-416a-8d86-c42fc32450ac.test.test_dbt.source_unique_stripe_payment_id.3b7989ce64\", \"alert_class_id\": \"test.test_dbt.source_unique_stripe_payment_id.3b7989ce64.id.generic\", \"model_unique_id\": \"source.test_dbt.stripe.payment\", \"test_unique_id\": \"test.test_dbt.source_unique_stripe_payment_id.3b7989ce64\", \"detected_at\": \"2023-08-07T11:56:32\", \"database_name\": \"dbt\", \"schema_name\": \"local_analytics\", \"table_name\": \"payment\", \"column_name\": \"id\", \"test_type\": \"dbt_test\", \"test_sub_type\": \"generic\", \"test_results_description\": \"Database Error in test source_unique_stripe_payment_id (models/staging/sources.yml)\\n  column \\\"id\\\" does not exist\\n  LINE 18:     id as unique_field,\\n               ^\", \"owners\": \"[]\", \"tags\": \"[]\", \"test_results_query\": \"\\n    \\n    \\n\\nselect\\n    id as unique_field,\\n    count(*) as n_records\\n\\nfrom \\\"dbt\\\".\\\"local_analytics\\\".\\\"payment\\\"\\nwhere id is not null\\ngroup by id\\nhaving count(*) > 1\\n\\n\\n\", \"test_rows_sample\": null, \"other\": null, \"test_name\": \"source_unique_stripe_payment_id\", \"test_short_name\": \"unique\", \"test_params\": \"{\\\"column_name\\\": \\\"id\\\", \\\"model\\\": \\\"{{ get_where_subquery(source('stripe', 'payment')) }}\\\"}\", \"severity\": \"ERROR\", \"test_meta\": null, \"model_meta\": \"{}\", \"suppression_status\": \"pending\", \"sent_at\": null, \"status\": \"error\"}, {\"id\": \"a30fc06b-d642-44ed-95a6-dfd13be58b84.test.test_dbt.source_unique_stripe_payment_id.3b7989ce64\", \"alert_class_id\": \"test.test_dbt.source_unique_stripe_payment_id.3b7989ce64.id.generic\", \"model_unique_id\": \"source.test_dbt.stripe.payment\", \"test_unique_id\": \"test.test_dbt.source_unique_stripe_payment_id.3b7989ce64\", \"detected_at\": \"2023-08-07T11:47:13\", \"database_name\": \"dbt\", \"schema_name\": \"local_analytics\", \"table_name\": \"payment\", \"column_name\": \"id\", \"test_type\": \"dbt_test\", \"test_sub_type\": \"generic\", \"test_results_description\": \"Database Error in test source_unique_stripe_payment_id (models/staging/sources.yml)\\n  relation \\\"local_analytics.payment\\\" does not exist\\n  LINE 21: from \\\"dbt\\\".\\\"local_analytics\\\".\\\"payment\\\"\\n                ^\", \"owners\": \"[]\", \"tags\": \"[]\", \"test_results_query\": \"\\n    \\n    \\n\\nselect\\n    id as unique_field,\\n    count(*) as n_records\\n\\nfrom \\\"dbt\\\".\\\"local_analytics\\\".\\\"payment\\\"\\nwhere id is not null\\ngroup by id\\nhaving count(*) > 1\\n\\n\\n\", \"test_rows_sample\": null, \"other\": null, \"test_name\": \"source_unique_stripe_payment_id\", \"test_short_name\": \"unique\", \"test_params\": \"{\\\"column_name\\\": \\\"id\\\", \\\"model\\\": \\\"{{ get_where_subquery(source('stripe', 'payment')) }}\\\"}\", \"severity\": \"ERROR\", \"test_meta\": null, \"model_meta\": \"{}\", \"suppression_status\": \"pending\", \"sent_at\": null, \"status\": \"error\"}]"}, "info": {"category": "", "code": "I062", "extra": {}, "invocation_id": "63ea8265-aefd-451a-90a4-e56fd051fcdd", "level": "info", "msg": "Elementary: [{\"id\": \"ccdeb6aa-962c-4b1d-84f4-5b2a15d4522c.test.test_dbt.failing_test_stg_customers_last_name_last_name.847ec3eec4\", \"alert_class_id\": \"test.test_dbt.failing_test_stg_customers_last_name_last_name.847ec3eec4.last_name || last_name.generic\", \"model_unique_id\": \"model.test_dbt.stg_customers\", \"test_unique_id\": \"test.test_dbt.failing_test_stg_customers_last_name_last_name.847ec3eec4\", \"detected_at\": \"2023-08-08T12:56:45\", \"database_name\": \"dbt\", \"schema_name\": \"local_analytics\", \"table_name\": \"stg_customers\", \"column_name\": \"last_name || last_name\", \"test_type\": \"dbt_test\", \"test_sub_type\": \"generic\", \"test_results_description\": \"Got 100 results, configured to fail if != 0\", \"owners\": \"[]\", \"tags\": \"[\\\"critical-tag\\\"]\", \"test_results_query\": \"\\nselect last_name || last_name from \\\"dbt\\\".\\\"local_analytics\\\".\\\"stg_customers\\\"\\n\", \"test_rows_sample\": [{\"?column?\": \"P.P.\"}, {\"?column?\": \"M.M.\"}, {\"?column?\": \"P.P.\"}, {\"?column?\": \"C.C.\"}, {\"?column?\": \"R.R.\"}], \"other\": null, \"test_name\": \"failing_test_stg_customers_last_name_last_name\", \"test_short_name\": \"failing_test\", \"test_params\": \"{\\\"column_name\\\": \\\"last_name || last_name\\\", \\\"model\\\": \\\"{{ get_where_subquery(ref('stg_customers')) }}\\\"}\", \"severity\": \"ERROR\", \"test_meta\": \"{}\", \"model_meta\": \"{}\", \"suppression_status\": \"pending\", \"sent_at\": null, \"status\": \"fail\"}, {\"id\": \"5e2e388e-e883-4989-8f54-0a5225805882.test.test_dbt.failing_test_stg_customers_last_name_last_name.847ec3eec4\", \"alert_class_id\": \"test.test_dbt.failing_test_stg_customers_last_name_last_name.847ec3eec4.last_name || last_name.generic\", \"model_unique_id\": \"model.test_dbt.stg_customers\", \"test_unique_id\": \"test.test_dbt.failing_test_stg_customers_last_name_last_name.847ec3eec4\", \"detected_at\": \"2023-08-07T12:29:09\", \"database_name\": \"dbt\", \"schema_name\": \"local_analytics\", \"table_name\": \"stg_customers\", \"column_name\": \"last_name || last_name\", \"test_type\": \"dbt_test\", \"test_sub_type\": \"generic\", \"test_results_description\": \"Got 100 results, configured to fail if != 0\", \"owners\": \"[]\", \"tags\": \"[\\\"critical-tag\\\"]\", \"test_results_query\": \"\\nselect last_name || last_name from \\\"dbt\\\".\\\"local_analytics\\\".\\\"stg_customers\\\"\\n\", \"test_rows_sample\": [], \"other\": null, \"test_name\": \"failing_test_stg_customers_last_name_last_name\", \"test_short_name\": \"failing_test\", \"test_params\": \"{\\\"column_name\\\": \\\"last_name || last_name\\\", \\\"model\\\": \\\"{{ get_where_subquery(ref('stg_customers')) }}\\\"}\", \"severity\": \"ERROR\", \"test_meta\": \"{}\", \"model_meta\": \"{}\", \"suppression_status\": \"pending\", \"sent_at\": null, \"status\": \"fail\"}, {\"id\": \"f9f8b46b-9ba6-4db8-b9a8-20a04cd01d5e.test.test_dbt.failing_test_stg_customers_last_name_last_name.847ec3eec4\", \"alert_class_id\": \"test.test_dbt.failing_test_stg_customers_last_name_last_name.847ec3eec4.last_name || last_name.generic\", \"model_unique_id\": \"model.test_dbt.stg_customers\", \"test_unique_id\": \"test.test_dbt.failing_test_stg_customers_last_name_last_name.847ec3eec4\", \"detected_at\": \"2023-08-07T12:26:54\", \"database_name\": \"dbt\", \"schema_name\": \"local_analytics\", \"table_name\": \"stg_customers\", \"column_name\": \"last_name || last_name\", \"test_type\": \"dbt_test\", \"test_sub_type\": \"generic\", \"test_results_description\": \"Got 100 results, configured to fail if != 0\", \"owners\": \"[]\", \"tags\": \"[\\\"critical-tag\\\"]\", \"test_results_query\": \"\\nselect last_name || last_name from \\\"dbt\\\".\\\"local_analytics\\\".\\\"stg_customers\\\"\\n\", \"test_rows_sample\": [], \"other\": null, \"test_name\": \"failing_test_stg_customers_last_name_last_name\", \"test_short_name\": \"failing_test\", \"test_params\": \"{\\\"column_name\\\": \\\"last_name || last_name\\\", \\\"model\\\": \\\"{{ get_where_subquery(ref('stg_customers')) }}\\\"}\", \"severity\": \"ERROR\", \"test_meta\": \"{}\", \"model_meta\": \"{}\", \"suppression_status\": \"pending\", \"sent_at\": null, \"status\": \"fail\"}, {\"id\": \"5ae5c1b9-bb50-4899-8860-56bae80936b6.test.test_dbt.failing_test_stg_customers_last_name_last_name.847ec3eec4\", \"alert_class_id\": \"test.test_dbt.failing_test_stg_customers_last_name_last_name.847ec3eec4.last_name || last_name.generic\", \"model_unique_id\": \"model.test_dbt.stg_customers\", \"test_unique_id\": \"test.test_dbt.failing_test_stg_customers_last_name_last_name.847ec3eec4\", \"detected_at\": \"2023-08-07T12:19:34\", \"database_name\": \"dbt\", \"schema_name\": \"local_analytics\", \"table_name\": \"stg_customers\", \"column_name\": \"last_name || last_name\", \"test_type\": \"dbt_test\", \"test_sub_type\": \"generic\", \"test_results_description\": \"Got 100 results, configured to fail if != 0\", \"owners\": \"[]\", \"tags\": \"[\\\"critical-tag\\\"]\", \"test_results_query\": \"\\nselect last_name || last_name from \\\"dbt\\\".\\\"local_analytics\\\".\\\"stg_customers\\\"\\n\", \"test_rows_sample\": [], \"other\": null, \"test_name\": \"failing_test_stg_customers_last_name_last_name\", \"test_short_name\": \"failing_test\", \"test_params\": \"{\\\"column_name\\\": \\\"last_name || last_name\\\", \\\"model\\\": \\\"{{ get_where_subquery(ref('stg_customers')) }}\\\"}\", \"severity\": \"ERROR\", \"test_meta\": \"{}\", \"model_meta\": \"{}\", \"suppression_status\": \"pending\", \"sent_at\": null, \"status\": \"fail\"}, {\"id\": \"ce2e4bf3-1071-4144-a060-4cbfc0edb4ff.test.test_dbt.failing_test_stg_customers_last_name_last_name.847ec3eec4\", \"alert_class_id\": \"test.test_dbt.failing_test_stg_customers_last_name_last_name.847ec3eec4.last_name || last_name.generic\", \"model_unique_id\": \"model.test_dbt.stg_customers\", \"test_unique_id\": \"test.test_dbt.failing_test_stg_customers_last_name_last_name.847ec3eec4\", \"detected_at\": \"2023-08-07T12:08:15\", \"database_name\": \"dbt\", \"schema_name\": \"local_analytics\", \"table_name\": \"stg_customers\", \"column_name\": \"last_name || last_name\", \"test_type\": \"dbt_test\", \"test_sub_type\": \"generic\", \"test_results_description\": \"Got 100 results, configured to fail if != 0\", \"owners\": \"[]\", \"tags\": \"[\\\"critical-tag\\\"]\", \"test_results_query\": \"\\nselect last_name || last_name from \\\"dbt\\\".\\\"local_analytics\\\".\\\"stg_customers\\\"\\n\", \"test_rows_sample\": [], \"other\": null, \"test_name\": \"failing_test_stg_customers_last_name_last_name\", \"test_short_name\": \"failing_test\", \"test_params\": \"{\\\"column_name\\\": \\\"last_name || last_name\\\", \\\"model\\\": \\\"{{ get_where_subquery(ref('stg_customers')) }}\\\"}\", \"severity\": \"ERROR\", \"test_meta\": \"{}\", \"model_meta\": \"{}\", \"suppression_status\": \"pending\", \"sent_at\": null, \"status\": \"fail\"}, {\"id\": \"82641d52-4826-40cf-994d-7339c5303164.test.test_dbt.failing_test_stg_customers_last_name_last_name.847ec3eec4\", \"alert_class_id\": \"test.test_dbt.failing_test_stg_customers_last_name_last_name.847ec3eec4.last_name || last_name.generic\", \"model_unique_id\": \"model.test_dbt.stg_customers\", \"test_unique_id\": \"test.test_dbt.failing_test_stg_customers_last_name_last_name.847ec3eec4\", \"detected_at\": \"2023-08-07T12:07:58\", \"database_name\": \"dbt\", \"schema_name\": \"local_analytics\", \"table_name\": \"stg_customers\", \"column_name\": \"last_name || last_name\", \"test_type\": \"dbt_test\", \"test_sub_type\": \"generic\", \"test_results_description\": \"Database Error in test failing_test_stg_customers_last_name_last_name (models/staging/models.yml)\\n  column \\\"column_name\\\" does not exist\\n  LINE 14: select column_name from \\\"dbt\\\".\\\"local_analytics\\\".\\\"stg_custome...\\n                  ^\", \"owners\": \"[]\", \"tags\": \"[\\\"critical-tag\\\"]\", \"test_results_query\": \"\\nselect column_name from \\\"dbt\\\".\\\"local_analytics\\\".\\\"stg_customers\\\"\\n\", \"test_rows_sample\": null, \"other\": null, \"test_name\": \"failing_test_stg_customers_last_name_last_name\", \"test_short_name\": \"failing_test\", \"test_params\": \"{\\\"column_name\\\": \\\"last_name || last_name\\\", \\\"model\\\": \\\"{{ get_where_subquery(ref('stg_customers')) }}\\\"}\", \"severity\": \"ERROR\", \"test_meta\": \"{}\", \"model_meta\": \"{}\", \"suppression_status\": \"pending\", \"sent_at\": null, \"status\": \"error\"}, {\"id\": \"40ac6f6e-ca0b-4bc2-bd48-854f63035b55.test.test_dbt.unique_stg_customers_last_name_last_name.0845e13bad\", \"alert_class_id\": \"test.test_dbt.unique_stg_customers_last_name_last_name.0845e13bad.last_name || last_name.generic\", \"model_unique_id\": \"model.test_dbt.stg_customers\", \"test_unique_id\": \"test.test_dbt.unique_stg_customers_last_name_last_name.0845e13bad\", \"detected_at\": \"2023-08-07T12:00:30\", \"database_name\": \"dbt\", \"schema_name\": \"local_analytics\", \"table_name\": \"stg_customers\", \"column_name\": \"last_name || last_name\", \"test_type\": \"dbt_test\", \"test_sub_type\": \"generic\", \"test_results_description\": \"Got 17 results, configured to fail if != 0\", \"owners\": \"[]\", \"tags\": \"[\\\"critical-tag\\\"]\", \"test_results_query\": \"\\n    \\n    \\n\\nselect\\n    last_name || last_name as unique_field,\\n    count(*) as n_records\\n\\nfrom \\\"dbt\\\".\\\"local_analytics\\\".\\\"stg_customers\\\"\\nwhere last_name || last_name is not null\\ngroup by last_name || last_name\\nhaving count(*) > 1\\n\\n\\n\", \"test_rows_sample\": [], \"other\": null, \"test_name\": \"unique_stg_customers_last_name_last_name\", \"test_short_name\": \"unique\", \"test_params\": \"{\\\"column_name\\\": \\\"last_name || last_name\\\", \\\"model\\\": \\\"{{ get_where_subquery(ref('stg_customers')) }}\\\"}\", \"severity\": \"ERROR\", \"test_meta\": null, \"model_meta\": \"{}\", \"suppression_status\": \"pending\", \"sent_at\": null, \"status\": \"fail\"}, {\"id\": \"9a47e226-16da-4111-bd02-ee802a0af48c.test.test_dbt.unique_stg_customers_last_name_last_name.0845e13bad\", \"alert_class_id\": \"test.test_dbt.unique_stg_customers_last_name_last_name.0845e13bad.last_name || last_name.generic\", \"model_unique_id\": \"model.test_dbt.stg_customers\", \"test_unique_id\": \"test.test_dbt.unique_stg_customers_last_name_last_name.0845e13bad\", \"detected_at\": \"2023-08-07T11:59:41\", \"database_name\": \"dbt\", \"schema_name\": \"local_analytics\", \"table_name\": \"stg_customers\", \"column_name\": \"last_name || last_name\", \"test_type\": \"dbt_test\", \"test_sub_type\": \"generic\", \"test_results_description\": \"Got 17 results, configured to fail if != 0\", \"owners\": \"[]\", \"tags\": \"[\\\"critical-tag\\\"]\", \"test_results_query\": \"\\n    \\n    \\n\\nselect\\n    last_name || last_name as unique_field,\\n    count(*) as n_records\\n\\nfrom \\\"dbt\\\".\\\"local_analytics\\\".\\\"stg_customers\\\"\\nwhere last_name || last_name is not null\\ngroup by last_name || last_name\\nhaving count(*) > 1\\n\\n\\n\", \"test_rows_sample\": [], \"other\": null, \"test_name\": \"unique_stg_customers_last_name_last_name\", \"test_short_name\": \"unique\", \"test_params\": \"{\\\"column_name\\\": \\\"last_name || last_name\\\", \\\"model\\\": \\\"{{ get_where_subquery(ref('stg_customers')) }}\\\"}\", \"severity\": \"ERROR\", \"test_meta\": null, \"model_meta\": \"{}\", \"suppression_status\": \"pending\", \"sent_at\": null, \"status\": \"fail\"}, {\"id\": \"a30fc06b-d642-44ed-95a6-dfd13be58b84.test.test_dbt.unique_stg_customers_customer_id.c7614daada\", \"alert_class_id\": \"test.test_dbt.unique_stg_customers_customer_id.c7614daada.customer_id.generic\", \"model_unique_id\": \"model.test_dbt.stg_customers\", \"test_unique_id\": \"test.test_dbt.unique_stg_customers_customer_id.c7614daada\", \"detected_at\": \"2023-08-07T11:47:13\", \"database_name\": \"dbt\", \"schema_name\": \"local_analytics\", \"table_name\": \"stg_customers\", \"column_name\": \"customer_id\", \"test_type\": \"dbt_test\", \"test_sub_type\": \"generic\", \"test_results_description\": \"Database Error in test unique_stg_customers_customer_id (models/staging/models.yml)\\n  relation \\\"local_analytics.stg_customers\\\" does not exist\\n  LINE 21: from \\\"dbt\\\".\\\"local_analytics\\\".\\\"stg_customers\\\"\\n                ^\", \"owners\": \"[]\", \"tags\": \"[\\\"critical-tag\\\"]\", \"test_results_query\": \"\\n    \\n    \\n\\nselect\\n    customer_id as unique_field,\\n    count(*) as n_records\\n\\nfrom \\\"dbt\\\".\\\"local_analytics\\\".\\\"stg_customers\\\"\\nwhere customer_id is not null\\ngroup by customer_id\\nhaving count(*) > 1\\n\\n\\n\", \"test_rows_sample\": null, \"other\": null, \"test_name\": \"unique_stg_customers_customer_id\", \"test_short_name\": \"unique\", \"test_params\": \"{\\\"column_name\\\": \\\"customer_id\\\", \\\"model\\\": \\\"{{ get_where_subquery(ref('stg_customers')) }}\\\"}\", \"severity\": \"ERROR\", \"test_meta\": \"{\\\"description\\\": \\\"This test validates that there are no duplicate values present in a field.\\\"}\", \"model_meta\": \"{}\", \"suppression_status\": \"pending\", \"sent_at\": null, \"status\": \"error\"}, {\"id\": \"a30fc06b-d642-44ed-95a6-dfd13be58b84.test.test_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa\", \"alert_class_id\": \"test.test_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa.customer_id.generic\", \"model_unique_id\": \"model.test_dbt.stg_customers\", \"test_unique_id\": \"test.test_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa\", \"detected_at\": \"2023-08-07T11:47:13\", \"database_name\": \"dbt\", \"schema_name\": \"local_analytics\", \"table_name\": \"stg_customers\", \"column_name\": \"customer_id\", \"test_type\": \"dbt_test\", \"test_sub_type\": \"generic\", \"test_results_description\": \"Database Error in test not_null_stg_customers_customer_id (models/staging/models.yml)\\n  relation \\\"local_analytics.stg_customers\\\" does not exist\\n  LINE 20: from \\\"dbt\\\".\\\"local_analytics\\\".\\\"stg_customers\\\"\\n                ^\", \"owners\": \"[]\", \"tags\": \"[\\\"critical-tag\\\"]\", \"test_results_query\": \"\\n    \\n    \\n\\n\\n\\nselect customer_id\\nfrom \\\"dbt\\\".\\\"local_analytics\\\".\\\"stg_customers\\\"\\nwhere customer_id is null\\n\\n\\n\", \"test_rows_sample\": null, \"other\": null, \"test_name\": \"not_null_stg_customers_customer_id\", \"test_short_name\": \"not_null\", \"test_params\": \"{\\\"column_name\\\": \\\"customer_id\\\", \\\"model\\\": \\\"{{ get_where_subquery(ref('stg_customers')) }}\\\"}\", \"severity\": \"ERROR\", \"test_meta\": \"{\\\"description\\\": \\\"This test validates that there are no `null` values present in a column.\\\"}\", \"model_meta\": \"{}\", \"suppression_status\": \"pending\", \"sent_at\": null, \"status\": \"error\"}, {\"id\": \"a30fc06b-d642-44ed-95a6-dfd13be58b84.test.test_dbt.assert_positive_value_for_total_amount\", \"alert_class_id\": \"test.test_dbt.assert_positive_value_for_total_amount.None.singular\", \"model_unique_id\": \"model.test_dbt.stg_payments\", \"test_unique_id\": \"test.test_dbt.assert_positive_value_for_total_amount\", \"detected_at\": \"2023-08-07T11:47:13\", \"database_name\": \"dbt\", \"schema_name\": \"local_analytics\", \"table_name\": \"stg_payments\", \"column_name\": null, \"test_type\": \"dbt_test\", \"test_sub_type\": \"singular\", \"test_results_description\": \"Database Error in test assert_positive_value_for_total_amount (tests/assert_positive_value_for_total_amount.sql)\\n  relation \\\"local_analytics.stg_payments\\\" does not exist\\n  LINE 18: from \\\"dbt\\\".\\\"local_analytics\\\".\\\"stg_payments\\\"\\n                ^\", \"owners\": \"[]\", \"tags\": \"[]\", \"test_results_query\": \"-- Refunds have a negative amount, so the total amount should always be >= 0.\\n-- Therefore return records where this isn't true to make the test fail.\\nselect\\n    order_id,\\n\\tsum(amount) as total_amount\\nfrom \\\"dbt\\\".\\\"local_analytics\\\".\\\"stg_payments\\\"\\ngroup by 1\\nhaving not(sum(amount) >= 0)\", \"test_rows_sample\": null, \"other\": null, \"test_name\": \"assert_positive_value_for_total_amount\", \"test_short_name\": \"assert_positive_value_for_total_amount\", \"test_params\": \"{}\", \"severity\": \"ERROR\", \"test_meta\": \"{}\", \"model_meta\": \"{}\", \"suppression_status\": \"pending\", \"sent_at\": null, \"status\": \"error\"}, {\"id\": \"80eeba1e-8527-416a-8d86-c42fc32450ac.test.test_dbt.not_null_stg_orders_order_id_customer_id.a094c039ad\", \"alert_class_id\": \"test.test_dbt.not_null_stg_orders_order_id_customer_id.a094c039ad.order_id || customer_id.generic\", \"model_unique_id\": \"model.test_dbt.stg_orders\", \"test_unique_id\": \"test.test_dbt.not_null_stg_orders_order_id_customer_id.a094c039ad\", \"detected_at\": \"2023-08-07T11:56:32\", \"database_name\": \"dbt\", \"schema_name\": \"local_analytics\", \"table_name\": \"stg_orders\", \"column_name\": \"order_id || customer_id\", \"test_type\": \"dbt_test\", \"test_sub_type\": \"generic\", \"test_results_description\": \"Database Error in test not_null_stg_orders_order_id_customer_id (models/staging/models.yml)\\n  operator does not exist: integer || integer\\n  LINE 19: select order_id || customer_id\\n                           ^\\n  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.\", \"owners\": \"[]\", \"tags\": \"[]\", \"test_results_query\": \"\\n    \\n    \\n\\n\\n\\nselect order_id || customer_id\\nfrom \\\"dbt\\\".\\\"local_analytics\\\".\\\"stg_orders\\\"\\nwhere order_id || customer_id is null\\n\\n\\n\", \"test_rows_sample\": null, \"other\": null, \"test_name\": \"not_null_stg_orders_order_id_customer_id\", \"test_short_name\": \"not_null\", \"test_params\": \"{\\\"column_name\\\": \\\"order_id || customer_id\\\", \\\"model\\\": \\\"{{ get_where_subquery(ref('stg_orders')) }}\\\"}\", \"severity\": \"ERROR\", \"test_meta\": null, \"model_meta\": \"{}\", \"suppression_status\": \"pending\", \"sent_at\": null, \"status\": \"error\"}, {\"id\": \"80eeba1e-8527-416a-8d86-c42fc32450ac.test.test_dbt.unique_stg_orders_order_id_customer_id.52431730b9\", \"alert_class_id\": \"test.test_dbt.unique_stg_orders_order_id_customer_id.52431730b9.order_id || customer_id.generic\", \"model_unique_id\": \"model.test_dbt.stg_orders\", \"test_unique_id\": \"test.test_dbt.unique_stg_orders_order_id_customer_id.52431730b9\", \"detected_at\": \"2023-08-07T11:56:32\", \"database_name\": \"dbt\", \"schema_name\": \"local_analytics\", \"table_name\": \"stg_orders\", \"column_name\": \"order_id || customer_id\", \"test_type\": \"dbt_test\", \"test_sub_type\": \"generic\", \"test_results_description\": \"Database Error in test unique_stg_orders_order_id_customer_id (models/staging/models.yml)\\n  operator does not exist: integer || integer\\n  LINE 18:     order_id || customer_id as unique_field,\\n                        ^\\n  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.\", \"owners\": \"[]\", \"tags\": \"[]\", \"test_results_query\": \"\\n    \\n    \\n\\nselect\\n    order_id || customer_id as unique_field,\\n    count(*) as n_records\\n\\nfrom \\\"dbt\\\".\\\"local_analytics\\\".\\\"stg_orders\\\"\\nwhere order_id || customer_id is not null\\ngroup by order_id || customer_id\\nhaving count(*) > 1\\n\\n\\n\", \"test_rows_sample\": null, \"other\": null, \"test_name\": \"unique_stg_orders_order_id_customer_id\", \"test_short_name\": \"unique\", \"test_params\": \"{\\\"column_name\\\": \\\"order_id || customer_id\\\", \\\"model\\\": \\\"{{ get_where_subquery(ref('stg_orders')) }}\\\"}\", \"severity\": \"ERROR\", \"test_meta\": null, \"model_meta\": \"{}\", \"suppression_status\": \"pending\", \"sent_at\": null, \"status\": \"error\"}, {\"id\": \"a30fc06b-d642-44ed-95a6-dfd13be58b84.test.test_dbt.unique_stg_orders_order_id_customer_id.52431730b9\", \"alert_class_id\": \"test.test_dbt.unique_stg_orders_order_id_customer_id.52431730b9.order_id || customer_id.generic\", \"model_unique_id\": \"model.test_dbt.stg_orders\", \"test_unique_id\": \"test.test_dbt.unique_stg_orders_order_id_customer_id.52431730b9\", \"detected_at\": \"2023-08-07T11:47:13\", \"database_name\": \"dbt\", \"schema_name\": \"local_analytics\", \"table_name\": \"stg_orders\", \"column_name\": \"order_id || customer_id\", \"test_type\": \"dbt_test\", \"test_sub_type\": \"generic\", \"test_results_description\": \"Database Error in test unique_stg_orders_order_id_customer_id (models/staging/models.yml)\\n  relation \\\"local_analytics.stg_orders\\\" does not exist\\n  LINE 21: from \\\"dbt\\\".\\\"local_analytics\\\".\\\"stg_orders\\\"\\n                ^\", \"owners\": \"[]\", \"tags\": \"[]\", \"test_results_query\": \"\\n    \\n    \\n\\nselect\\n    order_id || customer_id as unique_field,\\n    count(*) as n_records\\n\\nfrom \\\"dbt\\\".\\\"local_analytics\\\".\\\"stg_orders\\\"\\nwhere order_id || customer_id is not null\\ngroup by order_id || customer_id\\nhaving count(*) > 1\\n\\n\\n\", \"test_rows_sample\": null, \"other\": null, \"test_name\": \"unique_stg_orders_order_id_customer_id\", \"test_short_name\": \"unique\", \"test_params\": \"{\\\"column_name\\\": \\\"order_id || customer_id\\\", \\\"model\\\": \\\"{{ get_where_subquery(ref('stg_orders')) }}\\\"}\", \"severity\": \"ERROR\", \"test_meta\": null, \"model_meta\": \"{}\", \"suppression_status\": \"pending\", \"sent_at\": null, \"status\": \"error\"}, {\"id\": \"a30fc06b-d642-44ed-95a6-dfd13be58b84.test.test_dbt.not_null_stg_orders_order_id_customer_id.a094c039ad\", \"alert_class_id\": \"test.test_dbt.not_null_stg_orders_order_id_customer_id.a094c039ad.order_id || customer_id.generic\", \"model_unique_id\": \"model.test_dbt.stg_orders\", \"test_unique_id\": \"test.test_dbt.not_null_stg_orders_order_id_customer_id.a094c039ad\", \"detected_at\": \"2023-08-07T11:47:13\", \"database_name\": \"dbt\", \"schema_name\": \"local_analytics\", \"table_name\": \"stg_orders\", \"column_name\": \"order_id || customer_id\", \"test_type\": \"dbt_test\", \"test_sub_type\": \"generic\", \"test_results_description\": \"Database Error in test not_null_stg_orders_order_id_customer_id (models/staging/models.yml)\\n  relation \\\"local_analytics.stg_orders\\\" does not exist\\n  LINE 20: from \\\"dbt\\\".\\\"local_analytics\\\".\\\"stg_orders\\\"\\n                ^\", \"owners\": \"[]\", \"tags\": \"[]\", \"test_results_query\": \"\\n    \\n    \\n\\n\\n\\nselect order_id || customer_id\\nfrom \\\"dbt\\\".\\\"local_analytics\\\".\\\"stg_orders\\\"\\nwhere order_id || customer_id is null\\n\\n\\n\", \"test_rows_sample\": null, \"other\": null, \"test_name\": \"not_null_stg_orders_order_id_customer_id\", \"test_short_name\": \"not_null\", \"test_params\": \"{\\\"column_name\\\": \\\"order_id || customer_id\\\", \\\"model\\\": \\\"{{ get_where_subquery(ref('stg_orders')) }}\\\"}\", \"severity\": \"ERROR\", \"test_meta\": null, \"model_meta\": \"{}\", \"suppression_status\": \"pending\", \"sent_at\": null, \"status\": \"error\"}, {\"id\": \"a30fc06b-d642-44ed-95a6-dfd13be58b84.test.test_dbt.not_null_stg_orders_order_id.81cfe2fe64\", \"alert_class_id\": \"test.test_dbt.not_null_stg_orders_order_id.81cfe2fe64.order_id.generic\", \"model_unique_id\": \"model.test_dbt.stg_orders\", \"test_unique_id\": \"test.test_dbt.not_null_stg_orders_order_id.81cfe2fe64\", \"detected_at\": \"2023-08-07T11:47:13\", \"database_name\": \"dbt\", \"schema_name\": \"local_analytics\", \"table_name\": \"stg_orders\", \"column_name\": \"order_id\", \"test_type\": \"dbt_test\", \"test_sub_type\": \"generic\", \"test_results_description\": \"Database Error in test not_null_stg_orders_order_id (models/staging/models.yml)\\n  relation \\\"local_analytics.stg_orders\\\" does not exist\\n  LINE 20: from \\\"dbt\\\".\\\"local_analytics\\\".\\\"stg_orders\\\"\\n                ^\", \"owners\": \"[]\", \"tags\": \"[]\", \"test_results_query\": \"\\n    \\n    \\n\\n\\n\\nselect order_id\\nfrom \\\"dbt\\\".\\\"local_analytics\\\".\\\"stg_orders\\\"\\nwhere order_id is null\\n\\n\\n\", \"test_rows_sample\": null, \"other\": null, \"test_name\": \"not_null_stg_orders_order_id\", \"test_short_name\": \"not_null\", \"test_params\": \"{\\\"column_name\\\": \\\"order_id\\\", \\\"model\\\": \\\"{{ get_where_subquery(ref('stg_orders')) }}\\\"}\", \"severity\": \"ERROR\", \"test_meta\": \"{\\\"description\\\": \\\"This test validates that there are no `null` values present in a column.\\\"}\", \"model_meta\": \"{}\", \"suppression_status\": \"pending\", \"sent_at\": null, \"status\": \"error\"}, {\"id\": \"a30fc06b-d642-44ed-95a6-dfd13be58b84.test.test_dbt.unique_stg_orders_order_id.e3b841c71a\", \"alert_class_id\": \"test.test_dbt.unique_stg_orders_order_id.e3b841c71a.order_id.generic\", \"model_unique_id\": \"model.test_dbt.stg_orders\", \"test_unique_id\": \"test.test_dbt.unique_stg_orders_order_id.e3b841c71a\", \"detected_at\": \"2023-08-07T11:47:13\", \"database_name\": \"dbt\", \"schema_name\": \"local_analytics\", \"table_name\": \"stg_orders\", \"column_name\": \"order_id\", \"test_type\": \"dbt_test\", \"test_sub_type\": \"generic\", \"test_results_description\": \"Database Error in test unique_stg_orders_order_id (models/staging/models.yml)\\n  relation \\\"local_analytics.stg_orders\\\" does not exist\\n  LINE 21: from \\\"dbt\\\".\\\"local_analytics\\\".\\\"stg_orders\\\"\\n                ^\", \"owners\": \"[]\", \"tags\": \"[]\", \"test_results_query\": \"\\n    \\n    \\n\\nselect\\n    order_id as unique_field,\\n    count(*) as n_records\\n\\nfrom \\\"dbt\\\".\\\"local_analytics\\\".\\\"stg_orders\\\"\\nwhere order_id is not null\\ngroup by order_id\\nhaving count(*) > 1\\n\\n\\n\", \"test_rows_sample\": null, \"other\": null, \"test_name\": \"unique_stg_orders_order_id\", \"test_short_name\": \"unique\", \"test_params\": \"{\\\"column_name\\\": \\\"order_id\\\", \\\"model\\\": \\\"{{ get_where_subquery(ref('stg_orders')) }}\\\"}\", \"severity\": \"ERROR\", \"test_meta\": \"{\\\"description\\\": \\\"This test validates that there are no duplicate values present in a field.\\\"}\", \"model_meta\": \"{}\", \"suppression_status\": \"pending\", \"sent_at\": null, \"status\": \"error\"}, {\"id\": \"a30fc06b-d642-44ed-95a6-dfd13be58b84.test.test_dbt.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1\", \"alert_class_id\": \"test.test_dbt.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1.status.generic\", \"model_unique_id\": \"model.test_dbt.stg_orders\", \"test_unique_id\": \"test.test_dbt.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1\", \"detected_at\": \"2023-08-07T11:47:13\", \"database_name\": \"dbt\", \"schema_name\": \"local_analytics\", \"table_name\": \"stg_orders\", \"column_name\": \"status\", \"test_type\": \"dbt_test\", \"test_sub_type\": \"generic\", \"test_results_description\": \"Database Error in test accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed (models/staging/models.yml)\\n  relation \\\"local_analytics.stg_orders\\\" does not exist\\n  LINE 23:     from \\\"dbt\\\".\\\"local_analytics\\\".\\\"stg_orders\\\"\\n                    ^\", \"owners\": \"[]\", \"tags\": \"[]\", \"test_results_query\": \"\\n    \\n    \\n\\nwith all_values as (\\n\\n    select\\n        status as value_field,\\n        count(*) as n_records\\n\\n    from \\\"dbt\\\".\\\"local_analytics\\\".\\\"stg_orders\\\"\\n    group by status\\n\\n)\\n\\nselect *\\nfrom all_values\\nwhere value_field not in (\\n    'completed','shipped','returned','return_pending','placed'\\n)\\n\\n\\n\", \"test_rows_sample\": null, \"other\": null, \"test_name\": \"accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed\", \"test_short_name\": \"accepted_values\", \"test_params\": \"{\\\"values\\\": [\\\"completed\\\", \\\"shipped\\\", \\\"returned\\\", \\\"return_pending\\\", \\\"placed\\\"], \\\"column_name\\\": \\\"status\\\", \\\"model\\\": \\\"{{ get_where_subquery(ref('stg_orders')) }}\\\"}\", \"severity\": \"ERROR\", \"test_meta\": \"{\\\"description\\\": \\\"This test validates that all of the values in a column are present in a supplied list of `values`. If any values other than those provided in the list are present, then the test will fail.\\\"}\", \"model_meta\": \"{}\", \"suppression_status\": \"pending\", \"sent_at\": null, \"status\": \"error\"}, {\"id\": \"a30fc06b-d642-44ed-95a6-dfd13be58b84.test.test_dbt.not_null_dim_customers_customer_id.dd91cd1c8d\", \"alert_class_id\": \"test.test_dbt.not_null_dim_customers_customer_id.dd91cd1c8d.customer_id.generic\", \"model_unique_id\": \"model.test_dbt.dim_customers\", \"test_unique_id\": \"test.test_dbt.not_null_dim_customers_customer_id.dd91cd1c8d\", \"detected_at\": \"2023-08-07T11:47:13\", \"database_name\": \"dbt\", \"schema_name\": \"local_analytics\", \"table_name\": \"dim_customers\", \"column_name\": \"customer_id\", \"test_type\": \"dbt_test\", \"test_sub_type\": \"generic\", \"test_results_description\": \"Database Error in test not_null_dim_customers_customer_id (models/marts/marts.yml)\\n  relation \\\"local_analytics.dim_customers\\\" does not exist\\n  LINE 20: from \\\"dbt\\\".\\\"local_analytics\\\".\\\"dim_customers\\\"\\n                ^\", \"owners\": \"[]\", \"tags\": \"[]\", \"test_results_query\": \"\\n    \\n    \\n\\n\\n\\nselect customer_id\\nfrom \\\"dbt\\\".\\\"local_analytics\\\".\\\"dim_customers\\\"\\nwhere customer_id is null\\n\\n\\n\", \"test_rows_sample\": null, \"other\": null, \"test_name\": \"not_null_dim_customers_customer_id\", \"test_short_name\": \"not_null\", \"test_params\": \"{\\\"column_name\\\": \\\"customer_id\\\", \\\"model\\\": \\\"{{ get_where_subquery(ref('dim_customers')) }}\\\"}\", \"severity\": \"ERROR\", \"test_meta\": \"{\\\"description\\\": \\\"This test validates that there are no `null` values present in a column.\\\"}\", \"model_meta\": \"{}\", \"suppression_status\": \"pending\", \"sent_at\": null, \"status\": \"error\"}, {\"id\": \"a30fc06b-d642-44ed-95a6-dfd13be58b84.test.test_dbt.unique_dim_customers_customer_id.15c9f1e2fd\", \"alert_class_id\": \"test.test_dbt.unique_dim_customers_customer_id.15c9f1e2fd.customer_id.generic\", \"model_unique_id\": \"model.test_dbt.dim_customers\", \"test_unique_id\": \"test.test_dbt.unique_dim_customers_customer_id.15c9f1e2fd\", \"detected_at\": \"2023-08-07T11:47:13\", \"database_name\": \"dbt\", \"schema_name\": \"local_analytics\", \"table_name\": \"dim_customers\", \"column_name\": \"customer_id\", \"test_type\": \"dbt_test\", \"test_sub_type\": \"generic\", \"test_results_description\": \"Database Error in test unique_dim_customers_customer_id (models/marts/marts.yml)\\n  relation \\\"local_analytics.dim_customers\\\" does not exist\\n  LINE 21: from \\\"dbt\\\".\\\"local_analytics\\\".\\\"dim_customers\\\"\\n                ^\", \"owners\": \"[]\", \"tags\": \"[]\", \"test_results_query\": \"\\n    \\n    \\n\\nselect\\n    customer_id as unique_field,\\n    count(*) as n_records\\n\\nfrom \\\"dbt\\\".\\\"local_analytics\\\".\\\"dim_customers\\\"\\nwhere customer_id is not null\\ngroup by customer_id\\nhaving count(*) > 1\\n\\n\\n\", \"test_rows_sample\": null, \"other\": null, \"test_name\": \"unique_dim_customers_customer_id\", \"test_short_name\": \"unique\", \"test_params\": \"{\\\"column_name\\\": \\\"customer_id\\\", \\\"model\\\": \\\"{{ get_where_subquery(ref('dim_customers')) }}\\\"}\", \"severity\": \"ERROR\", \"test_meta\": \"{\\\"description\\\": \\\"This test validates that there are no duplicate values present in a field.\\\"}\", \"model_meta\": \"{}\", \"suppression_status\": \"pending\", \"sent_at\": null, \"status\": \"error\"}, {\"id\": \"a30fc06b-d642-44ed-95a6-dfd13be58b84.test.test_dbt.dbt_utils_cardinality_equality_dim_customers_customer_id__customer_id__ref_stg_customers_.cdf22e9197\", \"alert_class_id\": \"test.test_dbt.dbt_utils_cardinality_equality_dim_customers_customer_id__customer_id__ref_stg_customers_.cdf22e9197.customer_id.generic\", \"model_unique_id\": \"model.test_dbt.dim_customers\", \"test_unique_id\": \"test.test_dbt.dbt_utils_cardinality_equality_dim_customers_customer_id__customer_id__ref_stg_customers_.cdf22e9197\", \"detected_at\": \"2023-08-07T11:47:13\", \"database_name\": \"dbt\", \"schema_name\": \"local_analytics\", \"table_name\": \"dim_customers\", \"column_name\": \"customer_id\", \"test_type\": \"dbt_test\", \"test_sub_type\": \"generic\", \"test_results_description\": \"Database Error in test dbt_utils_cardinality_equality_dim_customers_customer_id__customer_id__ref_stg_customers_ (models/marts/marts.yml)\\n  relation \\\"local_analytics.dim_customers\\\" does not exist\\n  LINE 22: from \\\"dbt\\\".\\\"local_analytics\\\".\\\"dim_customers\\\"\\n                ^\", \"owners\": \"[]\", \"tags\": \"[\\\"critical-tag\\\"]\", \"test_results_query\": \"\\n\\n\\n\\n\\nwith table_a as (\\nselect\\n  customer_id,\\n  count(*) as num_rows\\nfrom \\\"dbt\\\".\\\"local_analytics\\\".\\\"dim_customers\\\"\\ngroup by customer_id\\n),\\n\\ntable_b as (\\nselect\\n  customer_id,\\n  count(*) as num_rows\\nfrom \\\"dbt\\\".\\\"local_analytics\\\".\\\"stg_customers\\\"\\ngroup by customer_id\\n),\\n\\nexcept_a as (\\n  select *\\n  from table_a\\n  \\n\\n    except\\n\\n\\n  select *\\n  from table_b\\n),\\n\\nexcept_b as (\\n  select *\\n  from table_b\\n  \\n\\n    except\\n\\n\\n  select *\\n  from table_a\\n),\\n\\nunioned as (\\n  select *\\n  from except_a\\n  union all\\n  select *\\n  from except_b\\n)\\n\\nselect *\\nfrom unioned\\n\\n\", \"test_rows_sample\": null, \"other\": null, \"test_name\": \"dbt_utils_cardinality_equality_dim_customers_customer_id__customer_id__ref_stg_customers_\", \"test_short_name\": \"cardinality_equality\", \"test_params\": \"{\\\"field\\\": \\\"customer_id\\\", \\\"to\\\": \\\"ref('stg_customers')\\\", \\\"column_name\\\": \\\"customer_id\\\", \\\"model\\\": \\\"{{ get_where_subquery(ref('dim_customers')) }}\\\"}\", \"severity\": \"ERROR\", \"test_meta\": \"{}\", \"model_meta\": \"{}\", \"suppression_status\": \"pending\", \"sent_at\": null, \"status\": \"error\"}, {\"id\": \"a30fc06b-d642-44ed-95a6-dfd13be58b84.test.test_dbt.assert_amount_average_is_greater_than_one\", \"alert_class_id\": \"test.test_dbt.assert_amount_average_is_greater_than_one.None.singular\", \"model_unique_id\": \"model.test_dbt.fct_orders\", \"test_unique_id\": \"test.test_dbt.assert_amount_average_is_greater_than_one\", \"detected_at\": \"2023-08-07T11:47:13\", \"database_name\": \"dbt\", \"schema_name\": \"local_analytics\", \"table_name\": \"fct_orders\", \"column_name\": null, \"test_type\": \"dbt_test\", \"test_sub_type\": \"singular\", \"test_results_description\": \"Database Error in test assert_amount_average_is_greater_than_one (tests/assert_amount_average_is_greater_than_one.sql)\\n  relation \\\"local_analytics.fct_orders\\\" does not exist\\n  LINE 16: from \\\"dbt\\\".\\\"local_analytics\\\".\\\"fct_orders\\\"\\n                ^\", \"owners\": \"[]\", \"tags\": \"[]\", \"test_results_query\": \"select\\n    customer_id, \\n    avg(amount) as average_amount\\nfrom \\\"dbt\\\".\\\"local_analytics\\\".\\\"fct_orders\\\"\\ngroup by 1\\nhaving count(customer_id) > 1 and avg(amount) < 1\", \"test_rows_sample\": null, \"other\": null, \"test_name\": \"assert_amount_average_is_greater_than_one\", \"test_short_name\": \"assert_amount_average_is_greater_than_one\", \"test_params\": \"{}\", \"severity\": \"ERROR\", \"test_meta\": \"{}\", \"model_meta\": \"{}\", \"suppression_status\": \"pending\", \"sent_at\": null, \"status\": \"error\"}, {\"id\": \"a30fc06b-d642-44ed-95a6-dfd13be58b84.test.test_dbt.assert_total_payment_amount_is_positive\", \"alert_class_id\": \"test.test_dbt.assert_total_payment_amount_is_positive.None.singular\", \"model_unique_id\": \"model.test_dbt.fct_orders\", \"test_unique_id\": \"test.test_dbt.assert_total_payment_amount_is_positive\", \"detected_at\": \"2023-08-07T11:47:13\", \"database_name\": \"dbt\", \"schema_name\": \"local_analytics\", \"table_name\": \"fct_orders\", \"column_name\": null, \"test_type\": \"dbt_test\", \"test_sub_type\": \"singular\", \"test_results_description\": \"Database Error in test assert_total_payment_amount_is_positive (tests/assert_total_payment_amount_is_positive.sql)\\n  relation \\\"local_analytics.fct_orders\\\" does not exist\\n  LINE 16: from \\\"dbt\\\".\\\"local_analytics\\\".\\\"fct_orders\\\"\\n                ^\", \"owners\": \"[]\", \"tags\": \"[]\", \"test_results_query\": \"select\\n    order_id, \\n    amount\\nfrom \\\"dbt\\\".\\\"local_analytics\\\".\\\"fct_orders\\\"\\nwhere amount < 0\", \"test_rows_sample\": null, \"other\": null, \"test_name\": \"assert_total_payment_amount_is_positive\", \"test_short_name\": \"assert_total_payment_amount_is_positive\", \"test_params\": \"{}\", \"severity\": \"ERROR\", \"test_meta\": \"{}\", \"model_meta\": \"{}\", \"suppression_status\": \"pending\", \"sent_at\": null, \"status\": \"error\"}, {\"id\": \"a30fc06b-d642-44ed-95a6-dfd13be58b84.test.test_dbt.average_dollars_spent_greater_than_one_fct_orders_amount__customer_id.b5af33deeb\", \"alert_class_id\": \"test.test_dbt.average_dollars_spent_greater_than_one_fct_orders_amount__customer_id.b5af33deeb.amount.generic\", \"model_unique_id\": \"model.test_dbt.fct_orders\", \"test_unique_id\": \"test.test_dbt.average_dollars_spent_greater_than_one_fct_orders_amount__customer_id.b5af33deeb\", \"detected_at\": \"2023-08-07T11:47:13\", \"database_name\": \"dbt\", \"schema_name\": \"local_analytics\", \"table_name\": \"fct_orders\", \"column_name\": \"amount\", \"test_type\": \"dbt_test\", \"test_sub_type\": \"generic\", \"test_results_description\": \"Database Error in test average_dollars_spent_greater_than_one_fct_orders_amount__customer_id (models/marts/marts.yml)\\n  relation \\\"local_analytics.fct_orders\\\" does not exist\\n  LINE 19: from \\\"dbt\\\".\\\"local_analytics\\\".\\\"fct_orders\\\"\\n                ^\", \"owners\": \"[]\", \"tags\": \"[]\", \"test_results_query\": \"\\n\\nselect \\n    customer_id,\\n    avg( amount ) as average_amount\\n\\nfrom \\\"dbt\\\".\\\"local_analytics\\\".\\\"fct_orders\\\"\\ngroup by 1\\nhaving avg( amount ) < 1\\n\\n\\n\", \"test_rows_sample\": null, \"other\": null, \"test_name\": \"average_dollars_spent_greater_than_one_fct_orders_amount__customer_id\", \"test_short_name\": \"average_dollars_spent_greater_than_one\", \"test_params\": \"{\\\"group_by_column\\\": \\\"customer_id\\\", \\\"column_name\\\": \\\"amount\\\", \\\"model\\\": \\\"{{ get_where_subquery(ref('fct_orders')) }}\\\"}\", \"severity\": \"ERROR\", \"test_meta\": \"{}\", \"model_meta\": \"{}\", \"suppression_status\": \"pending\", \"sent_at\": null, \"status\": \"error\"}, {\"id\": \"ae8cffa4-c04f-4ee8-a58d-5a263fe9e884.test.test_dbt.source_unique_stripe_payment_id.3b7989ce64\", \"alert_class_id\": \"test.test_dbt.source_unique_stripe_payment_id.3b7989ce64.id.generic\", \"model_unique_id\": \"source.test_dbt.stripe.payment\", \"test_unique_id\": \"test.test_dbt.source_unique_stripe_payment_id.3b7989ce64\", \"detected_at\": \"2023-08-07T11:57:54\", \"database_name\": \"dbt\", \"schema_name\": \"local_analytics\", \"table_name\": \"payment\", \"column_name\": \"id\", \"test_type\": \"dbt_test\", \"test_sub_type\": \"generic\", \"test_results_description\": \"Database Error in test source_unique_stripe_payment_id (models/staging/sources.yml)\\n  column \\\"id\\\" does not exist\\n  LINE 18:     id as unique_field,\\n               ^\", \"owners\": \"[]\", \"tags\": \"[]\", \"test_results_query\": \"\\n    \\n    \\n\\nselect\\n    id as unique_field,\\n    count(*) as n_records\\n\\nfrom \\\"dbt\\\".\\\"local_analytics\\\".\\\"payment\\\"\\nwhere id is not null\\ngroup by id\\nhaving count(*) > 1\\n\\n\\n\", \"test_rows_sample\": null, \"other\": null, \"test_name\": \"source_unique_stripe_payment_id\", \"test_short_name\": \"unique\", \"test_params\": \"{\\\"column_name\\\": \\\"id\\\", \\\"model\\\": \\\"{{ get_where_subquery(source('stripe', 'payment')) }}\\\"}\", \"severity\": \"ERROR\", \"test_meta\": null, \"model_meta\": \"{}\", \"suppression_status\": \"pending\", \"sent_at\": null, \"status\": \"error\"}, {\"id\": \"80eeba1e-8527-416a-8d86-c42fc32450ac.test.test_dbt.source_unique_stripe_payment_id.3b7989ce64\", \"alert_class_id\": \"test.test_dbt.source_unique_stripe_payment_id.3b7989ce64.id.generic\", \"model_unique_id\": \"source.test_dbt.stripe.payment\", \"test_unique_id\": \"test.test_dbt.source_unique_stripe_payment_id.3b7989ce64\", \"detected_at\": \"2023-08-07T11:56:32\", \"database_name\": \"dbt\", \"schema_name\": \"local_analytics\", \"table_name\": \"payment\", \"column_name\": \"id\", \"test_type\": \"dbt_test\", \"test_sub_type\": \"generic\", \"test_results_description\": \"Database Error in test source_unique_stripe_payment_id (models/staging/sources.yml)\\n  column \\\"id\\\" does not exist\\n  LINE 18:     id as unique_field,\\n               ^\", \"owners\": \"[]\", \"tags\": \"[]\", \"test_results_query\": \"\\n    \\n    \\n\\nselect\\n    id as unique_field,\\n    count(*) as n_records\\n\\nfrom \\\"dbt\\\".\\\"local_analytics\\\".\\\"payment\\\"\\nwhere id is not null\\ngroup by id\\nhaving count(*) > 1\\n\\n\\n\", \"test_rows_sample\": null, \"other\": null, \"test_name\": \"source_unique_stripe_payment_id\", \"test_short_name\": \"unique\", \"test_params\": \"{\\\"column_name\\\": \\\"id\\\", \\\"model\\\": \\\"{{ get_where_subquery(source('stripe', 'payment')) }}\\\"}\", \"severity\": \"ERROR\", \"test_meta\": null, \"model_meta\": \"{}\", \"suppression_status\": \"pending\", \"sent_at\": null, \"status\": \"error\"}, {\"id\": \"a30fc06b-d642-44ed-95a6-dfd13be58b84.test.test_dbt.source_unique_stripe_payment_id.3b7989ce64\", \"alert_class_id\": \"test.test_dbt.source_unique_stripe_payment_id.3b7989ce64.id.generic\", \"model_unique_id\": \"source.test_dbt.stripe.payment\", \"test_unique_id\": \"test.test_dbt.source_unique_stripe_payment_id.3b7989ce64\", \"detected_at\": \"2023-08-07T11:47:13\", \"database_name\": \"dbt\", \"schema_name\": \"local_analytics\", \"table_name\": \"payment\", \"column_name\": \"id\", \"test_type\": \"dbt_test\", \"test_sub_type\": \"generic\", \"test_results_description\": \"Database Error in test source_unique_stripe_payment_id (models/staging/sources.yml)\\n  relation \\\"local_analytics.payment\\\" does not exist\\n  LINE 21: from \\\"dbt\\\".\\\"local_analytics\\\".\\\"payment\\\"\\n                ^\", \"owners\": \"[]\", \"tags\": \"[]\", \"test_results_query\": \"\\n    \\n    \\n\\nselect\\n    id as unique_field,\\n    count(*) as n_records\\n\\nfrom \\\"dbt\\\".\\\"local_analytics\\\".\\\"payment\\\"\\nwhere id is not null\\ngroup by id\\nhaving count(*) > 1\\n\\n\\n\", \"test_rows_sample\": null, \"other\": null, \"test_name\": \"source_unique_stripe_payment_id\", \"test_short_name\": \"unique\", \"test_params\": \"{\\\"column_name\\\": \\\"id\\\", \\\"model\\\": \\\"{{ get_where_subquery(source('stripe', 'payment')) }}\\\"}\", \"severity\": \"ERROR\", \"test_meta\": null, \"model_meta\": \"{}\", \"suppression_status\": \"pending\", \"sent_at\": null, \"status\": \"error\"}]", "name": "JinjaLogInfo", "pid": 14109, "thread": "MainThread", "ts": "2023-08-08T13:08:52.249361Z"}}
{"data": {"conn_name": "macro_log_macro_results"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "63ea8265-aefd-451a-90a4-e56fd051fcdd", "level": "debug", "msg": "On macro_log_macro_results: Close", "name": "ConnectionClosed", "pid": 14109, "thread": "MainThread", "ts": "2023-08-08T13:08:52.251360Z"}}
{"data": {"command": "dbt run-operation", "completed_at": "2023-08-08T13:08:52.252175Z", "elapsed": 0.37961945, "success": true}, "info": {"category": "", "code": "Q039", "extra": {}, "invocation_id": "63ea8265-aefd-451a-90a4-e56fd051fcdd", "level": "debug", "msg": "Command `dbt run-operation` succeeded at 16:08:52.252175 after 0.38 seconds", "name": "CommandCompleted", "pid": 14109, "thread": "MainThread", "ts": "2023-08-08T13:08:52.252232Z"}}
{"data": {"conn_name": "macro_log_macro_results"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "63ea8265-aefd-451a-90a4-e56fd051fcdd", "level": "debug", "msg": "Connection 'macro_log_macro_results' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 14109, "thread": "MainThread", "ts": "2023-08-08T13:08:52.252498Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103eed4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106040940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cdbeb0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "63ea8265-aefd-451a-90a4-e56fd051fcdd", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103eed4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106040940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cdbeb0>]}", "name": "SendingEvent", "pid": 14109, "thread": "MainThread", "ts": "2023-08-08T13:08:52.252726Z"}}
{"data": {}, "info": {"category": "", "code": "Z042", "extra": {}, "invocation_id": "63ea8265-aefd-451a-90a4-e56fd051fcdd", "level": "debug", "msg": "Flushing usage events", "name": "FlushEvents", "pid": 14109, "thread": "MainThread", "ts": "2023-08-08T13:08:52.252969Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fcd4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108aa22b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108aa2c10>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "1dab847d-1f18-4b51-b746-f7b62baf1be1", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fcd4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108aa22b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108aa2c10>]}", "name": "SendingEvent", "pid": 14117, "thread": "MainThread", "ts": "2023-08-08T13:08:54.054738Z"}}
{"data": {"log_version": 3, "version": "=1.6.0"}, "info": {"category": "", "code": "A001", "extra": {}, "invocation_id": "1dab847d-1f18-4b51-b746-f7b62baf1be1", "level": "info", "msg": "Running with dbt=1.6.0", "name": "MainReportVersion", "pid": 14117, "thread": "MainThread", "ts": "2023-08-08T13:08:54.056829Z"}}
{"data": {"args": {"cache_selected_only": "False", "debug": "False", "fail_fast": "False", "indirect_selection": "eager", "introspect": "True", "invocation_command": "dbt --log-format json run-operation elementary.log_macro_results --args {\"macro_name\": \"get_last_test_alert_sent_times\", \"macro_args\": {\"days_back\": 1}} --project-dir /Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/elementary/monitor/dbt_project", "log_cache_events": "False", "log_format": "json", "log_path": "/Users/ofek/workspace/test_dbt/edr_target", "no_print": "None", "partial_parse": "True", "printer_width": "80", "profiles_dir": "/Users/ofek/.dbt", "quiet": "False", "send_anonymous_usage_stats": "True", "static_parser": "True", "target_path": "None", "use_colors": "True", "use_experimental_parser": "False", "version_check": "True", "warn_error": "None", "warn_error_options": "WarnErrorOptions(include=[], exclude=[])", "write_json": "True"}}, "info": {"category": "", "code": "A002", "extra": {}, "invocation_id": "1dab847d-1f18-4b51-b746-f7b62baf1be1", "level": "debug", "msg": "running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/ofek/workspace/test_dbt/edr_target', 'version_check': 'True', 'profiles_dir': '/Users/ofek/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'json', 'invocation_command': 'dbt --log-format json run-operation elementary.log_macro_results --args {\"macro_name\": \"get_last_test_alert_sent_times\", \"macro_args\": {\"days_back\": 1}} --project-dir /Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/elementary/monitor/dbt_project', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}", "name": "MainReportArgs", "pid": 14117, "thread": "MainThread", "ts": "2023-08-08T13:08:54.057223Z"}}
{"data": {"profile_name": "elementary", "target_name": "default"}, "info": {"category": "", "code": "A005", "extra": {}, "invocation_id": "1dab847d-1f18-4b51-b746-f7b62baf1be1", "level": "info", "msg": "target not specified in profile 'elementary', using 'default'", "name": "MissingProfileTarget", "pid": 14117, "thread": "MainThread", "ts": "2023-08-08T13:08:54.074458Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'project_id', 'label': '1dab847d-1f18-4b51-b746-f7b62baf1be1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108120940>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "1dab847d-1f18-4b51-b746-f7b62baf1be1", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1dab847d-1f18-4b51-b746-f7b62baf1be1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108120940>]}", "name": "SendingEvent", "pid": 14117, "thread": "MainThread", "ts": "2023-08-08T13:08:54.212066Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'adapter_info', 'label': '1dab847d-1f18-4b51-b746-f7b62baf1be1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109dbeeb0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "1dab847d-1f18-4b51-b746-f7b62baf1be1", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1dab847d-1f18-4b51-b746-f7b62baf1be1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109dbeeb0>]}", "name": "SendingEvent", "pid": 14117, "thread": "MainThread", "ts": "2023-08-08T13:08:54.217774Z"}}
{"data": {"adapter_name": "postgres", "adapter_version": "=1.6.0"}, "info": {"category": "", "code": "E034", "extra": {}, "invocation_id": "1dab847d-1f18-4b51-b746-f7b62baf1be1", "level": "info", "msg": "Registered adapter: postgres=1.6.0", "name": "AdapterRegistered", "pid": 14117, "thread": "MainThread", "ts": "2023-08-08T13:08:54.218164Z"}}
{"data": {"checksum": "08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9", "profile": "", "target": "", "vars": "{}", "version": "1.6.0"}, "info": {"category": "", "code": "I025", "extra": {}, "invocation_id": "1dab847d-1f18-4b51-b746-f7b62baf1be1", "level": "debug", "msg": "checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0", "name": "StateCheckVarsHash", "pid": 14117, "thread": "MainThread", "ts": "2023-08-08T13:08:54.230675Z"}}
{"data": {"added": 0, "changed": 0, "deleted": 0}, "info": {"category": "", "code": "I040", "extra": {}, "invocation_id": "1dab847d-1f18-4b51-b746-f7b62baf1be1", "level": "debug", "msg": "Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.", "name": "PartialParsingEnabled", "pid": 14117, "thread": "MainThread", "ts": "2023-08-08T13:08:54.309812Z"}}
{"data": {}, "info": {"category": "", "code": "I017", "extra": {}, "invocation_id": "1dab847d-1f18-4b51-b746-f7b62baf1be1", "level": "debug", "msg": "Partial parsing enabled, no changes found, skipping parsing", "name": "PartialParsingSkipParsing", "pid": 14117, "thread": "MainThread", "ts": "2023-08-08T13:08:54.310121Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'load_project', 'label': '1dab847d-1f18-4b51-b746-f7b62baf1be1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3080d0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "1dab847d-1f18-4b51-b746-f7b62baf1be1", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1dab847d-1f18-4b51-b746-f7b62baf1be1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3080d0>]}", "name": "SendingEvent", "pid": 14117, "thread": "MainThread", "ts": "2023-08-08T13:08:54.315362Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'resource_counts', 'label': '1dab847d-1f18-4b51-b746-f7b62baf1be1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2b0790>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "1dab847d-1f18-4b51-b746-f7b62baf1be1", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1dab847d-1f18-4b51-b746-f7b62baf1be1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2b0790>]}", "name": "SendingEvent", "pid": 14117, "thread": "MainThread", "ts": "2023-08-08T13:08:54.330880Z"}}
{"data": {"stat_line": "34 models, 2 operations, 6 tests, 6 sources, 0 exposures, 0 metrics, 1101 macros, 0 groups, 0 semantic models"}, "info": {"category": "", "code": "W006", "extra": {}, "invocation_id": "1dab847d-1f18-4b51-b746-f7b62baf1be1", "level": "info", "msg": "Found 34 models, 2 operations, 6 tests, 6 sources, 0 exposures, 0 metrics, 1101 macros, 0 groups, 0 semantic models", "name": "FoundStats", "pid": 14117, "thread": "MainThread", "ts": "2023-08-08T13:08:54.331200Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'runnable_timing', 'label': '1dab847d-1f18-4b51-b746-f7b62baf1be1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2b0b80>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "1dab847d-1f18-4b51-b746-f7b62baf1be1", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1dab847d-1f18-4b51-b746-f7b62baf1be1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2b0b80>]}", "name": "SendingEvent", "pid": 14117, "thread": "MainThread", "ts": "2023-08-08T13:08:54.331457Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "1dab847d-1f18-4b51-b746-f7b62baf1be1", "level": "debug", "msg": "Acquiring new postgres connection 'macro_log_macro_results'", "name": "NewConnection", "pid": 14117, "thread": "MainThread", "ts": "2023-08-08T13:08:54.331883Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "1dab847d-1f18-4b51-b746-f7b62baf1be1", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 14117, "thread": "MainThread", "ts": "2023-08-08T13:08:54.332127Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "BEGIN"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "1dab847d-1f18-4b51-b746-f7b62baf1be1", "level": "debug", "msg": "On macro_log_macro_results: BEGIN", "name": "SQLQuery", "pid": 14117, "thread": "MainThread", "ts": "2023-08-08T13:08:54.332348Z"}}
{"data": {"connection_state": "init"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "1dab847d-1f18-4b51-b746-f7b62baf1be1", "level": "debug", "msg": "Opening a new connection, currently in state init", "name": "NewConnectionOpening", "pid": 14117, "thread": "MainThread", "ts": "2023-08-08T13:08:54.332560Z"}}
{"data": {"elapsed": 0.0, "status": "BEGIN"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "1dab847d-1f18-4b51-b746-f7b62baf1be1", "level": "debug", "msg": "SQL status: BEGIN in 0.0 seconds", "name": "SQLQueryStatus", "pid": 14117, "thread": "MainThread", "ts": "2023-08-08T13:08:54.350717Z"}}
{"data": {"conn_name": "macro_log_macro_results"}, "info": {"category": "", "code": "E018", "extra": {}, "invocation_id": "1dab847d-1f18-4b51-b746-f7b62baf1be1", "level": "debug", "msg": "On macro_log_macro_results: COMMIT", "name": "SQLCommit", "pid": 14117, "thread": "MainThread", "ts": "2023-08-08T13:08:54.351022Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "1dab847d-1f18-4b51-b746-f7b62baf1be1", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 14117, "thread": "MainThread", "ts": "2023-08-08T13:08:54.351269Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "COMMIT"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "1dab847d-1f18-4b51-b746-f7b62baf1be1", "level": "debug", "msg": "On macro_log_macro_results: COMMIT", "name": "SQLQuery", "pid": 14117, "thread": "MainThread", "ts": "2023-08-08T13:08:54.351505Z"}}
{"data": {"elapsed": 0.0, "status": "COMMIT"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "1dab847d-1f18-4b51-b746-f7b62baf1be1", "level": "debug", "msg": "SQL status: COMMIT in 0.0 seconds", "name": "SQLQueryStatus", "pid": 14117, "thread": "MainThread", "ts": "2023-08-08T13:08:54.352656Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "1dab847d-1f18-4b51-b746-f7b62baf1be1", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 14117, "thread": "MainThread", "ts": "2023-08-08T13:08:54.379176Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.6.0\", \"profile_name\": \"elementary\", \"target_name\": \"default\", \"connection_name\": \"macro_log_macro_results\"} */\n\n    \n        with alerts_in_time_limit as (\n            select\n                \n                coalesce(test_unique_id, 'None') || '.' || coalesce(column_name, 'None') || '.' || coalesce(sub_type, 'None') as alert_class_id,\n                case\n                    when suppression_status is NULL and alert_sent = TRUE then 'sent'\n                    when suppression_status is NULL and alert_sent = FALSE then 'pending'\n                    else suppression_status\n                end as suppression_status,\n                sent_at\n            from \"dbt\".\"local_analytics_elementary\".\"alerts\"\n            where cast(detected_at as TIMESTAMP) >= cast(\n\n    date_trunc('day', \n    current_timestamp::TIMESTAMP\n) + ((interval '1 day') * (-1))\n\n as TIMESTAMP)\n        )\n\n        select \n            alert_class_id,\n            max(sent_at) as last_sent_at\n        from alerts_in_time_limit\n        where suppression_status = 'sent'\n        group by alert_class_id\n    \n  "}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "1dab847d-1f18-4b51-b746-f7b62baf1be1", "level": "debug", "msg": "On macro_log_macro_results: /* {\"app\": \"dbt\", \"dbt_version\": \"1.6.0\", \"profile_name\": \"elementary\", \"target_name\": \"default\", \"connection_name\": \"macro_log_macro_results\"} */\n\n    \n        with alerts_in_time_limit as (\n            select\n                \n                coalesce(test_unique_id, 'None') || '.' || coalesce(column_name, 'None') || '.' || coalesce(sub_type, 'None') as alert_class_id,\n                case\n                    when suppression_status is NULL and alert_sent = TRUE then 'sent'\n                    when suppression_status is NULL and alert_sent = FALSE then 'pending'\n                    else suppression_status\n                end as suppression_status,\n                sent_at\n            from \"dbt\".\"local_analytics_elementary\".\"alerts\"\n            where cast(detected_at as TIMESTAMP) >= cast(\n\n    date_trunc('day', \n    current_timestamp::TIMESTAMP\n) + ((interval '1 day') * (-1))\n\n as TIMESTAMP)\n        )\n\n        select \n            alert_class_id,\n            max(sent_at) as last_sent_at\n        from alerts_in_time_limit\n        where suppression_status = 'sent'\n        group by alert_class_id\n    \n  ", "name": "SQLQuery", "pid": 14117, "thread": "MainThread", "ts": "2023-08-08T13:08:54.379482Z"}}
{"data": {"elapsed": 0.0, "status": "SELECT 0"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "1dab847d-1f18-4b51-b746-f7b62baf1be1", "level": "debug", "msg": "SQL status: SELECT 0 in 0.0 seconds", "name": "SQLQueryStatus", "pid": 14117, "thread": "MainThread", "ts": "2023-08-08T13:08:54.388596Z"}}
{"data": {"msg": "Elementary: {}"}, "info": {"category": "", "code": "I062", "extra": {}, "invocation_id": "1dab847d-1f18-4b51-b746-f7b62baf1be1", "level": "info", "msg": "Elementary: {}", "name": "JinjaLogInfo", "pid": 14117, "thread": "MainThread", "ts": "2023-08-08T13:08:54.392505Z"}}
{"data": {"conn_name": "macro_log_macro_results"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "1dab847d-1f18-4b51-b746-f7b62baf1be1", "level": "debug", "msg": "On macro_log_macro_results: Close", "name": "ConnectionClosed", "pid": 14117, "thread": "MainThread", "ts": "2023-08-08T13:08:54.392822Z"}}
{"data": {"command": "dbt run-operation", "completed_at": "2023-08-08T13:08:54.393596Z", "elapsed": 0.34991768, "success": true}, "info": {"category": "", "code": "Q039", "extra": {}, "invocation_id": "1dab847d-1f18-4b51-b746-f7b62baf1be1", "level": "debug", "msg": "Command `dbt run-operation` succeeded at 16:08:54.393596 after 0.35 seconds", "name": "CommandCompleted", "pid": 14117, "thread": "MainThread", "ts": "2023-08-08T13:08:54.393649Z"}}
{"data": {"conn_name": "macro_log_macro_results"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "1dab847d-1f18-4b51-b746-f7b62baf1be1", "level": "debug", "msg": "Connection 'macro_log_macro_results' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 14117, "thread": "MainThread", "ts": "2023-08-08T13:08:54.393917Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fcd4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108120940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a34daf0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "1dab847d-1f18-4b51-b746-f7b62baf1be1", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fcd4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108120940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a34daf0>]}", "name": "SendingEvent", "pid": 14117, "thread": "MainThread", "ts": "2023-08-08T13:08:54.394150Z"}}
{"data": {}, "info": {"category": "", "code": "Z042", "extra": {}, "invocation_id": "1dab847d-1f18-4b51-b746-f7b62baf1be1", "level": "debug", "msg": "Flushing usage events", "name": "FlushEvents", "pid": 14117, "thread": "MainThread", "ts": "2023-08-08T13:08:54.394395Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1016895e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041570d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104157be0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "f78d6164-b21e-44d7-9dca-6fcee2924dad", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1016895e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041570d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104157be0>]}", "name": "SendingEvent", "pid": 14123, "thread": "MainThread", "ts": "2023-08-08T13:08:56.144240Z"}}
{"data": {"log_version": 3, "version": "=1.6.0"}, "info": {"category": "", "code": "A001", "extra": {}, "invocation_id": "f78d6164-b21e-44d7-9dca-6fcee2924dad", "level": "info", "msg": "Running with dbt=1.6.0", "name": "MainReportVersion", "pid": 14123, "thread": "MainThread", "ts": "2023-08-08T13:08:56.146160Z"}}
{"data": {"args": {"cache_selected_only": "False", "debug": "False", "fail_fast": "False", "indirect_selection": "eager", "introspect": "True", "invocation_command": "dbt --log-format json run-operation elementary.log_macro_results --args {\"macro_name\": \"get_pending_model_alerts\", \"macro_args\": {\"days_back\": 1}} --project-dir /Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/elementary/monitor/dbt_project", "log_cache_events": "False", "log_format": "json", "log_path": "/Users/ofek/workspace/test_dbt/edr_target", "no_print": "None", "partial_parse": "True", "printer_width": "80", "profiles_dir": "/Users/ofek/.dbt", "quiet": "False", "send_anonymous_usage_stats": "True", "static_parser": "True", "target_path": "None", "use_colors": "True", "use_experimental_parser": "False", "version_check": "True", "warn_error": "None", "warn_error_options": "WarnErrorOptions(include=[], exclude=[])", "write_json": "True"}}, "info": {"category": "", "code": "A002", "extra": {}, "invocation_id": "f78d6164-b21e-44d7-9dca-6fcee2924dad", "level": "debug", "msg": "running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/ofek/.dbt', 'log_path': '/Users/ofek/workspace/test_dbt/edr_target', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt --log-format json run-operation elementary.log_macro_results --args {\"macro_name\": \"get_pending_model_alerts\", \"macro_args\": {\"days_back\": 1}} --project-dir /Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/elementary/monitor/dbt_project', 'target_path': 'None', 'log_format': 'json', 'send_anonymous_usage_stats': 'True'}", "name": "MainReportArgs", "pid": 14123, "thread": "MainThread", "ts": "2023-08-08T13:08:56.146527Z"}}
{"data": {"profile_name": "elementary", "target_name": "default"}, "info": {"category": "", "code": "A005", "extra": {}, "invocation_id": "f78d6164-b21e-44d7-9dca-6fcee2924dad", "level": "info", "msg": "target not specified in profile 'elementary', using 'default'", "name": "MissingProfileTarget", "pid": 14123, "thread": "MainThread", "ts": "2023-08-08T13:08:56.162524Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'project_id', 'label': 'f78d6164-b21e-44d7-9dca-6fcee2924dad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1037dfc70>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "f78d6164-b21e-44d7-9dca-6fcee2924dad", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f78d6164-b21e-44d7-9dca-6fcee2924dad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1037dfc70>]}", "name": "SendingEvent", "pid": 14123, "thread": "MainThread", "ts": "2023-08-08T13:08:56.299080Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'adapter_info', 'label': 'f78d6164-b21e-44d7-9dca-6fcee2924dad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105479e80>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "f78d6164-b21e-44d7-9dca-6fcee2924dad", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f78d6164-b21e-44d7-9dca-6fcee2924dad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105479e80>]}", "name": "SendingEvent", "pid": 14123, "thread": "MainThread", "ts": "2023-08-08T13:08:56.304703Z"}}
{"data": {"adapter_name": "postgres", "adapter_version": "=1.6.0"}, "info": {"category": "", "code": "E034", "extra": {}, "invocation_id": "f78d6164-b21e-44d7-9dca-6fcee2924dad", "level": "info", "msg": "Registered adapter: postgres=1.6.0", "name": "AdapterRegistered", "pid": 14123, "thread": "MainThread", "ts": "2023-08-08T13:08:56.305109Z"}}
{"data": {"checksum": "08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9", "profile": "", "target": "", "vars": "{}", "version": "1.6.0"}, "info": {"category": "", "code": "I025", "extra": {}, "invocation_id": "f78d6164-b21e-44d7-9dca-6fcee2924dad", "level": "debug", "msg": "checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0", "name": "StateCheckVarsHash", "pid": 14123, "thread": "MainThread", "ts": "2023-08-08T13:08:56.317493Z"}}
{"data": {"added": 0, "changed": 0, "deleted": 0}, "info": {"category": "", "code": "I040", "extra": {}, "invocation_id": "f78d6164-b21e-44d7-9dca-6fcee2924dad", "level": "debug", "msg": "Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.", "name": "PartialParsingEnabled", "pid": 14123, "thread": "MainThread", "ts": "2023-08-08T13:08:56.397399Z"}}
{"data": {}, "info": {"category": "", "code": "I017", "extra": {}, "invocation_id": "f78d6164-b21e-44d7-9dca-6fcee2924dad", "level": "debug", "msg": "Partial parsing enabled, no changes found, skipping parsing", "name": "PartialParsingSkipParsing", "pid": 14123, "thread": "MainThread", "ts": "2023-08-08T13:08:56.397689Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'load_project', 'label': 'f78d6164-b21e-44d7-9dca-6fcee2924dad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059c30d0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "f78d6164-b21e-44d7-9dca-6fcee2924dad", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f78d6164-b21e-44d7-9dca-6fcee2924dad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059c30d0>]}", "name": "SendingEvent", "pid": 14123, "thread": "MainThread", "ts": "2023-08-08T13:08:56.403012Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'resource_counts', 'label': 'f78d6164-b21e-44d7-9dca-6fcee2924dad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10596c7c0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "f78d6164-b21e-44d7-9dca-6fcee2924dad", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f78d6164-b21e-44d7-9dca-6fcee2924dad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10596c7c0>]}", "name": "SendingEvent", "pid": 14123, "thread": "MainThread", "ts": "2023-08-08T13:08:56.418482Z"}}
{"data": {"stat_line": "34 models, 2 operations, 6 tests, 6 sources, 0 exposures, 0 metrics, 1101 macros, 0 groups, 0 semantic models"}, "info": {"category": "", "code": "W006", "extra": {}, "invocation_id": "f78d6164-b21e-44d7-9dca-6fcee2924dad", "level": "info", "msg": "Found 34 models, 2 operations, 6 tests, 6 sources, 0 exposures, 0 metrics, 1101 macros, 0 groups, 0 semantic models", "name": "FoundStats", "pid": 14123, "thread": "MainThread", "ts": "2023-08-08T13:08:56.418785Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'runnable_timing', 'label': 'f78d6164-b21e-44d7-9dca-6fcee2924dad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105442400>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "f78d6164-b21e-44d7-9dca-6fcee2924dad", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f78d6164-b21e-44d7-9dca-6fcee2924dad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105442400>]}", "name": "SendingEvent", "pid": 14123, "thread": "MainThread", "ts": "2023-08-08T13:08:56.419034Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "f78d6164-b21e-44d7-9dca-6fcee2924dad", "level": "debug", "msg": "Acquiring new postgres connection 'macro_log_macro_results'", "name": "NewConnection", "pid": 14123, "thread": "MainThread", "ts": "2023-08-08T13:08:56.419460Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "f78d6164-b21e-44d7-9dca-6fcee2924dad", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 14123, "thread": "MainThread", "ts": "2023-08-08T13:08:56.419705Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "BEGIN"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "f78d6164-b21e-44d7-9dca-6fcee2924dad", "level": "debug", "msg": "On macro_log_macro_results: BEGIN", "name": "SQLQuery", "pid": 14123, "thread": "MainThread", "ts": "2023-08-08T13:08:56.419924Z"}}
{"data": {"connection_state": "init"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "f78d6164-b21e-44d7-9dca-6fcee2924dad", "level": "debug", "msg": "Opening a new connection, currently in state init", "name": "NewConnectionOpening", "pid": 14123, "thread": "MainThread", "ts": "2023-08-08T13:08:56.420136Z"}}
{"data": {"elapsed": 0.0, "status": "BEGIN"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "f78d6164-b21e-44d7-9dca-6fcee2924dad", "level": "debug", "msg": "SQL status: BEGIN in 0.0 seconds", "name": "SQLQueryStatus", "pid": 14123, "thread": "MainThread", "ts": "2023-08-08T13:08:56.438579Z"}}
{"data": {"conn_name": "macro_log_macro_results"}, "info": {"category": "", "code": "E018", "extra": {}, "invocation_id": "f78d6164-b21e-44d7-9dca-6fcee2924dad", "level": "debug", "msg": "On macro_log_macro_results: COMMIT", "name": "SQLCommit", "pid": 14123, "thread": "MainThread", "ts": "2023-08-08T13:08:56.438871Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "f78d6164-b21e-44d7-9dca-6fcee2924dad", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 14123, "thread": "MainThread", "ts": "2023-08-08T13:08:56.439121Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "COMMIT"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "f78d6164-b21e-44d7-9dca-6fcee2924dad", "level": "debug", "msg": "On macro_log_macro_results: COMMIT", "name": "SQLQuery", "pid": 14123, "thread": "MainThread", "ts": "2023-08-08T13:08:56.439361Z"}}
{"data": {"elapsed": 0.0, "status": "COMMIT"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "f78d6164-b21e-44d7-9dca-6fcee2924dad", "level": "debug", "msg": "SQL status: COMMIT in 0.0 seconds", "name": "SQLQueryStatus", "pid": 14123, "thread": "MainThread", "ts": "2023-08-08T13:08:56.440344Z"}}
{"data": {"conn_name": "macro_log_macro_results", "database": "dbt", "schema": "local_analytics_elementary"}, "info": {"category": "", "code": "E013", "extra": {}, "invocation_id": "f78d6164-b21e-44d7-9dca-6fcee2924dad", "level": "debug", "msg": "On \"macro_log_macro_results\": cache miss for schema \"dbt.local_analytics_elementary\", this is inefficient", "name": "CacheMiss", "pid": 14123, "thread": "MainThread", "ts": "2023-08-08T13:08:56.453684Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "f78d6164-b21e-44d7-9dca-6fcee2924dad", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 14123, "thread": "MainThread", "ts": "2023-08-08T13:08:56.460271Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "BEGIN"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "f78d6164-b21e-44d7-9dca-6fcee2924dad", "level": "debug", "msg": "On macro_log_macro_results: BEGIN", "name": "SQLQuery", "pid": 14123, "thread": "MainThread", "ts": "2023-08-08T13:08:56.460544Z"}}
{"data": {"elapsed": 0.0, "status": "BEGIN"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "f78d6164-b21e-44d7-9dca-6fcee2924dad", "level": "debug", "msg": "SQL status: BEGIN in 0.0 seconds", "name": "SQLQueryStatus", "pid": 14123, "thread": "MainThread", "ts": "2023-08-08T13:08:56.461258Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "f78d6164-b21e-44d7-9dca-6fcee2924dad", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 14123, "thread": "MainThread", "ts": "2023-08-08T13:08:56.461491Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.6.0\", \"profile_name\": \"elementary\", \"target_name\": \"default\", \"connection_name\": \"macro_log_macro_results\"} */\nselect\n      'dbt' as database,\n      tablename as name,\n      schemaname as schema,\n      'table' as type\n    from pg_tables\n    where schemaname ilike 'local_analytics_elementary'\n    union all\n    select\n      'dbt' as database,\n      viewname as name,\n      schemaname as schema,\n      'view' as type\n    from pg_views\n    where schemaname ilike 'local_analytics_elementary'\n    union all\n    select\n      'dbt' as database,\n      matviewname as name,\n      schemaname as schema,\n      'materialized_view' as type\n    from pg_matviews\n    where schemaname ilike 'local_analytics_elementary'\n  "}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "f78d6164-b21e-44d7-9dca-6fcee2924dad", "level": "debug", "msg": "On macro_log_macro_results: /* {\"app\": \"dbt\", \"dbt_version\": \"1.6.0\", \"profile_name\": \"elementary\", \"target_name\": \"default\", \"connection_name\": \"macro_log_macro_results\"} */\nselect\n      'dbt' as database,\n      tablename as name,\n      schemaname as schema,\n      'table' as type\n    from pg_tables\n    where schemaname ilike 'local_analytics_elementary'\n    union all\n    select\n      'dbt' as database,\n      viewname as name,\n      schemaname as schema,\n      'view' as type\n    from pg_views\n    where schemaname ilike 'local_analytics_elementary'\n    union all\n    select\n      'dbt' as database,\n      matviewname as name,\n      schemaname as schema,\n      'materialized_view' as type\n    from pg_matviews\n    where schemaname ilike 'local_analytics_elementary'\n  ", "name": "SQLQuery", "pid": 14123, "thread": "MainThread", "ts": "2023-08-08T13:08:56.461724Z"}}
{"data": {"elapsed": 0.0, "status": "SELECT 32"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "f78d6164-b21e-44d7-9dca-6fcee2924dad", "level": "debug", "msg": "SQL status: SELECT 32 in 0.0 seconds", "name": "SQLQueryStatus", "pid": 14123, "thread": "MainThread", "ts": "2023-08-08T13:08:56.472659Z"}}
{"data": {"database": "dbt", "relations": [{"database": "dbt", "identifier": "data_monitoring_metrics", "schema": "local_analytics_elementary"}, {"database": "dbt", "identifier": "dbt_models", "schema": "local_analytics_elementary"}, {"database": "dbt", "identifier": "dbt_source_freshness_results", "schema": "local_analytics_elementary"}, {"database": "dbt", "identifier": "elementary_test_results", "schema": "local_analytics_elementary"}, {"database": "dbt", "identifier": "dbt_exposures", "schema": "local_analytics_elementary"}, {"database": "dbt", "identifier": "dbt_run_results", "schema": "local_analytics_elementary"}, {"database": "dbt", "identifier": "dbt_sources", "schema": "local_analytics_elementary"}, {"database": "dbt", "identifier": "dbt_seeds", "schema": "local_analytics_elementary"}, {"database": "dbt", "identifier": "dbt_invocations", "schema": "local_analytics_elementary"}, {"database": "dbt", "identifier": "schema_columns_snapshot", "schema": "local_analytics_elementary"}, {"database": "dbt", "identifier": "dbt_metrics", "schema": "local_analytics_elementary"}, {"database": "dbt", "identifier": "dbt_snapshots", "schema": "local_analytics_elementary"}, {"database": "dbt", "identifier": "dbt_tests", "schema": "local_analytics_elementary"}, {"database": "dbt", "identifier": "test_result_rows", "schema": "local_analytics_elementary"}, {"database": "dbt", "identifier": "metadata", "schema": "local_analytics_elementary"}, {"database": "dbt", "identifier": "alerts", "schema": "local_analytics_elementary"}, {"database": "dbt", "identifier": "alerts_models", "schema": "local_analytics_elementary"}, {"database": "dbt", "identifier": "alerts_source_freshness", "schema": "local_analytics_elementary"}, {"database": "dbt", "identifier": "job_run_results", "schema": "local_analytics_elementary"}, {"database": "dbt", "identifier": "alerts_schema_changes", "schema": "local_analytics_elementary"}, {"database": "dbt", "identifier": "model_run_results", "schema": "local_analytics_elementary"}, {"database": "dbt", "identifier": "snapshot_run_results", "schema": "local_analytics_elementary"}, {"database": "dbt", "identifier": "anomaly_threshold_sensitivity", "schema": "local_analytics_elementary"}, {"database": "dbt", "identifier": "filtered_information_schema_columns", "schema": "local_analytics_elementary"}, {"database": "dbt", "identifier": "alerts_dbt_source_freshness", "schema": "local_analytics_elementary"}, {"database": "dbt", "identifier": "alerts_dbt_models", "schema": "local_analytics_elementary"}, {"database": "dbt", "identifier": "dbt_columns", "schema": "local_analytics_elementary"}, {"database": "dbt", "identifier": "dbt_artifacts_hashes", "schema": "local_analytics_elementary"}, {"database": "dbt", "identifier": "metrics_anomaly_score", "schema": "local_analytics_elementary"}, {"database": "dbt", "identifier": "alerts_anomaly_detection", "schema": "local_analytics_elementary"}, {"database": "dbt", "identifier": "monitors_runs", "schema": "local_analytics_elementary"}, {"database": "dbt", "identifier": "alerts_dbt_tests", "schema": "local_analytics_elementary"}], "schema": "local_analytics_elementary"}, "info": {"category": "", "code": "E014", "extra": {}, "invocation_id": "f78d6164-b21e-44d7-9dca-6fcee2924dad", "level": "debug", "msg": "While listing relations in database=dbt, schema=local_analytics_elementary, found: data_monitoring_metrics, dbt_models, dbt_source_freshness_results, elementary_test_results, dbt_exposures, dbt_run_results, dbt_sources, dbt_seeds, dbt_invocations, schema_columns_snapshot, dbt_metrics, dbt_snapshots, dbt_tests, test_result_rows, metadata, alerts, alerts_models, alerts_source_freshness, job_run_results, alerts_schema_changes, model_run_results, snapshot_run_results, anomaly_threshold_sensitivity, filtered_information_schema_columns, alerts_dbt_source_freshness, alerts_dbt_models, dbt_columns, dbt_artifacts_hashes, metrics_anomaly_score, alerts_anomaly_detection, monitors_runs, alerts_dbt_tests", "name": "ListRelations", "pid": 14123, "thread": "MainThread", "ts": "2023-08-08T13:08:56.476147Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "f78d6164-b21e-44d7-9dca-6fcee2924dad", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 14123, "thread": "MainThread", "ts": "2023-08-08T13:08:56.493464Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.6.0\", \"profile_name\": \"elementary\", \"target_name\": \"default\", \"connection_name\": \"macro_log_macro_results\"} */\n\n    \n        with alerts_in_time_limit as (\n            select *\n            from \"dbt\".\"local_analytics_elementary\".\"alerts_models\"\n            where cast(detected_at as TIMESTAMP) >= cast(\n\n    date_trunc('day', \n    current_timestamp::TIMESTAMP\n) + ((interval '1 day') * (-1))\n\n as TIMESTAMP)\n        ),\n\n        models as (\n            select * from \"dbt\".\"local_analytics_elementary\".\"dbt_models\"\n        ),\n\n        \n            snapshots as (\n                select * from \"dbt\".\"local_analytics_elementary\".\"dbt_snapshots\"\n            ),\n        \n\n        artifacts_meta as (\n            select unique_id, meta from models\n            \n                union all\n                select unique_id, meta from \"dbt\".\"local_analytics_elementary\".\"dbt_snapshots\"\n            \n        ),\n\n        extended_alerts as (\n            select\n                alerts_in_time_limit.alert_id,\n                alerts_in_time_limit.unique_id,\n                \n                alerts_in_time_limit.unique_id as alert_class_id,\n                alerts_in_time_limit.detected_at,\n                alerts_in_time_limit.database_name,\n                alerts_in_time_limit.materialization,\n                alerts_in_time_limit.path,\n                alerts_in_time_limit.original_path,\n                alerts_in_time_limit.schema_name,\n                alerts_in_time_limit.message,\n                alerts_in_time_limit.owners,\n                alerts_in_time_limit.tags,\n                alerts_in_time_limit.alias,\n                alerts_in_time_limit.status,\n                alerts_in_time_limit.full_refresh,\n                \n                case\n                    when alerts_in_time_limit.suppression_status is NULL and alerts_in_time_limit.alert_sent = TRUE then 'sent'\n                    when alerts_in_time_limit.suppression_status is NULL and alerts_in_time_limit.alert_sent = FALSE then 'pending'\n                    else suppression_status\n                end as suppression_status,\n                alerts_in_time_limit.sent_at,\n                artifacts_meta.meta as model_meta\n            from alerts_in_time_limit\n            left join models on alerts_in_time_limit.unique_id = models.unique_id\n            left join artifacts_meta on alerts_in_time_limit.unique_id = artifacts_meta.unique_id\n        )\n\n        select *\n        from extended_alerts\n        where suppression_status = 'pending'\n    \n  "}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "f78d6164-b21e-44d7-9dca-6fcee2924dad", "level": "debug", "msg": "On macro_log_macro_results: /* {\"app\": \"dbt\", \"dbt_version\": \"1.6.0\", \"profile_name\": \"elementary\", \"target_name\": \"default\", \"connection_name\": \"macro_log_macro_results\"} */\n\n    \n        with alerts_in_time_limit as (\n            select *\n            from \"dbt\".\"local_analytics_elementary\".\"alerts_models\"\n            where cast(detected_at as TIMESTAMP) >= cast(\n\n    date_trunc('day', \n    current_timestamp::TIMESTAMP\n) + ((interval '1 day') * (-1))\n\n as TIMESTAMP)\n        ),\n\n        models as (\n            select * from \"dbt\".\"local_analytics_elementary\".\"dbt_models\"\n        ),\n\n        \n            snapshots as (\n                select * from \"dbt\".\"local_analytics_elementary\".\"dbt_snapshots\"\n            ),\n        \n\n        artifacts_meta as (\n            select unique_id, meta from models\n            \n                union all\n                select unique_id, meta from \"dbt\".\"local_analytics_elementary\".\"dbt_snapshots\"\n            \n        ),\n\n        extended_alerts as (\n            select\n                alerts_in_time_limit.alert_id,\n                alerts_in_time_limit.unique_id,\n                \n                alerts_in_time_limit.unique_id as alert_class_id,\n                alerts_in_time_limit.detected_at,\n                alerts_in_time_limit.database_name,\n                alerts_in_time_limit.materialization,\n                alerts_in_time_limit.path,\n                alerts_in_time_limit.original_path,\n                alerts_in_time_limit.schema_name,\n                alerts_in_time_limit.message,\n                alerts_in_time_limit.owners,\n                alerts_in_time_limit.tags,\n                alerts_in_time_limit.alias,\n                alerts_in_time_limit.status,\n                alerts_in_time_limit.full_refresh,\n                \n                case\n                    when alerts_in_time_limit.suppression_status is NULL and alerts_in_time_limit.alert_sent = TRUE then 'sent'\n                    when alerts_in_time_limit.suppression_status is NULL and alerts_in_time_limit.alert_sent = FALSE then 'pending'\n                    else suppression_status\n                end as suppression_status,\n                alerts_in_time_limit.sent_at,\n                artifacts_meta.meta as model_meta\n            from alerts_in_time_limit\n            left join models on alerts_in_time_limit.unique_id = models.unique_id\n            left join artifacts_meta on alerts_in_time_limit.unique_id = artifacts_meta.unique_id\n        )\n\n        select *\n        from extended_alerts\n        where suppression_status = 'pending'\n    \n  ", "name": "SQLQuery", "pid": 14123, "thread": "MainThread", "ts": "2023-08-08T13:08:56.493795Z"}}
{"data": {"elapsed": 0.0, "status": "SELECT 7"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "f78d6164-b21e-44d7-9dca-6fcee2924dad", "level": "debug", "msg": "SQL status: SELECT 7 in 0.0 seconds", "name": "SQLQueryStatus", "pid": 14123, "thread": "MainThread", "ts": "2023-08-08T13:08:56.503235Z"}}
{"data": {"msg": "Elementary: [{\"id\": \"55c59901-7d0a-4af1-bbdd-203d138a6d5f.model.test_dbt.stg_customers\", \"model_unique_id\": \"model.test_dbt.stg_customers\", \"alert_class_id\": \"model.test_dbt.stg_customers\", \"alias\": \"stg_customers\", \"path\": \"staging/stg_customers.sql\", \"original_path\": \"models/staging/stg_customers.sql\", \"materialization\": \"view\", \"detected_at\": \"2023-08-07 11:46:58\", \"database_name\": \"dbt\", \"schema_name\": \"local_analytics\", \"full_refresh\": false, \"message\": \"Database Error in model stg_customers (models/staging/stg_customers.sql)\\n  column \\\"id\\\" does not exist\\n  LINE 8:     id as customer_id,\\n              ^\\n  compiled Code at target/run/test_dbt/models/staging/stg_customers.sql\", \"owners\": \"[]\", \"tags\": \"[\\\"critical-tag\\\"]\", \"model_meta\": \"{}\", \"suppression_status\": \"pending\", \"sent_at\": null, \"status\": \"error\"}, {\"id\": \"14bdfa6a-a9a3-4903-a012-1649623274ce.model.test_dbt.stg_customers\", \"model_unique_id\": \"model.test_dbt.stg_customers\", \"alert_class_id\": \"model.test_dbt.stg_customers\", \"alias\": \"stg_customers\", \"path\": \"staging/stg_customers.sql\", \"original_path\": \"models/staging/stg_customers.sql\", \"materialization\": \"view\", \"detected_at\": \"2023-08-07 11:47:58\", \"database_name\": \"dbt\", \"schema_name\": \"local_analytics\", \"full_refresh\": false, \"message\": \"Database Error in model stg_customers (models/staging/stg_customers.sql)\\n  column \\\"id\\\" does not exist\\n  LINE 8:     id as customer_id,\\n              ^\\n  compiled Code at target/run/test_dbt/models/staging/stg_customers.sql\", \"owners\": \"[]\", \"tags\": \"[\\\"critical-tag\\\"]\", \"model_meta\": \"{}\", \"suppression_status\": \"pending\", \"sent_at\": null, \"status\": \"error\"}, {\"id\": \"55c59901-7d0a-4af1-bbdd-203d138a6d5f.model.test_dbt.stg_payments\", \"model_unique_id\": \"model.test_dbt.stg_payments\", \"alert_class_id\": \"model.test_dbt.stg_payments\", \"alias\": \"stg_payments\", \"path\": \"staging/stg_payments.sql\", \"original_path\": \"models/staging/stg_payments.sql\", \"materialization\": \"view\", \"detected_at\": \"2023-08-07 11:46:58\", \"database_name\": \"dbt\", \"schema_name\": \"local_analytics\", \"full_refresh\": false, \"message\": \"Database Error in model stg_payments (models/staging/stg_payments.sql)\\n  relation \\\"local_analytics.payment\\\" does not exist\\n  LINE 15: from \\\"dbt\\\".\\\"local_analytics\\\".\\\"payment\\\"\\n                ^\\n  compiled Code at target/run/test_dbt/models/staging/stg_payments.sql\", \"owners\": \"[]\", \"tags\": \"[]\", \"model_meta\": \"{}\", \"suppression_status\": \"pending\", \"sent_at\": null, \"status\": \"error\"}, {\"id\": \"14bdfa6a-a9a3-4903-a012-1649623274ce.model.test_dbt.stg_payments\", \"model_unique_id\": \"model.test_dbt.stg_payments\", \"alert_class_id\": \"model.test_dbt.stg_payments\", \"alias\": \"stg_payments\", \"path\": \"staging/stg_payments.sql\", \"original_path\": \"models/staging/stg_payments.sql\", \"materialization\": \"view\", \"detected_at\": \"2023-08-07 11:47:58\", \"database_name\": \"dbt\", \"schema_name\": \"local_analytics\", \"full_refresh\": false, \"message\": \"Database Error in model stg_payments (models/staging/stg_payments.sql)\\n  column \\\"id\\\" does not exist\\n  LINE 8:     id as payment_id,\\n              ^\\n  compiled Code at target/run/test_dbt/models/staging/stg_payments.sql\", \"owners\": \"[]\", \"tags\": \"[]\", \"model_meta\": \"{}\", \"suppression_status\": \"pending\", \"sent_at\": null, \"status\": \"error\"}, {\"id\": \"55c59901-7d0a-4af1-bbdd-203d138a6d5f.model.test_dbt.stg_orders\", \"model_unique_id\": \"model.test_dbt.stg_orders\", \"alert_class_id\": \"model.test_dbt.stg_orders\", \"alias\": \"stg_orders\", \"path\": \"staging/stg_orders.sql\", \"original_path\": \"models/staging/stg_orders.sql\", \"materialization\": \"view\", \"detected_at\": \"2023-08-07 11:46:58\", \"database_name\": \"dbt\", \"schema_name\": \"local_analytics\", \"full_refresh\": false, \"message\": \"Database Error in model stg_orders (models/staging/stg_orders.sql)\\n  column \\\"id\\\" does not exist\\n  LINE 8:     ID as order_id,\\n              ^\\n  compiled Code at target/run/test_dbt/models/staging/stg_orders.sql\", \"owners\": \"[]\", \"tags\": \"[]\", \"model_meta\": \"{}\", \"suppression_status\": \"pending\", \"sent_at\": null, \"status\": \"error\"}, {\"id\": \"14bdfa6a-a9a3-4903-a012-1649623274ce.model.test_dbt.stg_orders\", \"model_unique_id\": \"model.test_dbt.stg_orders\", \"alert_class_id\": \"model.test_dbt.stg_orders\", \"alias\": \"stg_orders\", \"path\": \"staging/stg_orders.sql\", \"original_path\": \"models/staging/stg_orders.sql\", \"materialization\": \"view\", \"detected_at\": \"2023-08-07 11:47:58\", \"database_name\": \"dbt\", \"schema_name\": \"local_analytics\", \"full_refresh\": false, \"message\": \"Database Error in model stg_orders (models/staging/stg_orders.sql)\\n  column \\\"id\\\" does not exist\\n  LINE 8:     ID as order_id,\\n              ^\\n  compiled Code at target/run/test_dbt/models/staging/stg_orders.sql\", \"owners\": \"[]\", \"tags\": \"[]\", \"model_meta\": \"{}\", \"suppression_status\": \"pending\", \"sent_at\": null, \"status\": \"error\"}, {\"id\": \"57d30c1c-49bd-470a-b15c-2c16362082be.model.test_dbt.stg_orders\", \"model_unique_id\": \"model.test_dbt.stg_orders\", \"alert_class_id\": \"model.test_dbt.stg_orders\", \"alias\": \"stg_orders\", \"path\": \"staging/stg_orders.sql\", \"original_path\": \"models/staging/stg_orders.sql\", \"materialization\": \"view\", \"detected_at\": \"2023-08-07 11:55:59\", \"database_name\": \"dbt\", \"schema_name\": \"local_analytics\", \"full_refresh\": false, \"message\": \"Database Error in model stg_orders (models/staging/stg_orders.sql)\\n  syntax error at or near \\\"from\\\"\\n  LINE 13: from \\\"dbt\\\".\\\"local_analytics\\\".\\\"orders\\\"\\n           ^\\n  compiled Code at target/run/test_dbt/models/staging/stg_orders.sql\", \"owners\": \"[]\", \"tags\": \"[]\", \"model_meta\": \"{}\", \"suppression_status\": \"pending\", \"sent_at\": null, \"status\": \"error\"}]"}, "info": {"category": "", "code": "I062", "extra": {}, "invocation_id": "f78d6164-b21e-44d7-9dca-6fcee2924dad", "level": "info", "msg": "Elementary: [{\"id\": \"55c59901-7d0a-4af1-bbdd-203d138a6d5f.model.test_dbt.stg_customers\", \"model_unique_id\": \"model.test_dbt.stg_customers\", \"alert_class_id\": \"model.test_dbt.stg_customers\", \"alias\": \"stg_customers\", \"path\": \"staging/stg_customers.sql\", \"original_path\": \"models/staging/stg_customers.sql\", \"materialization\": \"view\", \"detected_at\": \"2023-08-07 11:46:58\", \"database_name\": \"dbt\", \"schema_name\": \"local_analytics\", \"full_refresh\": false, \"message\": \"Database Error in model stg_customers (models/staging/stg_customers.sql)\\n  column \\\"id\\\" does not exist\\n  LINE 8:     id as customer_id,\\n              ^\\n  compiled Code at target/run/test_dbt/models/staging/stg_customers.sql\", \"owners\": \"[]\", \"tags\": \"[\\\"critical-tag\\\"]\", \"model_meta\": \"{}\", \"suppression_status\": \"pending\", \"sent_at\": null, \"status\": \"error\"}, {\"id\": \"14bdfa6a-a9a3-4903-a012-1649623274ce.model.test_dbt.stg_customers\", \"model_unique_id\": \"model.test_dbt.stg_customers\", \"alert_class_id\": \"model.test_dbt.stg_customers\", \"alias\": \"stg_customers\", \"path\": \"staging/stg_customers.sql\", \"original_path\": \"models/staging/stg_customers.sql\", \"materialization\": \"view\", \"detected_at\": \"2023-08-07 11:47:58\", \"database_name\": \"dbt\", \"schema_name\": \"local_analytics\", \"full_refresh\": false, \"message\": \"Database Error in model stg_customers (models/staging/stg_customers.sql)\\n  column \\\"id\\\" does not exist\\n  LINE 8:     id as customer_id,\\n              ^\\n  compiled Code at target/run/test_dbt/models/staging/stg_customers.sql\", \"owners\": \"[]\", \"tags\": \"[\\\"critical-tag\\\"]\", \"model_meta\": \"{}\", \"suppression_status\": \"pending\", \"sent_at\": null, \"status\": \"error\"}, {\"id\": \"55c59901-7d0a-4af1-bbdd-203d138a6d5f.model.test_dbt.stg_payments\", \"model_unique_id\": \"model.test_dbt.stg_payments\", \"alert_class_id\": \"model.test_dbt.stg_payments\", \"alias\": \"stg_payments\", \"path\": \"staging/stg_payments.sql\", \"original_path\": \"models/staging/stg_payments.sql\", \"materialization\": \"view\", \"detected_at\": \"2023-08-07 11:46:58\", \"database_name\": \"dbt\", \"schema_name\": \"local_analytics\", \"full_refresh\": false, \"message\": \"Database Error in model stg_payments (models/staging/stg_payments.sql)\\n  relation \\\"local_analytics.payment\\\" does not exist\\n  LINE 15: from \\\"dbt\\\".\\\"local_analytics\\\".\\\"payment\\\"\\n                ^\\n  compiled Code at target/run/test_dbt/models/staging/stg_payments.sql\", \"owners\": \"[]\", \"tags\": \"[]\", \"model_meta\": \"{}\", \"suppression_status\": \"pending\", \"sent_at\": null, \"status\": \"error\"}, {\"id\": \"14bdfa6a-a9a3-4903-a012-1649623274ce.model.test_dbt.stg_payments\", \"model_unique_id\": \"model.test_dbt.stg_payments\", \"alert_class_id\": \"model.test_dbt.stg_payments\", \"alias\": \"stg_payments\", \"path\": \"staging/stg_payments.sql\", \"original_path\": \"models/staging/stg_payments.sql\", \"materialization\": \"view\", \"detected_at\": \"2023-08-07 11:47:58\", \"database_name\": \"dbt\", \"schema_name\": \"local_analytics\", \"full_refresh\": false, \"message\": \"Database Error in model stg_payments (models/staging/stg_payments.sql)\\n  column \\\"id\\\" does not exist\\n  LINE 8:     id as payment_id,\\n              ^\\n  compiled Code at target/run/test_dbt/models/staging/stg_payments.sql\", \"owners\": \"[]\", \"tags\": \"[]\", \"model_meta\": \"{}\", \"suppression_status\": \"pending\", \"sent_at\": null, \"status\": \"error\"}, {\"id\": \"55c59901-7d0a-4af1-bbdd-203d138a6d5f.model.test_dbt.stg_orders\", \"model_unique_id\": \"model.test_dbt.stg_orders\", \"alert_class_id\": \"model.test_dbt.stg_orders\", \"alias\": \"stg_orders\", \"path\": \"staging/stg_orders.sql\", \"original_path\": \"models/staging/stg_orders.sql\", \"materialization\": \"view\", \"detected_at\": \"2023-08-07 11:46:58\", \"database_name\": \"dbt\", \"schema_name\": \"local_analytics\", \"full_refresh\": false, \"message\": \"Database Error in model stg_orders (models/staging/stg_orders.sql)\\n  column \\\"id\\\" does not exist\\n  LINE 8:     ID as order_id,\\n              ^\\n  compiled Code at target/run/test_dbt/models/staging/stg_orders.sql\", \"owners\": \"[]\", \"tags\": \"[]\", \"model_meta\": \"{}\", \"suppression_status\": \"pending\", \"sent_at\": null, \"status\": \"error\"}, {\"id\": \"14bdfa6a-a9a3-4903-a012-1649623274ce.model.test_dbt.stg_orders\", \"model_unique_id\": \"model.test_dbt.stg_orders\", \"alert_class_id\": \"model.test_dbt.stg_orders\", \"alias\": \"stg_orders\", \"path\": \"staging/stg_orders.sql\", \"original_path\": \"models/staging/stg_orders.sql\", \"materialization\": \"view\", \"detected_at\": \"2023-08-07 11:47:58\", \"database_name\": \"dbt\", \"schema_name\": \"local_analytics\", \"full_refresh\": false, \"message\": \"Database Error in model stg_orders (models/staging/stg_orders.sql)\\n  column \\\"id\\\" does not exist\\n  LINE 8:     ID as order_id,\\n              ^\\n  compiled Code at target/run/test_dbt/models/staging/stg_orders.sql\", \"owners\": \"[]\", \"tags\": \"[]\", \"model_meta\": \"{}\", \"suppression_status\": \"pending\", \"sent_at\": null, \"status\": \"error\"}, {\"id\": \"57d30c1c-49bd-470a-b15c-2c16362082be.model.test_dbt.stg_orders\", \"model_unique_id\": \"model.test_dbt.stg_orders\", \"alert_class_id\": \"model.test_dbt.stg_orders\", \"alias\": \"stg_orders\", \"path\": \"staging/stg_orders.sql\", \"original_path\": \"models/staging/stg_orders.sql\", \"materialization\": \"view\", \"detected_at\": \"2023-08-07 11:55:59\", \"database_name\": \"dbt\", \"schema_name\": \"local_analytics\", \"full_refresh\": false, \"message\": \"Database Error in model stg_orders (models/staging/stg_orders.sql)\\n  syntax error at or near \\\"from\\\"\\n  LINE 13: from \\\"dbt\\\".\\\"local_analytics\\\".\\\"orders\\\"\\n           ^\\n  compiled Code at target/run/test_dbt/models/staging/stg_orders.sql\", \"owners\": \"[]\", \"tags\": \"[]\", \"model_meta\": \"{}\", \"suppression_status\": \"pending\", \"sent_at\": null, \"status\": \"error\"}]", "name": "JinjaLogInfo", "pid": 14123, "thread": "MainThread", "ts": "2023-08-08T13:08:56.532396Z"}}
{"data": {"conn_name": "macro_log_macro_results"}, "info": {"category": "", "code": "E012", "extra": {}, "invocation_id": "f78d6164-b21e-44d7-9dca-6fcee2924dad", "level": "debug", "msg": "On macro_log_macro_results: ROLLBACK", "name": "Rollback", "pid": 14123, "thread": "MainThread", "ts": "2023-08-08T13:08:56.532939Z"}}
{"data": {"conn_name": "macro_log_macro_results"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "f78d6164-b21e-44d7-9dca-6fcee2924dad", "level": "debug", "msg": "On macro_log_macro_results: Close", "name": "ConnectionClosed", "pid": 14123, "thread": "MainThread", "ts": "2023-08-08T13:08:56.534821Z"}}
{"data": {"command": "dbt run-operation", "completed_at": "2023-08-08T13:08:56.535621Z", "elapsed": 0.40180713, "success": true}, "info": {"category": "", "code": "Q039", "extra": {}, "invocation_id": "f78d6164-b21e-44d7-9dca-6fcee2924dad", "level": "debug", "msg": "Command `dbt run-operation` succeeded at 16:08:56.535621 after 0.40 seconds", "name": "CommandCompleted", "pid": 14123, "thread": "MainThread", "ts": "2023-08-08T13:08:56.535671Z"}}
{"data": {"conn_name": "macro_log_macro_results"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "f78d6164-b21e-44d7-9dca-6fcee2924dad", "level": "debug", "msg": "Connection 'macro_log_macro_results' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 14123, "thread": "MainThread", "ts": "2023-08-08T13:08:56.535915Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1016895e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10552c220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105479e50>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "f78d6164-b21e-44d7-9dca-6fcee2924dad", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1016895e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10552c220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105479e50>]}", "name": "SendingEvent", "pid": 14123, "thread": "MainThread", "ts": "2023-08-08T13:08:56.536132Z"}}
{"data": {}, "info": {"category": "", "code": "Z042", "extra": {}, "invocation_id": "f78d6164-b21e-44d7-9dca-6fcee2924dad", "level": "debug", "msg": "Flushing usage events", "name": "FlushEvents", "pid": 14123, "thread": "MainThread", "ts": "2023-08-08T13:08:56.536367Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041dd5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dd2280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dd2be0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "938e02ea-c80f-49f7-a3ac-ffe5c6503fb9", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041dd5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dd2280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dd2be0>]}", "name": "SendingEvent", "pid": 14129, "thread": "MainThread", "ts": "2023-08-08T13:08:58.297863Z"}}
{"data": {"log_version": 3, "version": "=1.6.0"}, "info": {"category": "", "code": "A001", "extra": {}, "invocation_id": "938e02ea-c80f-49f7-a3ac-ffe5c6503fb9", "level": "info", "msg": "Running with dbt=1.6.0", "name": "MainReportVersion", "pid": 14129, "thread": "MainThread", "ts": "2023-08-08T13:08:58.299968Z"}}
{"data": {"args": {"cache_selected_only": "False", "debug": "False", "fail_fast": "False", "indirect_selection": "eager", "introspect": "True", "invocation_command": "dbt --log-format json run-operation elementary.log_macro_results --args {\"macro_name\": \"get_last_model_alert_sent_times\", \"macro_args\": {\"days_back\": 1}} --project-dir /Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/elementary/monitor/dbt_project", "log_cache_events": "False", "log_format": "json", "log_path": "/Users/ofek/workspace/test_dbt/edr_target", "no_print": "None", "partial_parse": "True", "printer_width": "80", "profiles_dir": "/Users/ofek/.dbt", "quiet": "False", "send_anonymous_usage_stats": "True", "static_parser": "True", "target_path": "None", "use_colors": "True", "use_experimental_parser": "False", "version_check": "True", "warn_error": "None", "warn_error_options": "WarnErrorOptions(include=[], exclude=[])", "write_json": "True"}}, "info": {"category": "", "code": "A002", "extra": {}, "invocation_id": "938e02ea-c80f-49f7-a3ac-ffe5c6503fb9", "level": "debug", "msg": "running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ofek/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/ofek/workspace/test_dbt/edr_target', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --log-format json run-operation elementary.log_macro_results --args {\"macro_name\": \"get_last_model_alert_sent_times\", \"macro_args\": {\"days_back\": 1}} --project-dir /Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/elementary/monitor/dbt_project', 'introspect': 'True', 'log_format': 'json', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}", "name": "MainReportArgs", "pid": 14129, "thread": "MainThread", "ts": "2023-08-08T13:08:58.300331Z"}}
{"data": {"profile_name": "elementary", "target_name": "default"}, "info": {"category": "", "code": "A005", "extra": {}, "invocation_id": "938e02ea-c80f-49f7-a3ac-ffe5c6503fb9", "level": "info", "msg": "target not specified in profile 'elementary', using 'default'", "name": "MissingProfileTarget", "pid": 14129, "thread": "MainThread", "ts": "2023-08-08T13:08:58.316926Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'project_id', 'label': '938e02ea-c80f-49f7-a3ac-ffe5c6503fb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106333c70>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "938e02ea-c80f-49f7-a3ac-ffe5c6503fb9", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '938e02ea-c80f-49f7-a3ac-ffe5c6503fb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106333c70>]}", "name": "SendingEvent", "pid": 14129, "thread": "MainThread", "ts": "2023-08-08T13:08:58.454443Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'adapter_info', 'label': '938e02ea-c80f-49f7-a3ac-ffe5c6503fb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083f5e80>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "938e02ea-c80f-49f7-a3ac-ffe5c6503fb9", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '938e02ea-c80f-49f7-a3ac-ffe5c6503fb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083f5e80>]}", "name": "SendingEvent", "pid": 14129, "thread": "MainThread", "ts": "2023-08-08T13:08:58.459966Z"}}
{"data": {"adapter_name": "postgres", "adapter_version": "=1.6.0"}, "info": {"category": "", "code": "E034", "extra": {}, "invocation_id": "938e02ea-c80f-49f7-a3ac-ffe5c6503fb9", "level": "info", "msg": "Registered adapter: postgres=1.6.0", "name": "AdapterRegistered", "pid": 14129, "thread": "MainThread", "ts": "2023-08-08T13:08:58.460373Z"}}
{"data": {"checksum": "08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9", "profile": "", "target": "", "vars": "{}", "version": "1.6.0"}, "info": {"category": "", "code": "I025", "extra": {}, "invocation_id": "938e02ea-c80f-49f7-a3ac-ffe5c6503fb9", "level": "debug", "msg": "checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0", "name": "StateCheckVarsHash", "pid": 14129, "thread": "MainThread", "ts": "2023-08-08T13:08:58.472906Z"}}
{"data": {"added": 0, "changed": 0, "deleted": 0}, "info": {"category": "", "code": "I040", "extra": {}, "invocation_id": "938e02ea-c80f-49f7-a3ac-ffe5c6503fb9", "level": "debug", "msg": "Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.", "name": "PartialParsingEnabled", "pid": 14129, "thread": "MainThread", "ts": "2023-08-08T13:08:58.551797Z"}}
{"data": {}, "info": {"category": "", "code": "I017", "extra": {}, "invocation_id": "938e02ea-c80f-49f7-a3ac-ffe5c6503fb9", "level": "debug", "msg": "Partial parsing enabled, no changes found, skipping parsing", "name": "PartialParsingSkipParsing", "pid": 14129, "thread": "MainThread", "ts": "2023-08-08T13:08:58.552118Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'load_project', 'label': '938e02ea-c80f-49f7-a3ac-ffe5c6503fb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a3f0d0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "938e02ea-c80f-49f7-a3ac-ffe5c6503fb9", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '938e02ea-c80f-49f7-a3ac-ffe5c6503fb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a3f0d0>]}", "name": "SendingEvent", "pid": 14129, "thread": "MainThread", "ts": "2023-08-08T13:08:58.557409Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'resource_counts', 'label': '938e02ea-c80f-49f7-a3ac-ffe5c6503fb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089e9760>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "938e02ea-c80f-49f7-a3ac-ffe5c6503fb9", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '938e02ea-c80f-49f7-a3ac-ffe5c6503fb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089e9760>]}", "name": "SendingEvent", "pid": 14129, "thread": "MainThread", "ts": "2023-08-08T13:08:58.574180Z"}}
{"data": {"stat_line": "34 models, 2 operations, 6 tests, 6 sources, 0 exposures, 0 metrics, 1101 macros, 0 groups, 0 semantic models"}, "info": {"category": "", "code": "W006", "extra": {}, "invocation_id": "938e02ea-c80f-49f7-a3ac-ffe5c6503fb9", "level": "info", "msg": "Found 34 models, 2 operations, 6 tests, 6 sources, 0 exposures, 0 metrics, 1101 macros, 0 groups, 0 semantic models", "name": "FoundStats", "pid": 14129, "thread": "MainThread", "ts": "2023-08-08T13:08:58.574482Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'runnable_timing', 'label': '938e02ea-c80f-49f7-a3ac-ffe5c6503fb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089e9b50>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "938e02ea-c80f-49f7-a3ac-ffe5c6503fb9", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '938e02ea-c80f-49f7-a3ac-ffe5c6503fb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089e9b50>]}", "name": "SendingEvent", "pid": 14129, "thread": "MainThread", "ts": "2023-08-08T13:08:58.574728Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "938e02ea-c80f-49f7-a3ac-ffe5c6503fb9", "level": "debug", "msg": "Acquiring new postgres connection 'macro_log_macro_results'", "name": "NewConnection", "pid": 14129, "thread": "MainThread", "ts": "2023-08-08T13:08:58.575157Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "938e02ea-c80f-49f7-a3ac-ffe5c6503fb9", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 14129, "thread": "MainThread", "ts": "2023-08-08T13:08:58.575413Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "BEGIN"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "938e02ea-c80f-49f7-a3ac-ffe5c6503fb9", "level": "debug", "msg": "On macro_log_macro_results: BEGIN", "name": "SQLQuery", "pid": 14129, "thread": "MainThread", "ts": "2023-08-08T13:08:58.575636Z"}}
{"data": {"connection_state": "init"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "938e02ea-c80f-49f7-a3ac-ffe5c6503fb9", "level": "debug", "msg": "Opening a new connection, currently in state init", "name": "NewConnectionOpening", "pid": 14129, "thread": "MainThread", "ts": "2023-08-08T13:08:58.575860Z"}}
{"data": {"elapsed": 0.0, "status": "BEGIN"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "938e02ea-c80f-49f7-a3ac-ffe5c6503fb9", "level": "debug", "msg": "SQL status: BEGIN in 0.0 seconds", "name": "SQLQueryStatus", "pid": 14129, "thread": "MainThread", "ts": "2023-08-08T13:08:58.594245Z"}}
{"data": {"conn_name": "macro_log_macro_results"}, "info": {"category": "", "code": "E018", "extra": {}, "invocation_id": "938e02ea-c80f-49f7-a3ac-ffe5c6503fb9", "level": "debug", "msg": "On macro_log_macro_results: COMMIT", "name": "SQLCommit", "pid": 14129, "thread": "MainThread", "ts": "2023-08-08T13:08:58.594544Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "938e02ea-c80f-49f7-a3ac-ffe5c6503fb9", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 14129, "thread": "MainThread", "ts": "2023-08-08T13:08:58.594793Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "COMMIT"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "938e02ea-c80f-49f7-a3ac-ffe5c6503fb9", "level": "debug", "msg": "On macro_log_macro_results: COMMIT", "name": "SQLQuery", "pid": 14129, "thread": "MainThread", "ts": "2023-08-08T13:08:58.595027Z"}}
{"data": {"elapsed": 0.0, "status": "COMMIT"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "938e02ea-c80f-49f7-a3ac-ffe5c6503fb9", "level": "debug", "msg": "SQL status: COMMIT in 0.0 seconds", "name": "SQLQueryStatus", "pid": 14129, "thread": "MainThread", "ts": "2023-08-08T13:08:58.595851Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "938e02ea-c80f-49f7-a3ac-ffe5c6503fb9", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 14129, "thread": "MainThread", "ts": "2023-08-08T13:08:58.622222Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.6.0\", \"profile_name\": \"elementary\", \"target_name\": \"default\", \"connection_name\": \"macro_log_macro_results\"} */\n\n    \n        with alerts_in_time_limit as (\n            select\n                unique_id as alert_class_id,\n                case\n                    when suppression_status is NULL and alert_sent = TRUE then 'sent'\n                    when suppression_status is NULL and alert_sent = FALSE then 'pending'\n                    else suppression_status\n                end as suppression_status,\n                sent_at\n            from \"dbt\".\"local_analytics_elementary\".\"alerts_models\"\n            where cast(detected_at as TIMESTAMP) >= cast(\n\n    date_trunc('day', \n    current_timestamp::TIMESTAMP\n) + ((interval '1 day') * (-1))\n\n as TIMESTAMP)\n        )\n\n        select \n            alert_class_id,\n            max(sent_at) as last_sent_at\n        from alerts_in_time_limit\n        where suppression_status = 'sent'\n        group by alert_class_id\n    \n  "}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "938e02ea-c80f-49f7-a3ac-ffe5c6503fb9", "level": "debug", "msg": "On macro_log_macro_results: /* {\"app\": \"dbt\", \"dbt_version\": \"1.6.0\", \"profile_name\": \"elementary\", \"target_name\": \"default\", \"connection_name\": \"macro_log_macro_results\"} */\n\n    \n        with alerts_in_time_limit as (\n            select\n                unique_id as alert_class_id,\n                case\n                    when suppression_status is NULL and alert_sent = TRUE then 'sent'\n                    when suppression_status is NULL and alert_sent = FALSE then 'pending'\n                    else suppression_status\n                end as suppression_status,\n                sent_at\n            from \"dbt\".\"local_analytics_elementary\".\"alerts_models\"\n            where cast(detected_at as TIMESTAMP) >= cast(\n\n    date_trunc('day', \n    current_timestamp::TIMESTAMP\n) + ((interval '1 day') * (-1))\n\n as TIMESTAMP)\n        )\n\n        select \n            alert_class_id,\n            max(sent_at) as last_sent_at\n        from alerts_in_time_limit\n        where suppression_status = 'sent'\n        group by alert_class_id\n    \n  ", "name": "SQLQuery", "pid": 14129, "thread": "MainThread", "ts": "2023-08-08T13:08:58.622523Z"}}
{"data": {"elapsed": 0.0, "status": "SELECT 0"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "938e02ea-c80f-49f7-a3ac-ffe5c6503fb9", "level": "debug", "msg": "SQL status: SELECT 0 in 0.0 seconds", "name": "SQLQueryStatus", "pid": 14129, "thread": "MainThread", "ts": "2023-08-08T13:08:58.630737Z"}}
{"data": {"msg": "Elementary: {}"}, "info": {"category": "", "code": "I062", "extra": {}, "invocation_id": "938e02ea-c80f-49f7-a3ac-ffe5c6503fb9", "level": "info", "msg": "Elementary: {}", "name": "JinjaLogInfo", "pid": 14129, "thread": "MainThread", "ts": "2023-08-08T13:08:58.634588Z"}}
{"data": {"conn_name": "macro_log_macro_results"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "938e02ea-c80f-49f7-a3ac-ffe5c6503fb9", "level": "debug", "msg": "On macro_log_macro_results: Close", "name": "ConnectionClosed", "pid": 14129, "thread": "MainThread", "ts": "2023-08-08T13:08:58.634924Z"}}
{"data": {"command": "dbt run-operation", "completed_at": "2023-08-08T13:08:58.635673Z", "elapsed": 0.34868592, "success": true}, "info": {"category": "", "code": "Q039", "extra": {}, "invocation_id": "938e02ea-c80f-49f7-a3ac-ffe5c6503fb9", "level": "debug", "msg": "Command `dbt run-operation` succeeded at 16:08:58.635673 after 0.35 seconds", "name": "CommandCompleted", "pid": 14129, "thread": "MainThread", "ts": "2023-08-08T13:08:58.635728Z"}}
{"data": {"conn_name": "macro_log_macro_results"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "938e02ea-c80f-49f7-a3ac-ffe5c6503fb9", "level": "debug", "msg": "Connection 'macro_log_macro_results' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 14129, "thread": "MainThread", "ts": "2023-08-08T13:08:58.635989Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041dd5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083f5e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083bf400>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "938e02ea-c80f-49f7-a3ac-ffe5c6503fb9", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041dd5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083f5e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083bf400>]}", "name": "SendingEvent", "pid": 14129, "thread": "MainThread", "ts": "2023-08-08T13:08:58.636221Z"}}
{"data": {}, "info": {"category": "", "code": "Z042", "extra": {}, "invocation_id": "938e02ea-c80f-49f7-a3ac-ffe5c6503fb9", "level": "debug", "msg": "Flushing usage events", "name": "FlushEvents", "pid": 14129, "thread": "MainThread", "ts": "2023-08-08T13:08:58.636470Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bf55e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10868d790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086cb250>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "6624ee62-6d45-44ef-9890-5495c99c0013", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bf55e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10868d790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086cb250>]}", "name": "SendingEvent", "pid": 14137, "thread": "MainThread", "ts": "2023-08-08T13:09:00.383394Z"}}
{"data": {"log_version": 3, "version": "=1.6.0"}, "info": {"category": "", "code": "A001", "extra": {}, "invocation_id": "6624ee62-6d45-44ef-9890-5495c99c0013", "level": "info", "msg": "Running with dbt=1.6.0", "name": "MainReportVersion", "pid": 14137, "thread": "MainThread", "ts": "2023-08-08T13:09:00.385355Z"}}
{"data": {"args": {"cache_selected_only": "False", "debug": "False", "fail_fast": "False", "indirect_selection": "eager", "introspect": "True", "invocation_command": "dbt --log-format json run-operation elementary.log_macro_results --args {\"macro_name\": \"get_pending_source_freshness_alerts\", \"macro_args\": {\"days_back\": 1}} --project-dir /Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/elementary/monitor/dbt_project", "log_cache_events": "False", "log_format": "json", "log_path": "/Users/ofek/workspace/test_dbt/edr_target", "no_print": "None", "partial_parse": "True", "printer_width": "80", "profiles_dir": "/Users/ofek/.dbt", "quiet": "False", "send_anonymous_usage_stats": "True", "static_parser": "True", "target_path": "None", "use_colors": "True", "use_experimental_parser": "False", "version_check": "True", "warn_error": "None", "warn_error_options": "WarnErrorOptions(include=[], exclude=[])", "write_json": "True"}}, "info": {"category": "", "code": "A002", "extra": {}, "invocation_id": "6624ee62-6d45-44ef-9890-5495c99c0013", "level": "debug", "msg": "running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/ofek/workspace/test_dbt/edr_target', 'fail_fast': 'False', 'profiles_dir': '/Users/ofek/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'json', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt --log-format json run-operation elementary.log_macro_results --args {\"macro_name\": \"get_pending_source_freshness_alerts\", \"macro_args\": {\"days_back\": 1}} --project-dir /Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/elementary/monitor/dbt_project', 'send_anonymous_usage_stats': 'True'}", "name": "MainReportArgs", "pid": 14137, "thread": "MainThread", "ts": "2023-08-08T13:09:00.385716Z"}}
{"data": {"profile_name": "elementary", "target_name": "default"}, "info": {"category": "", "code": "A005", "extra": {}, "invocation_id": "6624ee62-6d45-44ef-9890-5495c99c0013", "level": "info", "msg": "target not specified in profile 'elementary', using 'default'", "name": "MissingProfileTarget", "pid": 14137, "thread": "MainThread", "ts": "2023-08-08T13:09:00.401808Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'project_id', 'label': '6624ee62-6d45-44ef-9890-5495c99c0013', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086cb250>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "6624ee62-6d45-44ef-9890-5495c99c0013", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6624ee62-6d45-44ef-9890-5495c99c0013', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086cb250>]}", "name": "SendingEvent", "pid": 14137, "thread": "MainThread", "ts": "2023-08-08T13:09:00.537555Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'adapter_info', 'label': '6624ee62-6d45-44ef-9890-5495c99c0013', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099e4e50>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "6624ee62-6d45-44ef-9890-5495c99c0013", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6624ee62-6d45-44ef-9890-5495c99c0013', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099e4e50>]}", "name": "SendingEvent", "pid": 14137, "thread": "MainThread", "ts": "2023-08-08T13:09:00.543161Z"}}
{"data": {"adapter_name": "postgres", "adapter_version": "=1.6.0"}, "info": {"category": "", "code": "E034", "extra": {}, "invocation_id": "6624ee62-6d45-44ef-9890-5495c99c0013", "level": "info", "msg": "Registered adapter: postgres=1.6.0", "name": "AdapterRegistered", "pid": 14137, "thread": "MainThread", "ts": "2023-08-08T13:09:00.543524Z"}}
{"data": {"checksum": "08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9", "profile": "", "target": "", "vars": "{}", "version": "1.6.0"}, "info": {"category": "", "code": "I025", "extra": {}, "invocation_id": "6624ee62-6d45-44ef-9890-5495c99c0013", "level": "debug", "msg": "checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0", "name": "StateCheckVarsHash", "pid": 14137, "thread": "MainThread", "ts": "2023-08-08T13:09:00.555963Z"}}
{"data": {"added": 0, "changed": 0, "deleted": 0}, "info": {"category": "", "code": "I040", "extra": {}, "invocation_id": "6624ee62-6d45-44ef-9890-5495c99c0013", "level": "debug", "msg": "Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.", "name": "PartialParsingEnabled", "pid": 14137, "thread": "MainThread", "ts": "2023-08-08T13:09:00.634682Z"}}
{"data": {}, "info": {"category": "", "code": "I017", "extra": {}, "invocation_id": "6624ee62-6d45-44ef-9890-5495c99c0013", "level": "debug", "msg": "Partial parsing enabled, no changes found, skipping parsing", "name": "PartialParsingSkipParsing", "pid": 14137, "thread": "MainThread", "ts": "2023-08-08T13:09:00.634990Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'load_project', 'label': '6624ee62-6d45-44ef-9890-5495c99c0013', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f300d0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "6624ee62-6d45-44ef-9890-5495c99c0013", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6624ee62-6d45-44ef-9890-5495c99c0013', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f300d0>]}", "name": "SendingEvent", "pid": 14137, "thread": "MainThread", "ts": "2023-08-08T13:09:00.640174Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'resource_counts', 'label': '6624ee62-6d45-44ef-9890-5495c99c0013', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ed8790>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "6624ee62-6d45-44ef-9890-5495c99c0013", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6624ee62-6d45-44ef-9890-5495c99c0013', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ed8790>]}", "name": "SendingEvent", "pid": 14137, "thread": "MainThread", "ts": "2023-08-08T13:09:00.655852Z"}}
{"data": {"stat_line": "34 models, 2 operations, 6 tests, 6 sources, 0 exposures, 0 metrics, 1101 macros, 0 groups, 0 semantic models"}, "info": {"category": "", "code": "W006", "extra": {}, "invocation_id": "6624ee62-6d45-44ef-9890-5495c99c0013", "level": "info", "msg": "Found 34 models, 2 operations, 6 tests, 6 sources, 0 exposures, 0 metrics, 1101 macros, 0 groups, 0 semantic models", "name": "FoundStats", "pid": 14137, "thread": "MainThread", "ts": "2023-08-08T13:09:00.656152Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'runnable_timing', 'label': '6624ee62-6d45-44ef-9890-5495c99c0013', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099af3d0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "6624ee62-6d45-44ef-9890-5495c99c0013", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6624ee62-6d45-44ef-9890-5495c99c0013', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099af3d0>]}", "name": "SendingEvent", "pid": 14137, "thread": "MainThread", "ts": "2023-08-08T13:09:00.656400Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "6624ee62-6d45-44ef-9890-5495c99c0013", "level": "debug", "msg": "Acquiring new postgres connection 'macro_log_macro_results'", "name": "NewConnection", "pid": 14137, "thread": "MainThread", "ts": "2023-08-08T13:09:00.656817Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "6624ee62-6d45-44ef-9890-5495c99c0013", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 14137, "thread": "MainThread", "ts": "2023-08-08T13:09:00.657059Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "BEGIN"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "6624ee62-6d45-44ef-9890-5495c99c0013", "level": "debug", "msg": "On macro_log_macro_results: BEGIN", "name": "SQLQuery", "pid": 14137, "thread": "MainThread", "ts": "2023-08-08T13:09:00.657273Z"}}
{"data": {"connection_state": "init"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "6624ee62-6d45-44ef-9890-5495c99c0013", "level": "debug", "msg": "Opening a new connection, currently in state init", "name": "NewConnectionOpening", "pid": 14137, "thread": "MainThread", "ts": "2023-08-08T13:09:00.657485Z"}}
{"data": {"elapsed": 0.0, "status": "BEGIN"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "6624ee62-6d45-44ef-9890-5495c99c0013", "level": "debug", "msg": "SQL status: BEGIN in 0.0 seconds", "name": "SQLQueryStatus", "pid": 14137, "thread": "MainThread", "ts": "2023-08-08T13:09:00.677100Z"}}
{"data": {"conn_name": "macro_log_macro_results"}, "info": {"category": "", "code": "E018", "extra": {}, "invocation_id": "6624ee62-6d45-44ef-9890-5495c99c0013", "level": "debug", "msg": "On macro_log_macro_results: COMMIT", "name": "SQLCommit", "pid": 14137, "thread": "MainThread", "ts": "2023-08-08T13:09:00.677436Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "6624ee62-6d45-44ef-9890-5495c99c0013", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 14137, "thread": "MainThread", "ts": "2023-08-08T13:09:00.677700Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "COMMIT"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "6624ee62-6d45-44ef-9890-5495c99c0013", "level": "debug", "msg": "On macro_log_macro_results: COMMIT", "name": "SQLQuery", "pid": 14137, "thread": "MainThread", "ts": "2023-08-08T13:09:00.677957Z"}}
{"data": {"elapsed": 0.0, "status": "COMMIT"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "6624ee62-6d45-44ef-9890-5495c99c0013", "level": "debug", "msg": "SQL status: COMMIT in 0.0 seconds", "name": "SQLQueryStatus", "pid": 14137, "thread": "MainThread", "ts": "2023-08-08T13:09:00.679119Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "6624ee62-6d45-44ef-9890-5495c99c0013", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 14137, "thread": "MainThread", "ts": "2023-08-08T13:09:00.709409Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.6.0\", \"profile_name\": \"elementary\", \"target_name\": \"default\", \"connection_name\": \"macro_log_macro_results\"} */\n\n    \n        with alerts_in_time_limit as (\n            select * from \"dbt\".\"local_analytics_elementary\".\"alerts_source_freshness\"\n            where cast(detected_at as TIMESTAMP) >= cast(\n\n    date_trunc('day', \n    current_timestamp::TIMESTAMP\n) + ((interval '1 day') * (-1))\n\n as TIMESTAMP)\n        ),\n\n        models as (\n            select * from \"dbt\".\"local_analytics_elementary\".\"dbt_models\"\n        ),\n\n        sources as (\n            select * from \"dbt\".\"local_analytics_elementary\".\"dbt_sources\"\n        ),\n\n        artifacts_meta as (\n            select unique_id, meta from models\n            union all\n            select unique_id, meta from sources\n        ),\n\n        extended_alerts as (\n            select\n                alerts_in_time_limit.alert_id,\n                alerts_in_time_limit.max_loaded_at,\n                alerts_in_time_limit.snapshotted_at,\n                alerts_in_time_limit.detected_at,\n                alerts_in_time_limit.max_loaded_at_time_ago_in_s,\n                alerts_in_time_limit.status,\n                alerts_in_time_limit.error,\n                alerts_in_time_limit.unique_id,\n                \n                alerts_in_time_limit.unique_id as alert_class_id,\n                alerts_in_time_limit.database_name,\n                alerts_in_time_limit.schema_name,\n                alerts_in_time_limit.source_name,\n                alerts_in_time_limit.identifier,\n                alerts_in_time_limit.freshness_error_after,\n                alerts_in_time_limit.freshness_warn_after,\n                alerts_in_time_limit.freshness_filter,\n                alerts_in_time_limit.tags,\n                alerts_in_time_limit.meta,\n                alerts_in_time_limit.owner,\n                alerts_in_time_limit.package_name,\n                alerts_in_time_limit.path,\n                \n                case\n                    when alerts_in_time_limit.suppression_status is NULL and alerts_in_time_limit.alert_sent = TRUE then 'sent'\n                    when alerts_in_time_limit.suppression_status is NULL and alerts_in_time_limit.alert_sent = FALSE then 'pending'\n                    else suppression_status\n                end as suppression_status,\n                alerts_in_time_limit.sent_at,\n                artifacts_meta.meta as model_meta \n            from alerts_in_time_limit\n            left join artifacts_meta on alerts_in_time_limit.unique_id = artifacts_meta.unique_id\n        )\n\n        select *\n        from extended_alerts\n        where suppression_status = 'pending'\n    \n  "}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "6624ee62-6d45-44ef-9890-5495c99c0013", "level": "debug", "msg": "On macro_log_macro_results: /* {\"app\": \"dbt\", \"dbt_version\": \"1.6.0\", \"profile_name\": \"elementary\", \"target_name\": \"default\", \"connection_name\": \"macro_log_macro_results\"} */\n\n    \n        with alerts_in_time_limit as (\n            select * from \"dbt\".\"local_analytics_elementary\".\"alerts_source_freshness\"\n            where cast(detected_at as TIMESTAMP) >= cast(\n\n    date_trunc('day', \n    current_timestamp::TIMESTAMP\n) + ((interval '1 day') * (-1))\n\n as TIMESTAMP)\n        ),\n\n        models as (\n            select * from \"dbt\".\"local_analytics_elementary\".\"dbt_models\"\n        ),\n\n        sources as (\n            select * from \"dbt\".\"local_analytics_elementary\".\"dbt_sources\"\n        ),\n\n        artifacts_meta as (\n            select unique_id, meta from models\n            union all\n            select unique_id, meta from sources\n        ),\n\n        extended_alerts as (\n            select\n                alerts_in_time_limit.alert_id,\n                alerts_in_time_limit.max_loaded_at,\n                alerts_in_time_limit.snapshotted_at,\n                alerts_in_time_limit.detected_at,\n                alerts_in_time_limit.max_loaded_at_time_ago_in_s,\n                alerts_in_time_limit.status,\n                alerts_in_time_limit.error,\n                alerts_in_time_limit.unique_id,\n                \n                alerts_in_time_limit.unique_id as alert_class_id,\n                alerts_in_time_limit.database_name,\n                alerts_in_time_limit.schema_name,\n                alerts_in_time_limit.source_name,\n                alerts_in_time_limit.identifier,\n                alerts_in_time_limit.freshness_error_after,\n                alerts_in_time_limit.freshness_warn_after,\n                alerts_in_time_limit.freshness_filter,\n                alerts_in_time_limit.tags,\n                alerts_in_time_limit.meta,\n                alerts_in_time_limit.owner,\n                alerts_in_time_limit.package_name,\n                alerts_in_time_limit.path,\n                \n                case\n                    when alerts_in_time_limit.suppression_status is NULL and alerts_in_time_limit.alert_sent = TRUE then 'sent'\n                    when alerts_in_time_limit.suppression_status is NULL and alerts_in_time_limit.alert_sent = FALSE then 'pending'\n                    else suppression_status\n                end as suppression_status,\n                alerts_in_time_limit.sent_at,\n                artifacts_meta.meta as model_meta \n            from alerts_in_time_limit\n            left join artifacts_meta on alerts_in_time_limit.unique_id = artifacts_meta.unique_id\n        )\n\n        select *\n        from extended_alerts\n        where suppression_status = 'pending'\n    \n  ", "name": "SQLQuery", "pid": 14137, "thread": "MainThread", "ts": "2023-08-08T13:09:00.709748Z"}}
{"data": {"elapsed": 0.0, "status": "SELECT 0"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "6624ee62-6d45-44ef-9890-5495c99c0013", "level": "debug", "msg": "SQL status: SELECT 0 in 0.0 seconds", "name": "SQLQueryStatus", "pid": 14137, "thread": "MainThread", "ts": "2023-08-08T13:09:00.720643Z"}}
{"data": {"msg": "Elementary: []"}, "info": {"category": "", "code": "I062", "extra": {}, "invocation_id": "6624ee62-6d45-44ef-9890-5495c99c0013", "level": "info", "msg": "Elementary: []", "name": "JinjaLogInfo", "pid": 14137, "thread": "MainThread", "ts": "2023-08-08T13:09:00.724841Z"}}
{"data": {"conn_name": "macro_log_macro_results"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "6624ee62-6d45-44ef-9890-5495c99c0013", "level": "debug", "msg": "On macro_log_macro_results: Close", "name": "ConnectionClosed", "pid": 14137, "thread": "MainThread", "ts": "2023-08-08T13:09:00.725155Z"}}
{"data": {"command": "dbt run-operation", "completed_at": "2023-08-08T13:09:00.725900Z", "elapsed": 0.35332808, "success": true}, "info": {"category": "", "code": "Q039", "extra": {}, "invocation_id": "6624ee62-6d45-44ef-9890-5495c99c0013", "level": "debug", "msg": "Command `dbt run-operation` succeeded at 16:09:00.725900 after 0.35 seconds", "name": "CommandCompleted", "pid": 14137, "thread": "MainThread", "ts": "2023-08-08T13:09:00.725955Z"}}
{"data": {"conn_name": "macro_log_macro_results"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "6624ee62-6d45-44ef-9890-5495c99c0013", "level": "debug", "msg": "Connection 'macro_log_macro_results' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 14137, "thread": "MainThread", "ts": "2023-08-08T13:09:00.726212Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bf55e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f70e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099e4e20>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "6624ee62-6d45-44ef-9890-5495c99c0013", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bf55e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f70e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099e4e20>]}", "name": "SendingEvent", "pid": 14137, "thread": "MainThread", "ts": "2023-08-08T13:09:00.726446Z"}}
{"data": {}, "info": {"category": "", "code": "Z042", "extra": {}, "invocation_id": "6624ee62-6d45-44ef-9890-5495c99c0013", "level": "debug", "msg": "Flushing usage events", "name": "FlushEvents", "pid": 14137, "thread": "MainThread", "ts": "2023-08-08T13:09:00.726694Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10211d970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bc07f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bf92b0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "1daf2eb8-f8bd-4fa8-b291-545a9e1aceb2", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10211d970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bc07f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bf92b0>]}", "name": "SendingEvent", "pid": 14143, "thread": "MainThread", "ts": "2023-08-08T13:09:02.499818Z"}}
{"data": {"log_version": 3, "version": "=1.6.0"}, "info": {"category": "", "code": "A001", "extra": {}, "invocation_id": "1daf2eb8-f8bd-4fa8-b291-545a9e1aceb2", "level": "info", "msg": "Running with dbt=1.6.0", "name": "MainReportVersion", "pid": 14143, "thread": "MainThread", "ts": "2023-08-08T13:09:02.501766Z"}}
{"data": {"args": {"cache_selected_only": "False", "debug": "False", "fail_fast": "False", "indirect_selection": "eager", "introspect": "True", "invocation_command": "dbt --log-format json run-operation elementary.log_macro_results --args {\"macro_name\": \"get_last_source_freshness_alert_sent_times\", \"macro_args\": {\"days_back\": 1}} --project-dir /Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/elementary/monitor/dbt_project", "log_cache_events": "False", "log_format": "json", "log_path": "/Users/ofek/workspace/test_dbt/edr_target", "no_print": "None", "partial_parse": "True", "printer_width": "80", "profiles_dir": "/Users/ofek/.dbt", "quiet": "False", "send_anonymous_usage_stats": "True", "static_parser": "True", "target_path": "None", "use_colors": "True", "use_experimental_parser": "False", "version_check": "True", "warn_error": "None", "warn_error_options": "WarnErrorOptions(include=[], exclude=[])", "write_json": "True"}}, "info": {"category": "", "code": "A002", "extra": {}, "invocation_id": "1daf2eb8-f8bd-4fa8-b291-545a9e1aceb2", "level": "debug", "msg": "running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ofek/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/ofek/workspace/test_dbt/edr_target', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --log-format json run-operation elementary.log_macro_results --args {\"macro_name\": \"get_last_source_freshness_alert_sent_times\", \"macro_args\": {\"days_back\": 1}} --project-dir /Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/elementary/monitor/dbt_project', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'json', 'send_anonymous_usage_stats': 'True'}", "name": "MainReportArgs", "pid": 14143, "thread": "MainThread", "ts": "2023-08-08T13:09:02.502139Z"}}
{"data": {"profile_name": "elementary", "target_name": "default"}, "info": {"category": "", "code": "A005", "extra": {}, "invocation_id": "1daf2eb8-f8bd-4fa8-b291-545a9e1aceb2", "level": "info", "msg": "target not specified in profile 'elementary', using 'default'", "name": "MissingProfileTarget", "pid": 14143, "thread": "MainThread", "ts": "2023-08-08T13:09:02.518495Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'project_id', 'label': '1daf2eb8-f8bd-4fa8-b291-545a9e1aceb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bf92b0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "1daf2eb8-f8bd-4fa8-b291-545a9e1aceb2", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1daf2eb8-f8bd-4fa8-b291-545a9e1aceb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bf92b0>]}", "name": "SendingEvent", "pid": 14143, "thread": "MainThread", "ts": "2023-08-08T13:09:02.658392Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'adapter_info', 'label': '1daf2eb8-f8bd-4fa8-b291-545a9e1aceb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f18eb0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "1daf2eb8-f8bd-4fa8-b291-545a9e1aceb2", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1daf2eb8-f8bd-4fa8-b291-545a9e1aceb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f18eb0>]}", "name": "SendingEvent", "pid": 14143, "thread": "MainThread", "ts": "2023-08-08T13:09:02.664171Z"}}
{"data": {"adapter_name": "postgres", "adapter_version": "=1.6.0"}, "info": {"category": "", "code": "E034", "extra": {}, "invocation_id": "1daf2eb8-f8bd-4fa8-b291-545a9e1aceb2", "level": "info", "msg": "Registered adapter: postgres=1.6.0", "name": "AdapterRegistered", "pid": 14143, "thread": "MainThread", "ts": "2023-08-08T13:09:02.664571Z"}}
{"data": {"checksum": "08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9", "profile": "", "target": "", "vars": "{}", "version": "1.6.0"}, "info": {"category": "", "code": "I025", "extra": {}, "invocation_id": "1daf2eb8-f8bd-4fa8-b291-545a9e1aceb2", "level": "debug", "msg": "checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0", "name": "StateCheckVarsHash", "pid": 14143, "thread": "MainThread", "ts": "2023-08-08T13:09:02.677151Z"}}
{"data": {"added": 0, "changed": 0, "deleted": 0}, "info": {"category": "", "code": "I040", "extra": {}, "invocation_id": "1daf2eb8-f8bd-4fa8-b291-545a9e1aceb2", "level": "debug", "msg": "Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.", "name": "PartialParsingEnabled", "pid": 14143, "thread": "MainThread", "ts": "2023-08-08T13:09:02.757074Z"}}
{"data": {}, "info": {"category": "", "code": "I017", "extra": {}, "invocation_id": "1daf2eb8-f8bd-4fa8-b291-545a9e1aceb2", "level": "debug", "msg": "Partial parsing enabled, no changes found, skipping parsing", "name": "PartialParsingSkipParsing", "pid": 14143, "thread": "MainThread", "ts": "2023-08-08T13:09:02.757366Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'load_project', 'label': '1daf2eb8-f8bd-4fa8-b291-545a9e1aceb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064630d0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "1daf2eb8-f8bd-4fa8-b291-545a9e1aceb2", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1daf2eb8-f8bd-4fa8-b291-545a9e1aceb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064630d0>]}", "name": "SendingEvent", "pid": 14143, "thread": "MainThread", "ts": "2023-08-08T13:09:02.762656Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'resource_counts', 'label': '1daf2eb8-f8bd-4fa8-b291-545a9e1aceb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10640b7f0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "1daf2eb8-f8bd-4fa8-b291-545a9e1aceb2", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1daf2eb8-f8bd-4fa8-b291-545a9e1aceb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10640b7f0>]}", "name": "SendingEvent", "pid": 14143, "thread": "MainThread", "ts": "2023-08-08T13:09:02.778685Z"}}
{"data": {"stat_line": "34 models, 2 operations, 6 tests, 6 sources, 0 exposures, 0 metrics, 1101 macros, 0 groups, 0 semantic models"}, "info": {"category": "", "code": "W006", "extra": {}, "invocation_id": "1daf2eb8-f8bd-4fa8-b291-545a9e1aceb2", "level": "info", "msg": "Found 34 models, 2 operations, 6 tests, 6 sources, 0 exposures, 0 metrics, 1101 macros, 0 groups, 0 semantic models", "name": "FoundStats", "pid": 14143, "thread": "MainThread", "ts": "2023-08-08T13:09:02.778986Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'runnable_timing', 'label': '1daf2eb8-f8bd-4fa8-b291-545a9e1aceb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ed2040>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "1daf2eb8-f8bd-4fa8-b291-545a9e1aceb2", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1daf2eb8-f8bd-4fa8-b291-545a9e1aceb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ed2040>]}", "name": "SendingEvent", "pid": 14143, "thread": "MainThread", "ts": "2023-08-08T13:09:02.779247Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "1daf2eb8-f8bd-4fa8-b291-545a9e1aceb2", "level": "debug", "msg": "Acquiring new postgres connection 'macro_log_macro_results'", "name": "NewConnection", "pid": 14143, "thread": "MainThread", "ts": "2023-08-08T13:09:02.779685Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "1daf2eb8-f8bd-4fa8-b291-545a9e1aceb2", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 14143, "thread": "MainThread", "ts": "2023-08-08T13:09:02.779936Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "BEGIN"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "1daf2eb8-f8bd-4fa8-b291-545a9e1aceb2", "level": "debug", "msg": "On macro_log_macro_results: BEGIN", "name": "SQLQuery", "pid": 14143, "thread": "MainThread", "ts": "2023-08-08T13:09:02.780150Z"}}
{"data": {"connection_state": "init"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "1daf2eb8-f8bd-4fa8-b291-545a9e1aceb2", "level": "debug", "msg": "Opening a new connection, currently in state init", "name": "NewConnectionOpening", "pid": 14143, "thread": "MainThread", "ts": "2023-08-08T13:09:02.780363Z"}}
{"data": {"elapsed": 0.0, "status": "BEGIN"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "1daf2eb8-f8bd-4fa8-b291-545a9e1aceb2", "level": "debug", "msg": "SQL status: BEGIN in 0.0 seconds", "name": "SQLQueryStatus", "pid": 14143, "thread": "MainThread", "ts": "2023-08-08T13:09:02.799874Z"}}
{"data": {"conn_name": "macro_log_macro_results"}, "info": {"category": "", "code": "E018", "extra": {}, "invocation_id": "1daf2eb8-f8bd-4fa8-b291-545a9e1aceb2", "level": "debug", "msg": "On macro_log_macro_results: COMMIT", "name": "SQLCommit", "pid": 14143, "thread": "MainThread", "ts": "2023-08-08T13:09:02.800252Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "1daf2eb8-f8bd-4fa8-b291-545a9e1aceb2", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 14143, "thread": "MainThread", "ts": "2023-08-08T13:09:02.800534Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "COMMIT"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "1daf2eb8-f8bd-4fa8-b291-545a9e1aceb2", "level": "debug", "msg": "On macro_log_macro_results: COMMIT", "name": "SQLQuery", "pid": 14143, "thread": "MainThread", "ts": "2023-08-08T13:09:02.800806Z"}}
{"data": {"elapsed": 0.0, "status": "COMMIT"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "1daf2eb8-f8bd-4fa8-b291-545a9e1aceb2", "level": "debug", "msg": "SQL status: COMMIT in 0.0 seconds", "name": "SQLQueryStatus", "pid": 14143, "thread": "MainThread", "ts": "2023-08-08T13:09:02.801866Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "1daf2eb8-f8bd-4fa8-b291-545a9e1aceb2", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 14143, "thread": "MainThread", "ts": "2023-08-08T13:09:02.828905Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.6.0\", \"profile_name\": \"elementary\", \"target_name\": \"default\", \"connection_name\": \"macro_log_macro_results\"} */\n\n    \n        with alerts_in_time_limit as (\n            select\n                unique_id as alert_class_id,\n                case\n                    when suppression_status is NULL and alert_sent = TRUE then 'sent'\n                    when suppression_status is NULL and alert_sent = FALSE then 'pending'\n                    else suppression_status\n                end as suppression_status,\n                sent_at\n            from \"dbt\".\"local_analytics_elementary\".\"alerts_source_freshness\"\n            where cast(detected_at as TIMESTAMP) >= cast(\n\n    date_trunc('day', \n    current_timestamp::TIMESTAMP\n) + ((interval '1 day') * (-1))\n\n as TIMESTAMP)\n        )\n\n        select \n            alert_class_id,\n            max(sent_at) as last_sent_at\n        from alerts_in_time_limit\n        where suppression_status = 'sent'\n        group by alert_class_id\n    \n  "}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "1daf2eb8-f8bd-4fa8-b291-545a9e1aceb2", "level": "debug", "msg": "On macro_log_macro_results: /* {\"app\": \"dbt\", \"dbt_version\": \"1.6.0\", \"profile_name\": \"elementary\", \"target_name\": \"default\", \"connection_name\": \"macro_log_macro_results\"} */\n\n    \n        with alerts_in_time_limit as (\n            select\n                unique_id as alert_class_id,\n                case\n                    when suppression_status is NULL and alert_sent = TRUE then 'sent'\n                    when suppression_status is NULL and alert_sent = FALSE then 'pending'\n                    else suppression_status\n                end as suppression_status,\n                sent_at\n            from \"dbt\".\"local_analytics_elementary\".\"alerts_source_freshness\"\n            where cast(detected_at as TIMESTAMP) >= cast(\n\n    date_trunc('day', \n    current_timestamp::TIMESTAMP\n) + ((interval '1 day') * (-1))\n\n as TIMESTAMP)\n        )\n\n        select \n            alert_class_id,\n            max(sent_at) as last_sent_at\n        from alerts_in_time_limit\n        where suppression_status = 'sent'\n        group by alert_class_id\n    \n  ", "name": "SQLQuery", "pid": 14143, "thread": "MainThread", "ts": "2023-08-08T13:09:02.829213Z"}}
{"data": {"elapsed": 0.0, "status": "SELECT 0"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "1daf2eb8-f8bd-4fa8-b291-545a9e1aceb2", "level": "debug", "msg": "SQL status: SELECT 0 in 0.0 seconds", "name": "SQLQueryStatus", "pid": 14143, "thread": "MainThread", "ts": "2023-08-08T13:09:02.837348Z"}}
{"data": {"msg": "Elementary: {}"}, "info": {"category": "", "code": "I062", "extra": {}, "invocation_id": "1daf2eb8-f8bd-4fa8-b291-545a9e1aceb2", "level": "info", "msg": "Elementary: {}", "name": "JinjaLogInfo", "pid": 14143, "thread": "MainThread", "ts": "2023-08-08T13:09:02.841324Z"}}
{"data": {"conn_name": "macro_log_macro_results"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "1daf2eb8-f8bd-4fa8-b291-545a9e1aceb2", "level": "debug", "msg": "On macro_log_macro_results: Close", "name": "ConnectionClosed", "pid": 14143, "thread": "MainThread", "ts": "2023-08-08T13:09:02.841630Z"}}
{"data": {"command": "dbt run-operation", "completed_at": "2023-08-08T13:09:02.842393Z", "elapsed": 0.3533666, "success": true}, "info": {"category": "", "code": "Q039", "extra": {}, "invocation_id": "1daf2eb8-f8bd-4fa8-b291-545a9e1aceb2", "level": "debug", "msg": "Command `dbt run-operation` succeeded at 16:09:02.842393 after 0.35 seconds", "name": "CommandCompleted", "pid": 14143, "thread": "MainThread", "ts": "2023-08-08T13:09:02.842448Z"}}
{"data": {"conn_name": "macro_log_macro_results"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "1daf2eb8-f8bd-4fa8-b291-545a9e1aceb2", "level": "debug", "msg": "Connection 'macro_log_macro_results' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 14143, "thread": "MainThread", "ts": "2023-08-08T13:09:02.842713Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10211d970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bf92b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f18eb0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "1daf2eb8-f8bd-4fa8-b291-545a9e1aceb2", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10211d970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bf92b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f18eb0>]}", "name": "SendingEvent", "pid": 14143, "thread": "MainThread", "ts": "2023-08-08T13:09:02.842945Z"}}
{"data": {}, "info": {"category": "", "code": "Z042", "extra": {}, "invocation_id": "1daf2eb8-f8bd-4fa8-b291-545a9e1aceb2", "level": "debug", "msg": "Flushing usage events", "name": "FlushEvents", "pid": 14143, "thread": "MainThread", "ts": "2023-08-08T13:09:02.843188Z"}}
[0m16:09:04.614604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101d20040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047ea160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047eac70>]}


============================== 16:09:04.616619 | 1e82d77e-00ea-4ecc-98b5-687550746f5e ==============================
[0m16:09:04.616619 [info ] [MainThread]: Running with dbt=1.6.0
[0m16:09:04.616967 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ofek/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/ofek/workspace/test_dbt/edr_target', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -s update_alerts.update_skipped_alerts --project-dir /Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/elementary/monitor/dbt_project --vars {"alert_ids": ["5e2e388e-e883-4989-8f54-0a5225805882.test.test_dbt.failing_test_stg_customers_last_name_last_name.847ec3eec4", "f9f8b46b-9ba6-4db8-b9a8-20a04cd01d5e.test.test_dbt.failing_test_stg_customers_last_name_last_name.847ec3eec4", "5ae5c1b9-bb50-4899-8860-56bae80936b6.test.test_dbt.failing_test_stg_customers_last_name_last_name.847ec3eec4", "ce2e4bf3-1071-4144-a060-4cbfc0edb4ff.test.test_dbt.failing_test_stg_customers_last_name_last_name.847ec3eec4", "82641d52-4826-40cf-994d-7339c5303164.test.test_dbt.failing_test_stg_customers_last_name_last_name.847ec3eec4", "9a47e226-16da-4111-bd02-ee802a0af48c.test.test_dbt.unique_stg_customers_last_name_last_name.0845e13bad", "a30fc06b-d642-44ed-95a6-dfd13be58b84.test.test_dbt.unique_stg_orders_order_id_customer_id.52431730b9", "a30fc06b-d642-44ed-95a6-dfd13be58b84.test.test_dbt.not_null_stg_orders_order_id_customer_id.a094c039ad", "80eeba1e-8527-416a-8d86-c42fc32450ac.test.test_dbt.source_unique_stripe_payment_id.3b7989ce64", "a30fc06b-d642-44ed-95a6-dfd13be58b84.test.test_dbt.source_unique_stripe_payment_id.3b7989ce64"], "table_name": "alerts"}', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:09:04.634533 [info ] [MainThread]: target not specified in profile 'elementary', using 'default'
[0m16:09:04.774269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1e82d77e-00ea-4ecc-98b5-687550746f5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e5c6a0>]}
[0m16:09:04.779910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1e82d77e-00ea-4ecc-98b5-687550746f5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106836f40>]}
[0m16:09:04.780233 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m16:09:04.793604 [debug] [MainThread]: checksum: f3f244f972752dcc91dbbde07158685e0a20d60d1f44cbd86a3b37cfc536cb7a, vars: {'alert_ids': ['5e2e388e-e883-4989-8f54-0a5225805882.test.test_dbt.failing_test_stg_customers_last_name_last_name.847ec3eec4',
               'f9f8b46b-9ba6-4db8-b9a8-20a04cd01d5e.test.test_dbt.failing_test_stg_customers_last_name_last_name.847ec3eec4',
               '5ae5c1b9-bb50-4899-8860-56bae80936b6.test.test_dbt.failing_test_stg_customers_last_name_last_name.847ec3eec4',
               'ce2e4bf3-1071-4144-a060-4cbfc0edb4ff.test.test_dbt.failing_test_stg_customers_last_name_last_name.847ec3eec4',
               '82641d52-4826-40cf-994d-7339c5303164.test.test_dbt.failing_test_stg_customers_last_name_last_name.847ec3eec4',
               '9a47e226-16da-4111-bd02-ee802a0af48c.test.test_dbt.unique_stg_customers_last_name_last_name.0845e13bad',
               'a30fc06b-d642-44ed-95a6-dfd13be58b84.test.test_dbt.unique_stg_orders_order_id_customer_id.52431730b9',
               'a30fc06b-d642-44ed-95a6-dfd13be58b84.test.test_dbt.not_null_stg_orders_order_id_customer_id.a094c039ad',
               '80eeba1e-8527-416a-8d86-c42fc32450ac.test.test_dbt.source_unique_stripe_payment_id.3b7989ce64',
               'a30fc06b-d642-44ed-95a6-dfd13be58b84.test.test_dbt.source_unique_stripe_payment_id.3b7989ce64'],
 'table_name': 'alerts'}, profile: , target: , version: 1.6.0
[0m16:09:04.830742 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m16:09:04.831048 [debug] [MainThread]: previous checksum: f3f244f972752dcc91dbbde07158685e0a20d60d1f44cbd86a3b37cfc536cb7a, current checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9
[0m16:09:04.831230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1e82d77e-00ea-4ecc-98b5-687550746f5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fcfe50>]}
[0m16:09:06.747120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1e82d77e-00ea-4ecc-98b5-687550746f5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a5f7f0>]}
[0m16:09:06.763162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1e82d77e-00ea-4ecc-98b5-687550746f5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10688d4c0>]}
[0m16:09:06.763441 [info ] [MainThread]: Found 34 models, 2 operations, 6 tests, 6 sources, 0 exposures, 0 metrics, 1101 macros, 0 groups, 0 semantic models
[0m16:09:06.763663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e82d77e-00ea-4ecc-98b5-687550746f5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10691bdf0>]}
[0m16:09:06.764459 [info ] [MainThread]: 
[0m16:09:06.764839 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:09:06.765374 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m16:09:06.771473 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m16:09:06.771683 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "elementary", "target_name": "default", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m16:09:06.771857 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:09:06.792021 [debug] [ThreadPool]: SQL status: SELECT 60 in 0.0 seconds
[0m16:09:06.792937 [debug] [ThreadPool]: On list_dbt: Close
[0m16:09:06.794474 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt, now list_dbt_local_analytics_elementary)
[0m16:09:06.798415 [debug] [ThreadPool]: Using postgres connection "list_dbt_local_analytics_elementary"
[0m16:09:06.798617 [debug] [ThreadPool]: On list_dbt_local_analytics_elementary: BEGIN
[0m16:09:06.798789 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:09:06.807453 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:09:06.807655 [debug] [ThreadPool]: Using postgres connection "list_dbt_local_analytics_elementary"
[0m16:09:06.807848 [debug] [ThreadPool]: On list_dbt_local_analytics_elementary: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "elementary", "target_name": "default", "connection_name": "list_dbt_local_analytics_elementary"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'local_analytics_elementary'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'local_analytics_elementary'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'local_analytics_elementary'
  
[0m16:09:06.812962 [debug] [ThreadPool]: SQL status: SELECT 32 in 0.0 seconds
[0m16:09:06.813970 [debug] [ThreadPool]: On list_dbt_local_analytics_elementary: ROLLBACK
[0m16:09:06.814735 [debug] [ThreadPool]: On list_dbt_local_analytics_elementary: Close
[0m16:09:06.821448 [debug] [MainThread]: Using postgres connection "master"
[0m16:09:06.821644 [debug] [MainThread]: On master: BEGIN
[0m16:09:06.821813 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:09:06.829157 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:09:06.829368 [debug] [MainThread]: Using postgres connection "master"
[0m16:09:06.829623 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "elementary", "target_name": "default", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:09:06.835616 [debug] [MainThread]: SQL status: SELECT 108 in 0.0 seconds
[0m16:09:06.840012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e82d77e-00ea-4ecc-98b5-687550746f5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a5f700>]}
[0m16:09:06.840282 [debug] [MainThread]: On master: ROLLBACK
[0m16:09:06.840822 [debug] [MainThread]: Using postgres connection "master"
[0m16:09:06.841012 [debug] [MainThread]: On master: BEGIN
[0m16:09:06.841954 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:09:06.842295 [debug] [MainThread]: On master: COMMIT
[0m16:09:06.842516 [debug] [MainThread]: Using postgres connection "master"
[0m16:09:06.842714 [debug] [MainThread]: On master: COMMIT
[0m16:09:06.843278 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:09:06.843529 [info ] [MainThread]: 
[0m16:09:06.843729 [info ] [MainThread]: Running 1 on-run-start hook
[0m16:09:06.846921 [debug] [MainThread]: Writing injected SQL for node "operation.elementary.elementary-on-run-start-0"
[0m16:09:06.847911 [info ] [MainThread]: 1 of 1 START hook: elementary.on-run-start.0 ................................... [RUN]
[0m16:09:06.848222 [info ] [MainThread]: 1 of 1 OK hook: elementary.on-run-start.0 ...................................... [[32mOK[0m in 0.00s]
[0m16:09:06.848430 [info ] [MainThread]: 
[0m16:09:06.848684 [debug] [MainThread]: On master: Close
[0m16:09:06.849073 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m16:09:06.849268 [info ] [MainThread]: 
[0m16:09:06.850331 [debug] [Thread-1  ]: Began running node model.elementary_internal.update_skipped_alerts
[0m16:09:06.850669 [info ] [Thread-1  ]: 1 of 1 START sql nothing model local_analytics_elementary.update_skipped_alerts  [RUN]
[0m16:09:06.851100 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt_local_analytics_elementary, now model.elementary_internal.update_skipped_alerts)
[0m16:09:06.851336 [debug] [Thread-1  ]: Began compiling node model.elementary_internal.update_skipped_alerts
[0m16:09:06.864559 [debug] [Thread-1  ]: Using postgres connection "model.elementary_internal.update_skipped_alerts"
[0m16:09:06.864882 [debug] [Thread-1  ]: On model.elementary_internal.update_skipped_alerts: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "elementary", "target_name": "default", "node_id": "model.elementary_internal.update_skipped_alerts"} */

    
                UPDATE "dbt"."local_analytics_elementary"."alerts" set suppression_status = 'skipped'
                WHERE alert_id IN 
        ( '5e2e388e-e883-4989-8f54-0a5225805882.test.test_dbt.failing_test_stg_customers_last_name_last_name.847ec3eec4' ,  'f9f8b46b-9ba6-4db8-b9a8-20a04cd01d5e.test.test_dbt.failing_test_stg_customers_last_name_last_name.847ec3eec4' ,  '5ae5c1b9-bb50-4899-8860-56bae80936b6.test.test_dbt.failing_test_stg_customers_last_name_last_name.847ec3eec4' ,  'ce2e4bf3-1071-4144-a060-4cbfc0edb4ff.test.test_dbt.failing_test_stg_customers_last_name_last_name.847ec3eec4' ,  '82641d52-4826-40cf-994d-7339c5303164.test.test_dbt.failing_test_stg_customers_last_name_last_name.847ec3eec4' ,  '9a47e226-16da-4111-bd02-ee802a0af48c.test.test_dbt.unique_stg_customers_last_name_last_name.0845e13bad' ,  'a30fc06b-d642-44ed-95a6-dfd13be58b84.test.test_dbt.unique_stg_orders_order_id_customer_id.52431730b9' ,  'a30fc06b-d642-44ed-95a6-dfd13be58b84.test.test_dbt.not_null_stg_orders_order_id_customer_id.a094c039ad' ,  '80eeba1e-8527-416a-8d86-c42fc32450ac.test.test_dbt.source_unique_stripe_payment_id.3b7989ce64' ,  'a30fc06b-d642-44ed-95a6-dfd13be58b84.test.test_dbt.source_unique_stripe_payment_id.3b7989ce64'  )
 and suppression_status = 'pending' and
                    cast(detected_at as TIMESTAMP) >= cast(

    date_trunc('day', 
    current_timestamp::TIMESTAMP
) + ((interval '1 day') * (-31))

 as TIMESTAMP)
            
  
[0m16:09:06.865135 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:09:06.871874 [debug] [Thread-1  ]: SQL status: UPDATE 10 in 0.0 seconds
[0m16:09:06.872798 [debug] [Thread-1  ]: Writing injected SQL for node "model.elementary_internal.update_skipped_alerts"
[0m16:09:06.873326 [debug] [Thread-1  ]: Timing info for model.elementary_internal.update_skipped_alerts (compile): 16:09:06.851504 => 16:09:06.873208
[0m16:09:06.873549 [debug] [Thread-1  ]: Began executing node model.elementary_internal.update_skipped_alerts
[0m16:09:06.876653 [debug] [Thread-1  ]: Writing runtime sql for node "model.elementary_internal.update_skipped_alerts"
[0m16:09:06.877083 [debug] [Thread-1  ]: Using postgres connection "model.elementary_internal.update_skipped_alerts"
[0m16:09:06.877296 [debug] [Thread-1  ]: On model.elementary_internal.update_skipped_alerts: BEGIN
[0m16:09:06.877869 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:09:06.878070 [debug] [Thread-1  ]: Using postgres connection "model.elementary_internal.update_skipped_alerts"
[0m16:09:06.878278 [debug] [Thread-1  ]: On model.elementary_internal.update_skipped_alerts: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "elementary", "target_name": "default", "node_id": "model.elementary_internal.update_skipped_alerts"} */


-- depends_on: "dbt"."local_analytics_elementary"."alerts"
-- depends_on: "dbt"."local_analytics_elementary"."alerts_models"
-- depends_on: "dbt"."local_analytics_elementary"."alerts_source_freshness"



    with nothing as (select 1 as num)
    select * from nothing where num = 2

[0m16:09:06.878820 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.0 seconds
[0m16:09:06.879331 [debug] [Thread-1  ]: On model.elementary_internal.update_skipped_alerts: COMMIT
[0m16:09:06.879566 [debug] [Thread-1  ]: Using postgres connection "model.elementary_internal.update_skipped_alerts"
[0m16:09:06.879774 [debug] [Thread-1  ]: On model.elementary_internal.update_skipped_alerts: COMMIT
[0m16:09:06.880473 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m16:09:06.880737 [debug] [Thread-1  ]: Timing info for model.elementary_internal.update_skipped_alerts (execute): 16:09:06.873701 => 16:09:06.880644
[0m16:09:06.880954 [debug] [Thread-1  ]: On model.elementary_internal.update_skipped_alerts: Close
[0m16:09:06.881357 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e82d77e-00ea-4ecc-98b5-687550746f5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107be1fa0>]}
[0m16:09:06.881671 [info ] [Thread-1  ]: 1 of 1 OK created sql nothing model local_analytics_elementary.update_skipped_alerts  [[32mSELECT 0[0m in 0.03s]
[0m16:09:06.881991 [debug] [Thread-1  ]: Finished running node model.elementary_internal.update_skipped_alerts
[0m16:09:06.883023 [debug] [MainThread]: Using postgres connection "master"
[0m16:09:06.883257 [debug] [MainThread]: On master: BEGIN
[0m16:09:06.883460 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:09:06.888220 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:09:06.888486 [debug] [MainThread]: On master: COMMIT
[0m16:09:06.888702 [debug] [MainThread]: Using postgres connection "master"
[0m16:09:06.888906 [debug] [MainThread]: On master: COMMIT
[0m16:09:06.889391 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:09:06.889595 [info ] [MainThread]: 
[0m16:09:06.889785 [info ] [MainThread]: Running 1 on-run-end hook
[0m16:09:06.892708 [debug] [MainThread]: Writing injected SQL for node "operation.elementary.elementary-on-run-end-0"
[0m16:09:06.893041 [info ] [MainThread]: 1 of 1 START hook: elementary.on-run-end.0 ..................................... [RUN]
[0m16:09:06.893307 [info ] [MainThread]: 1 of 1 OK hook: elementary.on-run-end.0 ........................................ [[32mOK[0m in 0.00s]
[0m16:09:06.893490 [info ] [MainThread]: 
[0m16:09:06.893704 [debug] [MainThread]: On master: Close
[0m16:09:06.894047 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:09:06.894228 [debug] [MainThread]: Connection 'model.elementary_internal.update_skipped_alerts' was properly closed.
[0m16:09:06.894410 [info ] [MainThread]: 
[0m16:09:06.894599 [info ] [MainThread]: Finished running 1 nothing model, 2 hooks in 0 hours 0 minutes and 0.13 seconds (0.13s).
[0m16:09:06.894937 [debug] [MainThread]: Command end result
[0m16:09:06.908778 [info ] [MainThread]: 
[0m16:09:06.909083 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:09:06.909266 [info ] [MainThread]: 
[0m16:09:06.909466 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:09:06.909806 [debug] [MainThread]: Command `dbt run` succeeded at 16:09:06.909752 after 2.31 seconds
[0m16:09:06.910008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101d20040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a463a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a29220>]}
[0m16:09:06.910236 [debug] [MainThread]: Flushing usage events
[0m16:09:08.713359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101d655e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10483b1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10483bcd0>]}


============================== 16:09:08.715416 | c12fe861-17c4-4e49-bb00-9bab7c51f215 ==============================
[0m16:09:08.715416 [info ] [MainThread]: Running with dbt=1.6.0
[0m16:09:08.715741 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/ofek/workspace/test_dbt/edr_target', 'profiles_dir': '/Users/ofek/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s update_alerts.update_skipped_alerts --project-dir /Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/elementary/monitor/dbt_project --vars {"alert_ids": ["55c59901-7d0a-4af1-bbdd-203d138a6d5f.model.test_dbt.stg_customers", "55c59901-7d0a-4af1-bbdd-203d138a6d5f.model.test_dbt.stg_payments", "55c59901-7d0a-4af1-bbdd-203d138a6d5f.model.test_dbt.stg_orders", "14bdfa6a-a9a3-4903-a012-1649623274ce.model.test_dbt.stg_orders"], "table_name": "alerts_models"}', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:09:08.732363 [info ] [MainThread]: target not specified in profile 'elementary', using 'default'
[0m16:09:08.871055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c12fe861-17c4-4e49-bb00-9bab7c51f215', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ebbdf0>]}
[0m16:09:08.876591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c12fe861-17c4-4e49-bb00-9bab7c51f215', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b56fa0>]}
[0m16:09:08.876916 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m16:09:08.889530 [debug] [MainThread]: checksum: 3167ab68ca185d944687709699c311d6eef7b7744ba47da14d2a1e187f6eccac, vars: {'alert_ids': ['55c59901-7d0a-4af1-bbdd-203d138a6d5f.model.test_dbt.stg_customers',
               '55c59901-7d0a-4af1-bbdd-203d138a6d5f.model.test_dbt.stg_payments',
               '55c59901-7d0a-4af1-bbdd-203d138a6d5f.model.test_dbt.stg_orders',
               '14bdfa6a-a9a3-4903-a012-1649623274ce.model.test_dbt.stg_orders'],
 'table_name': 'alerts_models'}, profile: , target: , version: 1.6.0
[0m16:09:08.924931 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m16:09:08.925210 [debug] [MainThread]: previous checksum: 3167ab68ca185d944687709699c311d6eef7b7744ba47da14d2a1e187f6eccac, current checksum: f3f244f972752dcc91dbbde07158685e0a20d60d1f44cbd86a3b37cfc536cb7a
[0m16:09:08.925393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c12fe861-17c4-4e49-bb00-9bab7c51f215', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105afb190>]}
[0m16:09:10.838965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c12fe861-17c4-4e49-bb00-9bab7c51f215', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106147580>]}
[0m16:09:10.854730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c12fe861-17c4-4e49-bb00-9bab7c51f215', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bae520>]}
[0m16:09:10.855011 [info ] [MainThread]: Found 34 models, 2 operations, 6 tests, 6 sources, 0 exposures, 0 metrics, 1101 macros, 0 groups, 0 semantic models
[0m16:09:10.855220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c12fe861-17c4-4e49-bb00-9bab7c51f215', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10603ff70>]}
[0m16:09:10.856037 [info ] [MainThread]: 
[0m16:09:10.856423 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:09:10.856954 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m16:09:10.862869 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m16:09:10.863077 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "elementary", "target_name": "default", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m16:09:10.863243 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:09:10.883334 [debug] [ThreadPool]: SQL status: SELECT 60 in 0.0 seconds
[0m16:09:10.884262 [debug] [ThreadPool]: On list_dbt: Close
[0m16:09:10.885832 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt, now list_dbt_local_analytics_elementary)
[0m16:09:10.889941 [debug] [ThreadPool]: Using postgres connection "list_dbt_local_analytics_elementary"
[0m16:09:10.890157 [debug] [ThreadPool]: On list_dbt_local_analytics_elementary: BEGIN
[0m16:09:10.890332 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:09:10.898329 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:09:10.898513 [debug] [ThreadPool]: Using postgres connection "list_dbt_local_analytics_elementary"
[0m16:09:10.898701 [debug] [ThreadPool]: On list_dbt_local_analytics_elementary: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "elementary", "target_name": "default", "connection_name": "list_dbt_local_analytics_elementary"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'local_analytics_elementary'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'local_analytics_elementary'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'local_analytics_elementary'
  
[0m16:09:10.904393 [debug] [ThreadPool]: SQL status: SELECT 32 in 0.0 seconds
[0m16:09:10.905456 [debug] [ThreadPool]: On list_dbt_local_analytics_elementary: ROLLBACK
[0m16:09:10.906209 [debug] [ThreadPool]: On list_dbt_local_analytics_elementary: Close
[0m16:09:10.913184 [debug] [MainThread]: Using postgres connection "master"
[0m16:09:10.913409 [debug] [MainThread]: On master: BEGIN
[0m16:09:10.913594 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:09:10.919378 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:09:10.919622 [debug] [MainThread]: Using postgres connection "master"
[0m16:09:10.919879 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "elementary", "target_name": "default", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:09:10.926153 [debug] [MainThread]: SQL status: SELECT 108 in 0.0 seconds
[0m16:09:10.930436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c12fe861-17c4-4e49-bb00-9bab7c51f215', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106380b50>]}
[0m16:09:10.930715 [debug] [MainThread]: On master: ROLLBACK
[0m16:09:10.931309 [debug] [MainThread]: Using postgres connection "master"
[0m16:09:10.931501 [debug] [MainThread]: On master: BEGIN
[0m16:09:10.932370 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:09:10.932622 [debug] [MainThread]: On master: COMMIT
[0m16:09:10.932820 [debug] [MainThread]: Using postgres connection "master"
[0m16:09:10.933002 [debug] [MainThread]: On master: COMMIT
[0m16:09:10.933550 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:09:10.933724 [info ] [MainThread]: 
[0m16:09:10.933914 [info ] [MainThread]: Running 1 on-run-start hook
[0m16:09:10.937030 [debug] [MainThread]: Writing injected SQL for node "operation.elementary.elementary-on-run-start-0"
[0m16:09:10.937997 [info ] [MainThread]: 1 of 1 START hook: elementary.on-run-start.0 ................................... [RUN]
[0m16:09:10.938302 [info ] [MainThread]: 1 of 1 OK hook: elementary.on-run-start.0 ...................................... [[32mOK[0m in 0.00s]
[0m16:09:10.938504 [info ] [MainThread]: 
[0m16:09:10.938721 [debug] [MainThread]: On master: Close
[0m16:09:10.939075 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m16:09:10.939269 [info ] [MainThread]: 
[0m16:09:10.940238 [debug] [Thread-1  ]: Began running node model.elementary_internal.update_skipped_alerts
[0m16:09:10.940524 [info ] [Thread-1  ]: 1 of 1 START sql nothing model local_analytics_elementary.update_skipped_alerts  [RUN]
[0m16:09:10.940889 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt_local_analytics_elementary, now model.elementary_internal.update_skipped_alerts)
[0m16:09:10.941102 [debug] [Thread-1  ]: Began compiling node model.elementary_internal.update_skipped_alerts
[0m16:09:10.953775 [debug] [Thread-1  ]: Using postgres connection "model.elementary_internal.update_skipped_alerts"
[0m16:09:10.954049 [debug] [Thread-1  ]: On model.elementary_internal.update_skipped_alerts: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "elementary", "target_name": "default", "node_id": "model.elementary_internal.update_skipped_alerts"} */

    
                UPDATE "dbt"."local_analytics_elementary"."alerts_models" set suppression_status = 'skipped'
                WHERE alert_id IN 
        ( '55c59901-7d0a-4af1-bbdd-203d138a6d5f.model.test_dbt.stg_customers' ,  '55c59901-7d0a-4af1-bbdd-203d138a6d5f.model.test_dbt.stg_payments' ,  '55c59901-7d0a-4af1-bbdd-203d138a6d5f.model.test_dbt.stg_orders' ,  '14bdfa6a-a9a3-4903-a012-1649623274ce.model.test_dbt.stg_orders'  )
 and suppression_status = 'pending' and
                    cast(detected_at as TIMESTAMP) >= cast(

    date_trunc('day', 
    current_timestamp::TIMESTAMP
) + ((interval '1 day') * (-31))

 as TIMESTAMP)
            
  
[0m16:09:10.954266 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:09:10.960534 [debug] [Thread-1  ]: SQL status: UPDATE 4 in 0.0 seconds
[0m16:09:10.961339 [debug] [Thread-1  ]: Writing injected SQL for node "model.elementary_internal.update_skipped_alerts"
[0m16:09:10.961845 [debug] [Thread-1  ]: Timing info for model.elementary_internal.update_skipped_alerts (compile): 16:09:10.941261 => 16:09:10.961736
[0m16:09:10.962075 [debug] [Thread-1  ]: Began executing node model.elementary_internal.update_skipped_alerts
[0m16:09:10.965186 [debug] [Thread-1  ]: Writing runtime sql for node "model.elementary_internal.update_skipped_alerts"
[0m16:09:10.965584 [debug] [Thread-1  ]: Using postgres connection "model.elementary_internal.update_skipped_alerts"
[0m16:09:10.965796 [debug] [Thread-1  ]: On model.elementary_internal.update_skipped_alerts: BEGIN
[0m16:09:10.966397 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:09:10.966615 [debug] [Thread-1  ]: Using postgres connection "model.elementary_internal.update_skipped_alerts"
[0m16:09:10.966817 [debug] [Thread-1  ]: On model.elementary_internal.update_skipped_alerts: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "elementary", "target_name": "default", "node_id": "model.elementary_internal.update_skipped_alerts"} */


-- depends_on: "dbt"."local_analytics_elementary"."alerts"
-- depends_on: "dbt"."local_analytics_elementary"."alerts_models"
-- depends_on: "dbt"."local_analytics_elementary"."alerts_source_freshness"



    with nothing as (select 1 as num)
    select * from nothing where num = 2

[0m16:09:10.967431 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.0 seconds
[0m16:09:10.967950 [debug] [Thread-1  ]: On model.elementary_internal.update_skipped_alerts: COMMIT
[0m16:09:10.968151 [debug] [Thread-1  ]: Using postgres connection "model.elementary_internal.update_skipped_alerts"
[0m16:09:10.968337 [debug] [Thread-1  ]: On model.elementary_internal.update_skipped_alerts: COMMIT
[0m16:09:10.969024 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m16:09:10.969275 [debug] [Thread-1  ]: Timing info for model.elementary_internal.update_skipped_alerts (execute): 16:09:10.962236 => 16:09:10.969184
[0m16:09:10.969473 [debug] [Thread-1  ]: On model.elementary_internal.update_skipped_alerts: Close
[0m16:09:10.969847 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c12fe861-17c4-4e49-bb00-9bab7c51f215', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f94cd0>]}
[0m16:09:10.970154 [info ] [Thread-1  ]: 1 of 1 OK created sql nothing model local_analytics_elementary.update_skipped_alerts  [[32mSELECT 0[0m in 0.03s]
[0m16:09:10.970462 [debug] [Thread-1  ]: Finished running node model.elementary_internal.update_skipped_alerts
[0m16:09:10.971423 [debug] [MainThread]: Using postgres connection "master"
[0m16:09:10.971660 [debug] [MainThread]: On master: BEGIN
[0m16:09:10.971856 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:09:10.976485 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:09:10.976729 [debug] [MainThread]: On master: COMMIT
[0m16:09:10.976932 [debug] [MainThread]: Using postgres connection "master"
[0m16:09:10.977134 [debug] [MainThread]: On master: COMMIT
[0m16:09:10.977604 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:09:10.977785 [info ] [MainThread]: 
[0m16:09:10.977975 [info ] [MainThread]: Running 1 on-run-end hook
[0m16:09:10.980923 [debug] [MainThread]: Writing injected SQL for node "operation.elementary.elementary-on-run-end-0"
[0m16:09:10.981254 [info ] [MainThread]: 1 of 1 START hook: elementary.on-run-end.0 ..................................... [RUN]
[0m16:09:10.981516 [info ] [MainThread]: 1 of 1 OK hook: elementary.on-run-end.0 ........................................ [[32mOK[0m in 0.00s]
[0m16:09:10.981694 [info ] [MainThread]: 
[0m16:09:10.981903 [debug] [MainThread]: On master: Close
[0m16:09:10.982237 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:09:10.982405 [debug] [MainThread]: Connection 'model.elementary_internal.update_skipped_alerts' was properly closed.
[0m16:09:10.982574 [info ] [MainThread]: 
[0m16:09:10.982746 [info ] [MainThread]: Finished running 1 nothing model, 2 hooks in 0 hours 0 minutes and 0.13 seconds (0.13s).
[0m16:09:10.983062 [debug] [MainThread]: Command end result
[0m16:09:10.995554 [info ] [MainThread]: 
[0m16:09:10.995771 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:09:10.995941 [info ] [MainThread]: 
[0m16:09:10.996122 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:09:10.996427 [debug] [MainThread]: Command `dbt run` succeeded at 16:09:10.996382 after 2.29 seconds
[0m16:09:10.996625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101d655e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b56fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c92340>]}
[0m16:09:10.996822 [debug] [MainThread]: Flushing usage events
[0m16:09:32.396767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b64040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10662e0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10662e940>]}


============================== 16:09:32.399207 | 3c042fa6-2476-4c52-a354-97e63cf27444 ==============================
[0m16:09:32.399207 [info ] [MainThread]: Running with dbt=1.6.0
[0m16:09:32.399566 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ofek/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/ofek/workspace/test_dbt/edr_target', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s update_alerts.update_sent_alerts --project-dir /Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/elementary/monitor/dbt_project --vars {"alert_ids": ["a30fc06b-d642-44ed-95a6-dfd13be58b84.test.test_dbt.unique_stg_customers_customer_id.c7614daada", "a30fc06b-d642-44ed-95a6-dfd13be58b84.test.test_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa", "a30fc06b-d642-44ed-95a6-dfd13be58b84.test.test_dbt.assert_positive_value_for_total_amount", "a30fc06b-d642-44ed-95a6-dfd13be58b84.test.test_dbt.not_null_stg_orders_order_id.81cfe2fe64", "a30fc06b-d642-44ed-95a6-dfd13be58b84.test.test_dbt.unique_stg_orders_order_id.e3b841c71a", "a30fc06b-d642-44ed-95a6-dfd13be58b84.test.test_dbt.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1", "a30fc06b-d642-44ed-95a6-dfd13be58b84.test.test_dbt.not_null_dim_customers_customer_id.dd91cd1c8d", "a30fc06b-d642-44ed-95a6-dfd13be58b84.test.test_dbt.unique_dim_customers_customer_id.15c9f1e2fd", "a30fc06b-d642-44ed-95a6-dfd13be58b84.test.test_dbt.dbt_utils_cardinality_equality_dim_customers_customer_id__customer_id__ref_stg_customers_.cdf22e9197", "a30fc06b-d642-44ed-95a6-dfd13be58b84.test.test_dbt.assert_amount_average_is_greater_than_one", "a30fc06b-d642-44ed-95a6-dfd13be58b84.test.test_dbt.assert_total_payment_amount_is_positive", "a30fc06b-d642-44ed-95a6-dfd13be58b84.test.test_dbt.average_dollars_spent_greater_than_one_fct_orders_amount__customer_id.b5af33deeb", "80eeba1e-8527-416a-8d86-c42fc32450ac.test.test_dbt.not_null_stg_orders_order_id_customer_id.a094c039ad", "80eeba1e-8527-416a-8d86-c42fc32450ac.test.test_dbt.unique_stg_orders_order_id_customer_id.52431730b9", "ae8cffa4-c04f-4ee8-a58d-5a263fe9e884.test.test_dbt.source_unique_stripe_payment_id.3b7989ce64", "40ac6f6e-ca0b-4bc2-bd48-854f63035b55.test.test_dbt.unique_stg_customers_last_name_last_name.0845e13bad", "ccdeb6aa-962c-4b1d-84f4-5b2a15d4522c.test.test_dbt.failing_test_stg_customers_last_name_last_name.847ec3eec4"], "sent_at": "2023-08-08 13:09:31", "table_name": "alerts"}', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:09:32.415631 [info ] [MainThread]: target not specified in profile 'elementary', using 'default'
[0m16:09:32.563275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3c042fa6-2476-4c52-a354-97e63cf27444', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10662e0d0>]}
[0m16:09:32.568658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3c042fa6-2476-4c52-a354-97e63cf27444', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10794cf40>]}
[0m16:09:32.568971 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m16:09:32.581407 [debug] [MainThread]: checksum: b960772b612f585c16a2749e16c87030b52b2969d6d57c958b6375faf866af12, vars: {'alert_ids': ['a30fc06b-d642-44ed-95a6-dfd13be58b84.test.test_dbt.unique_stg_customers_customer_id.c7614daada',
               'a30fc06b-d642-44ed-95a6-dfd13be58b84.test.test_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa',
               'a30fc06b-d642-44ed-95a6-dfd13be58b84.test.test_dbt.assert_positive_value_for_total_amount',
               'a30fc06b-d642-44ed-95a6-dfd13be58b84.test.test_dbt.not_null_stg_orders_order_id.81cfe2fe64',
               'a30fc06b-d642-44ed-95a6-dfd13be58b84.test.test_dbt.unique_stg_orders_order_id.e3b841c71a',
               'a30fc06b-d642-44ed-95a6-dfd13be58b84.test.test_dbt.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1',
               'a30fc06b-d642-44ed-95a6-dfd13be58b84.test.test_dbt.not_null_dim_customers_customer_id.dd91cd1c8d',
               'a30fc06b-d642-44ed-95a6-dfd13be58b84.test.test_dbt.unique_dim_customers_customer_id.15c9f1e2fd',
               'a30fc06b-d642-44ed-95a6-dfd13be58b84.test.test_dbt.dbt_utils_cardinality_equality_dim_customers_customer_id__customer_id__ref_stg_customers_.cdf22e9197',
               'a30fc06b-d642-44ed-95a6-dfd13be58b84.test.test_dbt.assert_amount_average_is_greater_than_one',
               'a30fc06b-d642-44ed-95a6-dfd13be58b84.test.test_dbt.assert_total_payment_amount_is_positive',
               'a30fc06b-d642-44ed-95a6-dfd13be58b84.test.test_dbt.average_dollars_spent_greater_than_one_fct_orders_amount__customer_id.b5af33deeb',
               '80eeba1e-8527-416a-8d86-c42fc32450ac.test.test_dbt.not_null_stg_orders_order_id_customer_id.a094c039ad',
               '80eeba1e-8527-416a-8d86-c42fc32450ac.test.test_dbt.unique_stg_orders_order_id_customer_id.52431730b9',
               'ae8cffa4-c04f-4ee8-a58d-5a263fe9e884.test.test_dbt.source_unique_stripe_payment_id.3b7989ce64',
               '40ac6f6e-ca0b-4bc2-bd48-854f63035b55.test.test_dbt.unique_stg_customers_last_name_last_name.0845e13bad',
               'ccdeb6aa-962c-4b1d-84f4-5b2a15d4522c.test.test_dbt.failing_test_stg_customers_last_name_last_name.847ec3eec4'],
 'sent_at': '2023-08-08 13:09:31',
 'table_name': 'alerts'}, profile: , target: , version: 1.6.0
[0m16:09:32.619800 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m16:09:32.620098 [debug] [MainThread]: previous checksum: b960772b612f585c16a2749e16c87030b52b2969d6d57c958b6375faf866af12, current checksum: 3167ab68ca185d944687709699c311d6eef7b7744ba47da14d2a1e187f6eccac
[0m16:09:32.620302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3c042fa6-2476-4c52-a354-97e63cf27444', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078e4e50>]}
[0m16:09:34.542328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3c042fa6-2476-4c52-a354-97e63cf27444', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110061b20>]}
[0m16:09:34.558178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3c042fa6-2476-4c52-a354-97e63cf27444', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079a1eb0>]}
[0m16:09:34.558463 [info ] [MainThread]: Found 34 models, 2 operations, 6 tests, 6 sources, 0 exposures, 0 metrics, 1101 macros, 0 groups, 0 semantic models
[0m16:09:34.558675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c042fa6-2476-4c52-a354-97e63cf27444', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a4c220>]}
[0m16:09:34.559470 [info ] [MainThread]: 
[0m16:09:34.559852 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:09:34.560381 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m16:09:34.566349 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m16:09:34.566584 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "elementary", "target_name": "default", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m16:09:34.566761 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:09:34.606136 [debug] [ThreadPool]: SQL status: SELECT 60 in 0.0 seconds
[0m16:09:34.607130 [debug] [ThreadPool]: On list_dbt: Close
[0m16:09:34.608924 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt, now list_dbt_local_analytics_elementary)
[0m16:09:34.613496 [debug] [ThreadPool]: Using postgres connection "list_dbt_local_analytics_elementary"
[0m16:09:34.613741 [debug] [ThreadPool]: On list_dbt_local_analytics_elementary: BEGIN
[0m16:09:34.613939 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:09:34.619217 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:09:34.619466 [debug] [ThreadPool]: Using postgres connection "list_dbt_local_analytics_elementary"
[0m16:09:34.619696 [debug] [ThreadPool]: On list_dbt_local_analytics_elementary: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "elementary", "target_name": "default", "connection_name": "list_dbt_local_analytics_elementary"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'local_analytics_elementary'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'local_analytics_elementary'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'local_analytics_elementary'
  
[0m16:09:34.622346 [debug] [ThreadPool]: SQL status: SELECT 32 in 0.0 seconds
[0m16:09:34.623479 [debug] [ThreadPool]: On list_dbt_local_analytics_elementary: ROLLBACK
[0m16:09:34.624090 [debug] [ThreadPool]: On list_dbt_local_analytics_elementary: Close
[0m16:09:34.631869 [debug] [MainThread]: Using postgres connection "master"
[0m16:09:34.632113 [debug] [MainThread]: On master: BEGIN
[0m16:09:34.632312 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:09:34.637444 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:09:34.637660 [debug] [MainThread]: Using postgres connection "master"
[0m16:09:34.637938 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "elementary", "target_name": "default", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:09:34.644047 [debug] [MainThread]: SQL status: SELECT 108 in 0.0 seconds
[0m16:09:34.648559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c042fa6-2476-4c52-a354-97e63cf27444', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110182ca0>]}
[0m16:09:34.648851 [debug] [MainThread]: On master: ROLLBACK
[0m16:09:34.649487 [debug] [MainThread]: Using postgres connection "master"
[0m16:09:34.649721 [debug] [MainThread]: On master: BEGIN
[0m16:09:34.650656 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:09:34.650882 [debug] [MainThread]: On master: COMMIT
[0m16:09:34.651080 [debug] [MainThread]: Using postgres connection "master"
[0m16:09:34.651265 [debug] [MainThread]: On master: COMMIT
[0m16:09:34.651811 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:09:34.652003 [info ] [MainThread]: 
[0m16:09:34.652212 [info ] [MainThread]: Running 1 on-run-start hook
[0m16:09:34.655452 [debug] [MainThread]: Writing injected SQL for node "operation.elementary.elementary-on-run-start-0"
[0m16:09:34.656487 [info ] [MainThread]: 1 of 1 START hook: elementary.on-run-start.0 ................................... [RUN]
[0m16:09:34.656799 [info ] [MainThread]: 1 of 1 OK hook: elementary.on-run-start.0 ...................................... [[32mOK[0m in 0.00s]
[0m16:09:34.657005 [info ] [MainThread]: 
[0m16:09:34.657254 [debug] [MainThread]: On master: Close
[0m16:09:34.657682 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m16:09:34.657900 [info ] [MainThread]: 
[0m16:09:34.659747 [debug] [Thread-1  ]: Began running node model.elementary_internal.update_sent_alerts
[0m16:09:34.660030 [info ] [Thread-1  ]: 1 of 1 START sql nothing model local_analytics_elementary.update_sent_alerts ... [RUN]
[0m16:09:34.660420 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt_local_analytics_elementary, now model.elementary_internal.update_sent_alerts)
[0m16:09:34.660649 [debug] [Thread-1  ]: Began compiling node model.elementary_internal.update_sent_alerts
[0m16:09:34.674281 [debug] [Thread-1  ]: Using postgres connection "model.elementary_internal.update_sent_alerts"
[0m16:09:34.674592 [debug] [Thread-1  ]: On model.elementary_internal.update_sent_alerts: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "elementary", "target_name": "default", "node_id": "model.elementary_internal.update_sent_alerts"} */

    
                UPDATE "dbt"."local_analytics_elementary"."alerts" set suppression_status = 'sent', sent_at = '2023-08-08 13:09:31', alert_sent = TRUE
                WHERE alert_id IN 
        ( 'a30fc06b-d642-44ed-95a6-dfd13be58b84.test.test_dbt.unique_stg_customers_customer_id.c7614daada' ,  'a30fc06b-d642-44ed-95a6-dfd13be58b84.test.test_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa' ,  'a30fc06b-d642-44ed-95a6-dfd13be58b84.test.test_dbt.assert_positive_value_for_total_amount' ,  'a30fc06b-d642-44ed-95a6-dfd13be58b84.test.test_dbt.not_null_stg_orders_order_id.81cfe2fe64' ,  'a30fc06b-d642-44ed-95a6-dfd13be58b84.test.test_dbt.unique_stg_orders_order_id.e3b841c71a' ,  'a30fc06b-d642-44ed-95a6-dfd13be58b84.test.test_dbt.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1' ,  'a30fc06b-d642-44ed-95a6-dfd13be58b84.test.test_dbt.not_null_dim_customers_customer_id.dd91cd1c8d' ,  'a30fc06b-d642-44ed-95a6-dfd13be58b84.test.test_dbt.unique_dim_customers_customer_id.15c9f1e2fd' ,  'a30fc06b-d642-44ed-95a6-dfd13be58b84.test.test_dbt.dbt_utils_cardinality_equality_dim_customers_customer_id__customer_id__ref_stg_customers_.cdf22e9197' ,  'a30fc06b-d642-44ed-95a6-dfd13be58b84.test.test_dbt.assert_amount_average_is_greater_than_one' ,  'a30fc06b-d642-44ed-95a6-dfd13be58b84.test.test_dbt.assert_total_payment_amount_is_positive' ,  'a30fc06b-d642-44ed-95a6-dfd13be58b84.test.test_dbt.average_dollars_spent_greater_than_one_fct_orders_amount__customer_id.b5af33deeb' ,  '80eeba1e-8527-416a-8d86-c42fc32450ac.test.test_dbt.not_null_stg_orders_order_id_customer_id.a094c039ad' ,  '80eeba1e-8527-416a-8d86-c42fc32450ac.test.test_dbt.unique_stg_orders_order_id_customer_id.52431730b9' ,  'ae8cffa4-c04f-4ee8-a58d-5a263fe9e884.test.test_dbt.source_unique_stripe_payment_id.3b7989ce64' ,  '40ac6f6e-ca0b-4bc2-bd48-854f63035b55.test.test_dbt.unique_stg_customers_last_name_last_name.0845e13bad' ,  'ccdeb6aa-962c-4b1d-84f4-5b2a15d4522c.test.test_dbt.failing_test_stg_customers_last_name_last_name.847ec3eec4'  )
 and suppression_status = 'pending' and
                    cast(detected_at as TIMESTAMP) >= cast(

    date_trunc('day', 
    current_timestamp::TIMESTAMP
) + ((interval '1 day') * (-31))

 as TIMESTAMP)
            
  
[0m16:09:34.674871 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:09:34.681209 [debug] [Thread-1  ]: SQL status: UPDATE 17 in 0.0 seconds
[0m16:09:34.681964 [debug] [Thread-1  ]: Writing injected SQL for node "model.elementary_internal.update_sent_alerts"
[0m16:09:34.682448 [debug] [Thread-1  ]: Timing info for model.elementary_internal.update_sent_alerts (compile): 16:09:34.660806 => 16:09:34.682337
[0m16:09:34.682665 [debug] [Thread-1  ]: Began executing node model.elementary_internal.update_sent_alerts
[0m16:09:34.685718 [debug] [Thread-1  ]: Writing runtime sql for node "model.elementary_internal.update_sent_alerts"
[0m16:09:34.686105 [debug] [Thread-1  ]: Using postgres connection "model.elementary_internal.update_sent_alerts"
[0m16:09:34.686316 [debug] [Thread-1  ]: On model.elementary_internal.update_sent_alerts: BEGIN
[0m16:09:34.686891 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:09:34.687117 [debug] [Thread-1  ]: Using postgres connection "model.elementary_internal.update_sent_alerts"
[0m16:09:34.687340 [debug] [Thread-1  ]: On model.elementary_internal.update_sent_alerts: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "elementary", "target_name": "default", "node_id": "model.elementary_internal.update_sent_alerts"} */


-- depends_on: "dbt"."local_analytics_elementary"."alerts"
-- depends_on: "dbt"."local_analytics_elementary"."alerts_models"
-- depends_on: "dbt"."local_analytics_elementary"."alerts_source_freshness"



    with nothing as (select 1 as num)
    select * from nothing where num = 2

[0m16:09:34.687899 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.0 seconds
[0m16:09:34.688406 [debug] [Thread-1  ]: On model.elementary_internal.update_sent_alerts: COMMIT
[0m16:09:34.688611 [debug] [Thread-1  ]: Using postgres connection "model.elementary_internal.update_sent_alerts"
[0m16:09:34.688806 [debug] [Thread-1  ]: On model.elementary_internal.update_sent_alerts: COMMIT
[0m16:09:34.689550 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m16:09:34.689809 [debug] [Thread-1  ]: Timing info for model.elementary_internal.update_sent_alerts (execute): 16:09:34.682812 => 16:09:34.689718
[0m16:09:34.690023 [debug] [Thread-1  ]: On model.elementary_internal.update_sent_alerts: Close
[0m16:09:34.690417 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c042fa6-2476-4c52-a354-97e63cf27444', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a7cfa0>]}
[0m16:09:34.690743 [info ] [Thread-1  ]: 1 of 1 OK created sql nothing model local_analytics_elementary.update_sent_alerts  [[32mSELECT 0[0m in 0.03s]
[0m16:09:34.691078 [debug] [Thread-1  ]: Finished running node model.elementary_internal.update_sent_alerts
[0m16:09:34.692123 [debug] [MainThread]: Using postgres connection "master"
[0m16:09:34.692359 [debug] [MainThread]: On master: BEGIN
[0m16:09:34.692549 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:09:34.697005 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:09:34.697221 [debug] [MainThread]: On master: COMMIT
[0m16:09:34.697414 [debug] [MainThread]: Using postgres connection "master"
[0m16:09:34.697607 [debug] [MainThread]: On master: COMMIT
[0m16:09:34.698063 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:09:34.698272 [info ] [MainThread]: 
[0m16:09:34.698458 [info ] [MainThread]: Running 1 on-run-end hook
[0m16:09:34.701421 [debug] [MainThread]: Writing injected SQL for node "operation.elementary.elementary-on-run-end-0"
[0m16:09:34.701761 [info ] [MainThread]: 1 of 1 START hook: elementary.on-run-end.0 ..................................... [RUN]
[0m16:09:34.702019 [info ] [MainThread]: 1 of 1 OK hook: elementary.on-run-end.0 ........................................ [[32mOK[0m in 0.00s]
[0m16:09:34.702202 [info ] [MainThread]: 
[0m16:09:34.702424 [debug] [MainThread]: On master: Close
[0m16:09:34.702772 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:09:34.702943 [debug] [MainThread]: Connection 'model.elementary_internal.update_sent_alerts' was properly closed.
[0m16:09:34.703124 [info ] [MainThread]: 
[0m16:09:34.703300 [info ] [MainThread]: Finished running 1 nothing model, 2 hooks in 0 hours 0 minutes and 0.14 seconds (0.14s).
[0m16:09:34.703631 [debug] [MainThread]: Command end result
[0m16:09:34.717623 [info ] [MainThread]: 
[0m16:09:34.717957 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:09:34.718150 [info ] [MainThread]: 
[0m16:09:34.718337 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:09:34.718689 [debug] [MainThread]: Command `dbt run` succeeded at 16:09:34.718631 after 2.33 seconds
[0m16:09:34.718921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b64040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10794cf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079a1580>]}
[0m16:09:34.719140 [debug] [MainThread]: Flushing usage events
[0m16:09:36.507964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045aa100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d92280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d92d90>]}


============================== 16:09:36.509770 | 21606e56-3187-4743-ace4-9005fa6669f2 ==============================
[0m16:09:36.509770 [info ] [MainThread]: Running with dbt=1.6.0
[0m16:09:36.510082 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/ofek/workspace/test_dbt/edr_target', 'fail_fast': 'False', 'profiles_dir': '/Users/ofek/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -s update_alerts.update_sent_alerts --project-dir /Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/elementary/monitor/dbt_project --vars {"alert_ids": ["14bdfa6a-a9a3-4903-a012-1649623274ce.model.test_dbt.stg_customers", "14bdfa6a-a9a3-4903-a012-1649623274ce.model.test_dbt.stg_payments", "57d30c1c-49bd-470a-b15c-2c16362082be.model.test_dbt.stg_orders"], "sent_at": "2023-08-08 13:09:35", "table_name": "alerts_models"}', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:09:36.525816 [info ] [MainThread]: target not specified in profile 'elementary', using 'default'
[0m16:09:36.664043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '21606e56-3187-4743-ace4-9005fa6669f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073037c0>]}
[0m16:09:36.669609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '21606e56-3187-4743-ace4-9005fa6669f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113e00a0>]}
[0m16:09:36.669957 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m16:09:36.683046 [debug] [MainThread]: checksum: 9810a08ad8cb155b8764ce77d0e35cb367e511caa655b3301218757162e5608c, vars: {'alert_ids': ['14bdfa6a-a9a3-4903-a012-1649623274ce.model.test_dbt.stg_customers',
               '14bdfa6a-a9a3-4903-a012-1649623274ce.model.test_dbt.stg_payments',
               '57d30c1c-49bd-470a-b15c-2c16362082be.model.test_dbt.stg_orders'],
 'sent_at': '2023-08-08 13:09:35',
 'table_name': 'alerts_models'}, profile: , target: , version: 1.6.0
[0m16:09:36.718829 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m16:09:36.719118 [debug] [MainThread]: previous checksum: 9810a08ad8cb155b8764ce77d0e35cb367e511caa655b3301218757162e5608c, current checksum: b960772b612f585c16a2749e16c87030b52b2969d6d57c958b6375faf866af12
[0m16:09:36.719317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '21606e56-3187-4743-ace4-9005fa6669f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111350f70>]}
[0m16:09:38.656562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '21606e56-3187-4743-ace4-9005fa6669f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e5d4c0>]}
[0m16:09:38.672099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '21606e56-3187-4743-ace4-9005fa6669f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11140c5e0>]}
[0m16:09:38.672362 [info ] [MainThread]: Found 34 models, 2 operations, 6 tests, 6 sources, 0 exposures, 0 metrics, 1101 macros, 0 groups, 0 semantic models
[0m16:09:38.672568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '21606e56-3187-4743-ace4-9005fa6669f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114a6df0>]}
[0m16:09:38.673359 [info ] [MainThread]: 
[0m16:09:38.673744 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:09:38.674284 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m16:09:38.680415 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m16:09:38.680642 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "elementary", "target_name": "default", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m16:09:38.680810 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:09:38.701285 [debug] [ThreadPool]: SQL status: SELECT 60 in 0.0 seconds
[0m16:09:38.702240 [debug] [ThreadPool]: On list_dbt: Close
[0m16:09:38.703814 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt, now list_dbt_local_analytics_elementary)
[0m16:09:38.707787 [debug] [ThreadPool]: Using postgres connection "list_dbt_local_analytics_elementary"
[0m16:09:38.707989 [debug] [ThreadPool]: On list_dbt_local_analytics_elementary: BEGIN
[0m16:09:38.708156 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:09:38.716755 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:09:38.716982 [debug] [ThreadPool]: Using postgres connection "list_dbt_local_analytics_elementary"
[0m16:09:38.717187 [debug] [ThreadPool]: On list_dbt_local_analytics_elementary: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "elementary", "target_name": "default", "connection_name": "list_dbt_local_analytics_elementary"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'local_analytics_elementary'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'local_analytics_elementary'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'local_analytics_elementary'
  
[0m16:09:38.719770 [debug] [ThreadPool]: SQL status: SELECT 32 in 0.0 seconds
[0m16:09:38.720843 [debug] [ThreadPool]: On list_dbt_local_analytics_elementary: ROLLBACK
[0m16:09:38.721452 [debug] [ThreadPool]: On list_dbt_local_analytics_elementary: Close
[0m16:09:38.728716 [debug] [MainThread]: Using postgres connection "master"
[0m16:09:38.728963 [debug] [MainThread]: On master: BEGIN
[0m16:09:38.729143 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:09:38.733997 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:09:38.734237 [debug] [MainThread]: Using postgres connection "master"
[0m16:09:38.734510 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "elementary", "target_name": "default", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:09:38.740932 [debug] [MainThread]: SQL status: SELECT 108 in 0.0 seconds
[0m16:09:38.745360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '21606e56-3187-4743-ace4-9005fa6669f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e5dd00>]}
[0m16:09:38.745656 [debug] [MainThread]: On master: ROLLBACK
[0m16:09:38.746267 [debug] [MainThread]: Using postgres connection "master"
[0m16:09:38.746556 [debug] [MainThread]: On master: BEGIN
[0m16:09:38.747431 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:09:38.747684 [debug] [MainThread]: On master: COMMIT
[0m16:09:38.747894 [debug] [MainThread]: Using postgres connection "master"
[0m16:09:38.748076 [debug] [MainThread]: On master: COMMIT
[0m16:09:38.748627 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:09:38.748857 [info ] [MainThread]: 
[0m16:09:38.749075 [info ] [MainThread]: Running 1 on-run-start hook
[0m16:09:38.752632 [debug] [MainThread]: Writing injected SQL for node "operation.elementary.elementary-on-run-start-0"
[0m16:09:38.753633 [info ] [MainThread]: 1 of 1 START hook: elementary.on-run-start.0 ................................... [RUN]
[0m16:09:38.753921 [info ] [MainThread]: 1 of 1 OK hook: elementary.on-run-start.0 ...................................... [[32mOK[0m in 0.00s]
[0m16:09:38.754118 [info ] [MainThread]: 
[0m16:09:38.754353 [debug] [MainThread]: On master: Close
[0m16:09:38.754729 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m16:09:38.754917 [info ] [MainThread]: 
[0m16:09:38.755923 [debug] [Thread-1  ]: Began running node model.elementary_internal.update_sent_alerts
[0m16:09:38.756226 [info ] [Thread-1  ]: 1 of 1 START sql nothing model local_analytics_elementary.update_sent_alerts ... [RUN]
[0m16:09:38.756609 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt_local_analytics_elementary, now model.elementary_internal.update_sent_alerts)
[0m16:09:38.756834 [debug] [Thread-1  ]: Began compiling node model.elementary_internal.update_sent_alerts
[0m16:09:38.769752 [debug] [Thread-1  ]: Using postgres connection "model.elementary_internal.update_sent_alerts"
[0m16:09:38.770072 [debug] [Thread-1  ]: On model.elementary_internal.update_sent_alerts: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "elementary", "target_name": "default", "node_id": "model.elementary_internal.update_sent_alerts"} */

    
                UPDATE "dbt"."local_analytics_elementary"."alerts_models" set suppression_status = 'sent', sent_at = '2023-08-08 13:09:35', alert_sent = TRUE
                WHERE alert_id IN 
        ( '14bdfa6a-a9a3-4903-a012-1649623274ce.model.test_dbt.stg_customers' ,  '14bdfa6a-a9a3-4903-a012-1649623274ce.model.test_dbt.stg_payments' ,  '57d30c1c-49bd-470a-b15c-2c16362082be.model.test_dbt.stg_orders'  )
 and suppression_status = 'pending' and
                    cast(detected_at as TIMESTAMP) >= cast(

    date_trunc('day', 
    current_timestamp::TIMESTAMP
) + ((interval '1 day') * (-31))

 as TIMESTAMP)
            
  
[0m16:09:38.770309 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:09:38.776475 [debug] [Thread-1  ]: SQL status: UPDATE 3 in 0.0 seconds
[0m16:09:38.777299 [debug] [Thread-1  ]: Writing injected SQL for node "model.elementary_internal.update_sent_alerts"
[0m16:09:38.777841 [debug] [Thread-1  ]: Timing info for model.elementary_internal.update_sent_alerts (compile): 16:09:38.756990 => 16:09:38.777725
[0m16:09:38.778074 [debug] [Thread-1  ]: Began executing node model.elementary_internal.update_sent_alerts
[0m16:09:38.781167 [debug] [Thread-1  ]: Writing runtime sql for node "model.elementary_internal.update_sent_alerts"
[0m16:09:38.781568 [debug] [Thread-1  ]: Using postgres connection "model.elementary_internal.update_sent_alerts"
[0m16:09:38.781770 [debug] [Thread-1  ]: On model.elementary_internal.update_sent_alerts: BEGIN
[0m16:09:38.782437 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:09:38.782647 [debug] [Thread-1  ]: Using postgres connection "model.elementary_internal.update_sent_alerts"
[0m16:09:38.782848 [debug] [Thread-1  ]: On model.elementary_internal.update_sent_alerts: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "elementary", "target_name": "default", "node_id": "model.elementary_internal.update_sent_alerts"} */


-- depends_on: "dbt"."local_analytics_elementary"."alerts"
-- depends_on: "dbt"."local_analytics_elementary"."alerts_models"
-- depends_on: "dbt"."local_analytics_elementary"."alerts_source_freshness"



    with nothing as (select 1 as num)
    select * from nothing where num = 2

[0m16:09:38.783413 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.0 seconds
[0m16:09:38.783921 [debug] [Thread-1  ]: On model.elementary_internal.update_sent_alerts: COMMIT
[0m16:09:38.784127 [debug] [Thread-1  ]: Using postgres connection "model.elementary_internal.update_sent_alerts"
[0m16:09:38.784323 [debug] [Thread-1  ]: On model.elementary_internal.update_sent_alerts: COMMIT
[0m16:09:38.785003 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m16:09:38.785289 [debug] [Thread-1  ]: Timing info for model.elementary_internal.update_sent_alerts (execute): 16:09:38.778227 => 16:09:38.785188
[0m16:09:38.785505 [debug] [Thread-1  ]: On model.elementary_internal.update_sent_alerts: Close
[0m16:09:38.785902 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21606e56-3187-4743-ace4-9005fa6669f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111dded90>]}
[0m16:09:38.786242 [info ] [Thread-1  ]: 1 of 1 OK created sql nothing model local_analytics_elementary.update_sent_alerts  [[32mSELECT 0[0m in 0.03s]
[0m16:09:38.786563 [debug] [Thread-1  ]: Finished running node model.elementary_internal.update_sent_alerts
[0m16:09:38.787490 [debug] [MainThread]: Using postgres connection "master"
[0m16:09:38.787709 [debug] [MainThread]: On master: BEGIN
[0m16:09:38.787917 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:09:38.792238 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:09:38.792480 [debug] [MainThread]: On master: COMMIT
[0m16:09:38.792682 [debug] [MainThread]: Using postgres connection "master"
[0m16:09:38.792875 [debug] [MainThread]: On master: COMMIT
[0m16:09:38.793381 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:09:38.793559 [info ] [MainThread]: 
[0m16:09:38.793734 [info ] [MainThread]: Running 1 on-run-end hook
[0m16:09:38.796671 [debug] [MainThread]: Writing injected SQL for node "operation.elementary.elementary-on-run-end-0"
[0m16:09:38.797036 [info ] [MainThread]: 1 of 1 START hook: elementary.on-run-end.0 ..................................... [RUN]
[0m16:09:38.797308 [info ] [MainThread]: 1 of 1 OK hook: elementary.on-run-end.0 ........................................ [[32mOK[0m in 0.00s]
[0m16:09:38.797493 [info ] [MainThread]: 
[0m16:09:38.797702 [debug] [MainThread]: On master: Close
[0m16:09:38.798026 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:09:38.798187 [debug] [MainThread]: Connection 'model.elementary_internal.update_sent_alerts' was properly closed.
[0m16:09:38.798367 [info ] [MainThread]: 
[0m16:09:38.798543 [info ] [MainThread]: Finished running 1 nothing model, 2 hooks in 0 hours 0 minutes and 0.12 seconds (0.12s).
[0m16:09:38.798868 [debug] [MainThread]: Command end result
[0m16:09:38.812930 [info ] [MainThread]: 
[0m16:09:38.813213 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:09:38.813402 [info ] [MainThread]: 
[0m16:09:38.813685 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:09:38.814073 [debug] [MainThread]: Command `dbt run` succeeded at 16:09:38.814019 after 2.32 seconds
[0m16:09:38.814321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045aa100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113e00a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b36fd0>]}
[0m16:09:38.814554 [debug] [MainThread]: Flushing usage events
