2023-08-08 15:59:48 â€” INFO â€” Running with edr=0.9.2
2023-08-08 16:07:03 â€” INFO â€” Running with edr=0.9.2
2023-08-08 16:07:11 â€” INFO â€” Running with edr=0.9.2
2023-08-08 16:07:11 â€” DEBUG â€” Running dbt --log-format json run-operation elementary.log_macro_results --args {"macro_name": "get_latest_invocation", "macro_args": {}} --project-dir /Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/elementary/monitor/dbt_project
[31;20m2023-08-08 16:07:14 â€” ERROR â€” Unable to get the latest invocation: Failed to run dbt command.
Encountered an error while running operation: Database Error
  could not translate host name "db" to address: nodename nor servname provided, or not known
  [0m
2023-08-08 16:07:14 â€” DEBUG â€” Running dbt --log-format json run-operation elementary.log_macro_results --args {"macro_name": "get_adapter_type_and_unique_id", "macro_args": {}} --project-dir /Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/elementary/monitor/dbt_project
2023-08-08 16:07:16 â€” DEBUG â€” Could not get warehouse info.
Traceback (most recent call last):
  File "/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/elementary/clients/dbt/dbt_runner.py", line 71, in _run_command
    result = subprocess.run(
  File "/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['dbt', '--log-format', 'json', 'run-operation', 'elementary.log_macro_results', '--args', '{"macro_name": "get_adapter_type_and_unique_id", "macro_args": {}}', '--project-dir', '/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/elementary/monitor/dbt_project']' returned non-zero exit status 1.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/elementary/monitor/data_monitoring/data_monitoring.py", line 179, in _get_warehouse_info
    self.internal_dbt_runner.run_operation(
  File "/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/elementary/clients/dbt/dbt_runner.py", line 136, in run_operation
    success, command_output = self._run_command(
  File "/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/elementary/clients/dbt/dbt_runner.py", line 82, in _run_command
    raise DbtCommandError(err, command_args, logs=logs)
elementary.exceptions.exceptions.DbtCommandError: Failed to run dbt command.
Encountered an error while running operation: Database Error
  could not translate host name "db" to address: nodename nor servname provided, or not known
  
2023-08-08 16:07:16 â€” DEBUG â€” Running dbt --log-format json run-operation elementary.log_macro_results --args {"macro_name": "get_elementary_database_and_schema", "macro_args": {}} --project-dir /Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/elementary/monitor/dbt_project
[31;20m2023-08-08 16:07:18 â€” ERROR â€” Failed to parse Elementary's database and schema.[0m
2023-08-08 16:07:18 â€” INFO â€” Running internal dbt run to aggregate alerts
2023-08-08 16:07:18 â€” INFO â€” Running dbt run -m alerts --project-dir /Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/elementary/monitor/dbt_project
2023-08-08 16:08:40 â€” INFO â€” Running with edr=0.9.2
2023-08-08 16:08:40 â€” DEBUG â€” Running dbt --log-format json run-operation elementary.log_macro_results --args {"macro_name": "get_latest_invocation", "macro_args": {}} --project-dir /Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/elementary/monitor/dbt_project
2023-08-08 16:08:44 â€” DEBUG â€” Result bytes size for command '['dbt', '--log-format', 'json', 'run-operation', 'elementary.log_macro_results', '--args', '{"macro_name": "get_latest_invocation", "macro_args": {}}', '--project-dir', '/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/elementary/monitor/dbt_project']' is 4058
2023-08-08 16:08:44 â€” DEBUG â€” Running dbt --log-format json run-operation elementary.log_macro_results --args {"macro_name": "get_adapter_type_and_unique_id", "macro_args": {}} --project-dir /Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/elementary/monitor/dbt_project
2023-08-08 16:08:46 â€” DEBUG â€” Result bytes size for command '['dbt', '--log-format', 'json', 'run-operation', 'elementary.log_macro_results', '--args', '{"macro_name": "get_adapter_type_and_unique_id", "macro_args": {}}', '--project-dir', '/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/elementary/monitor/dbt_project']' is 1869
2023-08-08 16:08:46 â€” INFO â€” edr (0.9.2) and Elementary's dbt package (0.9.0) are compatible.
2023-08-08 16:08:46 â€” DEBUG â€” Running dbt --log-format json run-operation elementary.log_macro_results --args {"macro_name": "get_elementary_database_and_schema", "macro_args": {}} --project-dir /Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/elementary/monitor/dbt_project
2023-08-08 16:08:48 â€” DEBUG â€” Result bytes size for command '['dbt', '--log-format', 'json', 'run-operation', 'elementary.log_macro_results', '--args', '{"macro_name": "get_elementary_database_and_schema", "macro_args": {}}', '--project-dir', '/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/elementary/monitor/dbt_project']' is 1879
2023-08-08 16:08:48 â€” INFO â€” Elementary's database and schema: '"dbt.local_analytics_elementary"'
2023-08-08 16:08:48 â€” INFO â€” Running internal dbt run to aggregate alerts
2023-08-08 16:08:48 â€” INFO â€” Running dbt run -m alerts --project-dir /Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/elementary/monitor/dbt_project
2023-08-08 16:08:50 â€” INFO â€” Querying test alerts.
2023-08-08 16:08:50 â€” INFO â€” Running dbt --log-format json run-operation elementary.log_macro_results --args {"macro_name": "get_pending_test_alerts", "macro_args": {"days_back": 1, "disable_samples": false}} --project-dir /Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/elementary/monitor/dbt_project
2023-08-08 16:08:53 â€” DEBUG â€” Result bytes size for command '['dbt', '--log-format', 'json', 'run-operation', 'elementary.log_macro_results', '--args', '{"macro_name": "get_pending_test_alerts", "macro_args": {"days_back": 1, "disable_samples": false}}', '--project-dir', '/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/elementary/monitor/dbt_project']' is 88867
2023-08-08 16:08:53 â€” INFO â€” Querying test alerts last sent times.
2023-08-08 16:08:53 â€” INFO â€” Running dbt --log-format json run-operation elementary.log_macro_results --args {"macro_name": "get_last_test_alert_sent_times", "macro_args": {"days_back": 1}} --project-dir /Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/elementary/monitor/dbt_project
2023-08-08 16:08:55 â€” DEBUG â€” Result bytes size for command '['dbt', '--log-format', 'json', 'run-operation', 'elementary.log_macro_results', '--args', '{"macro_name": "get_last_test_alert_sent_times", "macro_args": {"days_back": 1}}', '--project-dir', '/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/elementary/monitor/dbt_project']' is 1815
2023-08-08 16:08:55 â€” INFO â€” Querying model alerts.
2023-08-08 16:08:55 â€” INFO â€” Running dbt --log-format json run-operation elementary.log_macro_results --args {"macro_name": "get_pending_model_alerts", "macro_args": {"days_back": 1}} --project-dir /Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/elementary/monitor/dbt_project
2023-08-08 16:08:57 â€” DEBUG â€” Result bytes size for command '['dbt', '--log-format', 'json', 'run-operation', 'elementary.log_macro_results', '--args', '{"macro_name": "get_pending_model_alerts", "macro_args": {"days_back": 1}}', '--project-dir', '/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/elementary/monitor/dbt_project']' is 14161
2023-08-08 16:08:57 â€” INFO â€” Querying model alerts last sent times.
2023-08-08 16:08:57 â€” INFO â€” Running dbt --log-format json run-operation elementary.log_macro_results --args {"macro_name": "get_last_model_alert_sent_times", "macro_args": {"days_back": 1}} --project-dir /Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/elementary/monitor/dbt_project
2023-08-08 16:08:59 â€” DEBUG â€” Result bytes size for command '['dbt', '--log-format', 'json', 'run-operation', 'elementary.log_macro_results', '--args', '{"macro_name": "get_last_model_alert_sent_times", "macro_args": {"days_back": 1}}', '--project-dir', '/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/elementary/monitor/dbt_project']' is 1815
2023-08-08 16:08:59 â€” INFO â€” Querying source freshness alerts.
2023-08-08 16:08:59 â€” INFO â€” Running dbt --log-format json run-operation elementary.log_macro_results --args {"macro_name": "get_pending_source_freshness_alerts", "macro_args": {"days_back": 1}} --project-dir /Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/elementary/monitor/dbt_project
2023-08-08 16:09:01 â€” DEBUG â€” Result bytes size for command '['dbt', '--log-format', 'json', 'run-operation', 'elementary.log_macro_results', '--args', '{"macro_name": "get_pending_source_freshness_alerts", "macro_args": {"days_back": 1}}', '--project-dir', '/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/elementary/monitor/dbt_project']' is 1815
2023-08-08 16:09:01 â€” INFO â€” Querying source freshness alerts last sent times.
2023-08-08 16:09:01 â€” INFO â€” Running dbt --log-format json run-operation elementary.log_macro_results --args {"macro_name": "get_last_source_freshness_alert_sent_times", "macro_args": {"days_back": 1}} --project-dir /Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/elementary/monitor/dbt_project
2023-08-08 16:09:03 â€” DEBUG â€” Result bytes size for command '['dbt', '--log-format', 'json', 'run-operation', 'elementary.log_macro_results', '--args', '{"macro_name": "get_last_source_freshness_alert_sent_times", "macro_args": {"days_back": 1}}', '--project-dir', '/Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/elementary/monitor/dbt_project']' is 1815
2023-08-08 16:09:03 â€” INFO â€” Update skipped alerts at "alerts"
2023-08-08 16:09:03 â€” DEBUG â€” Running dbt run -s update_alerts.update_skipped_alerts --project-dir /Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/elementary/monitor/dbt_project --vars {"alert_ids": ["5e2e388e-e883-4989-8f54-0a5225805882.test.test_dbt.failing_test_stg_customers_last_name_last_name.847ec3eec4", "f9f8b46b-9ba6-4db8-b9a8-20a04cd01d5e.test.test_dbt.failing_test_stg_customers_last_name_last_name.847ec3eec4", "5ae5c1b9-bb50-4899-8860-56bae80936b6.test.test_dbt.failing_test_stg_customers_last_name_last_name.847ec3eec4", "ce2e4bf3-1071-4144-a060-4cbfc0edb4ff.test.test_dbt.failing_test_stg_customers_last_name_last_name.847ec3eec4", "82641d52-4826-40cf-994d-7339c5303164.test.test_dbt.failing_test_stg_customers_last_name_last_name.847ec3eec4", "9a47e226-16da-4111-bd02-ee802a0af48c.test.test_dbt.unique_stg_customers_last_name_last_name.0845e13bad", "a30fc06b-d642-44ed-95a6-dfd13be58b84.test.test_dbt.unique_stg_orders_order_id_customer_id.52431730b9", "a30fc06b-d642-44ed-95a6-dfd13be58b84.test.test_dbt.not_null_stg_orders_order_id_customer_id.a094c039ad", "80eeba1e-8527-416a-8d86-c42fc32450ac.test.test_dbt.source_unique_stripe_payment_id.3b7989ce64", "a30fc06b-d642-44ed-95a6-dfd13be58b84.test.test_dbt.source_unique_stripe_payment_id.3b7989ce64"], "table_name": "alerts"}
2023-08-08 16:09:07 â€” INFO â€” Update skipped alerts at "alerts_models"
2023-08-08 16:09:07 â€” DEBUG â€” Running dbt run -s update_alerts.update_skipped_alerts --project-dir /Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/elementary/monitor/dbt_project --vars {"alert_ids": ["55c59901-7d0a-4af1-bbdd-203d138a6d5f.model.test_dbt.stg_customers", "55c59901-7d0a-4af1-bbdd-203d138a6d5f.model.test_dbt.stg_payments", "55c59901-7d0a-4af1-bbdd-203d138a6d5f.model.test_dbt.stg_orders", "14bdfa6a-a9a3-4903-a012-1649623274ce.model.test_dbt.stg_orders"], "table_name": "alerts_models"}
2023-08-08 16:09:11 â€” INFO â€” Update skipped alerts at "alerts_source_freshness"
2023-08-08 16:09:31 â€” INFO â€” Update sent alerts at "alerts"
2023-08-08 16:09:31 â€” DEBUG â€” Running dbt run -s update_alerts.update_sent_alerts --project-dir /Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/elementary/monitor/dbt_project --vars {"alert_ids": ["a30fc06b-d642-44ed-95a6-dfd13be58b84.test.test_dbt.unique_stg_customers_customer_id.c7614daada", "a30fc06b-d642-44ed-95a6-dfd13be58b84.test.test_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa", "a30fc06b-d642-44ed-95a6-dfd13be58b84.test.test_dbt.assert_positive_value_for_total_amount", "a30fc06b-d642-44ed-95a6-dfd13be58b84.test.test_dbt.not_null_stg_orders_order_id.81cfe2fe64", "a30fc06b-d642-44ed-95a6-dfd13be58b84.test.test_dbt.unique_stg_orders_order_id.e3b841c71a", "a30fc06b-d642-44ed-95a6-dfd13be58b84.test.test_dbt.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1", "a30fc06b-d642-44ed-95a6-dfd13be58b84.test.test_dbt.not_null_dim_customers_customer_id.dd91cd1c8d", "a30fc06b-d642-44ed-95a6-dfd13be58b84.test.test_dbt.unique_dim_customers_customer_id.15c9f1e2fd", "a30fc06b-d642-44ed-95a6-dfd13be58b84.test.test_dbt.dbt_utils_cardinality_equality_dim_customers_customer_id__customer_id__ref_stg_customers_.cdf22e9197", "a30fc06b-d642-44ed-95a6-dfd13be58b84.test.test_dbt.assert_amount_average_is_greater_than_one", "a30fc06b-d642-44ed-95a6-dfd13be58b84.test.test_dbt.assert_total_payment_amount_is_positive", "a30fc06b-d642-44ed-95a6-dfd13be58b84.test.test_dbt.average_dollars_spent_greater_than_one_fct_orders_amount__customer_id.b5af33deeb", "80eeba1e-8527-416a-8d86-c42fc32450ac.test.test_dbt.not_null_stg_orders_order_id_customer_id.a094c039ad", "80eeba1e-8527-416a-8d86-c42fc32450ac.test.test_dbt.unique_stg_orders_order_id_customer_id.52431730b9", "ae8cffa4-c04f-4ee8-a58d-5a263fe9e884.test.test_dbt.source_unique_stripe_payment_id.3b7989ce64", "40ac6f6e-ca0b-4bc2-bd48-854f63035b55.test.test_dbt.unique_stg_customers_last_name_last_name.0845e13bad", "ccdeb6aa-962c-4b1d-84f4-5b2a15d4522c.test.test_dbt.failing_test_stg_customers_last_name_last_name.847ec3eec4"], "sent_at": "2023-08-08 13:09:31", "table_name": "alerts"}
2023-08-08 16:09:35 â€” INFO â€” Update sent alerts at "alerts_models"
2023-08-08 16:09:35 â€” DEBUG â€” Running dbt run -s update_alerts.update_sent_alerts --project-dir /Users/ofek/.pyenv/versions/3.9.17/lib/python3.9/site-packages/elementary/monitor/dbt_project --vars {"alert_ids": ["14bdfa6a-a9a3-4903-a012-1649623274ce.model.test_dbt.stg_customers", "14bdfa6a-a9a3-4903-a012-1649623274ce.model.test_dbt.stg_payments", "57d30c1c-49bd-470a-b15c-2c16362082be.model.test_dbt.stg_orders"], "sent_at": "2023-08-08 13:09:35", "table_name": "alerts_models"}
